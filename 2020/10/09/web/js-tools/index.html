<!doctype html><html class="theme-next mist use-motion" lang="zh-Hans"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1"><meta http-equiv="Cache-Control" content="no-transform"><meta http-equiv="Cache-Control" content="no-siteapp"><link href="/lib/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css"><link href="//fonts.googleapis.com/css?family=Lato:300,300italic,400,400italic,700,700italic&subset=latin,latin-ext" rel="stylesheet" type="text/css"><link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css"><link href="/css/main.css?v=5.1.1" rel="stylesheet" type="text/css"><meta name="keywords" content="tools,js,"><link rel="alternate" href="/atom.xml" title="Smalle's Blog | AEZOCN" type="application/atom+xml"><link rel="shortcut icon" type="image/x-icon" href="/favicon.ico?v=5.1.1"><meta name="description" content="开发库babel babeljs中文网 babel(@babel/core) 是一个转码器，可以将es6，es7转为es5代码 Babel默认只转换新的JavaScript句法（syntax），而不转换新的API，比如Iterator、Generator、Set、Maps、Proxy、Reflect、Symbol、Promise等全局对象，以及一些定义在全局对象上的方法（比如Object.assi"><meta name="keywords" content="tools,js"><meta property="og:type" content="article"><meta property="og:title" content="JS Tools"><meta property="og:url" content="http://blog.aezo.cn/2020/10/09/web/js-tools/index.html"><meta property="og:site_name" content="Smalle&#39;s Blog | AEZOCN"><meta property="og:description" content="开发库babel babeljs中文网 babel(@babel/core) 是一个转码器，可以将es6，es7转为es5代码 Babel默认只转换新的JavaScript句法（syntax），而不转换新的API，比如Iterator、Generator、Set、Maps、Proxy、Reflect、Symbol、Promise等全局对象，以及一些定义在全局对象上的方法（比如Object.assi"><meta property="og:locale" content="zh-Hans"><meta property="og:image" content="http://blog.aezo.cn/data/images/web/a4-size.png"><meta property="og:updated_time" content="2021-12-01T02:05:12.261Z"><meta name="twitter:card" content="summary"><meta name="twitter:title" content="JS Tools"><meta name="twitter:description" content="开发库babel babeljs中文网 babel(@babel/core) 是一个转码器，可以将es6，es7转为es5代码 Babel默认只转换新的JavaScript句法（syntax），而不转换新的API，比如Iterator、Generator、Set、Maps、Proxy、Reflect、Symbol、Promise等全局对象，以及一些定义在全局对象上的方法（比如Object.assi"><meta name="twitter:image" content="http://blog.aezo.cn/data/images/web/a4-size.png"><script type="text/javascript" id="hexo.configurations">var NexT=window.NexT||{},CONFIG={root:"/",scheme:"Mist",sidebar:{position:"right",display:"post",offset:12,offset_float:0,b2t:!1,scrollpercent:!1},fancybox:!0,motion:!0,duoshuo:{userId:"0",author:"博主"},algolia:{applicationID:"BWD6R9FA4K",apiKey:"3330f3cbaa099dfc30395de5f5b20151",indexName:"blog",hits:{per_page:10},labels:{input_placeholder:"请输入关键字",hits_empty:"我们没有找到任何搜索结果: ${query}",hits_stats:"找到约${hits}条结果（用时${time}ms）"}}}</script><link rel="canonical" href="http://blog.aezo.cn/2020/10/09/web/js-tools/"><title>JS Tools | Smalle's Blog | AEZOCN</title><script type="text/javascript">var _hmt=_hmt||[];!function(){var e=document.createElement("script");e.src="https://hm.baidu.com/hm.js?d82223039d601f2f819f8fe140a63468";var t=document.getElementsByTagName("script")[0];t.parentNode.insertBefore(e,t)}()</script><div style="display:none"><script src="//s95.cnzz.com/z_stat.php?id=cnzz_stat_icon_1276691827&web_id=cnzz_stat_icon_1276691827" language="JavaScript"></script></div></head><body itemscope itemtype="http://schema.org/WebPage" lang="zh-Hans"><div class="container sidebar-position-right page-post-detail"><div class="headband"></div><header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader"><div class="header-inner"><div class="site-brand-wrapper"><div class="site-meta"><div class="custom-logo-site-title"><a href="/" class="brand" rel="start"><span class="logo-line-before"><i></i></span> <span class="site-title">Smalle's Blog | AEZOCN</span><span class="logo-line-after"><i></i></span></a></div><h1 class="site-subtitle" itemprop="description">Better Code, Better Life</h1></div><div class="site-nav-toggle"> <button><span class="btn-bar"></span><span class="btn-bar"></span><span class="btn-bar"></span></button></div></div><nav class="site-nav"><ul id="menu" class="menu"><li class="menu-item menu-item-home"><a href="/" rel="section"><i class="menu-item-icon fa fa-fw fa-home"></i><br> 首页</a></li><li class="menu-item menu-item-categories"><a href="/categories/" rel="section"><i class="menu-item-icon fa fa-fw fa-th"></i><br> 分类</a></li><li class="menu-item menu-item-about"><a href="/about/" rel="section"><i class="menu-item-icon fa fa-fw fa-user"></i><br> 关于</a></li><li class="menu-item menu-item-archives"><a href="/archives/" rel="section"><i class="menu-item-icon fa fa-fw fa-archive"></i><br> 归档</a></li><li class="menu-item menu-item-tags"><a href="/tags/" rel="section"><i class="menu-item-icon fa fa-fw fa-tags"></i><br> 标签</a></li><li class="menu-item menu-item-sitemap"><a href="/sitemap.xml" rel="section"><i class="menu-item-icon fa fa-fw fa-sitemap"></i><br> 站点地图</a></li><li class="menu-item menu-item-search"><a href="javascript:;" class="popup-trigger"><i class="menu-item-icon fa fa-search fa-fw"></i><br> 搜索</a></li></ul><div class="site-search"><div class="popup search-popup local-search-popup"><div class="local-search-header clearfix"><span class="search-icon"><i class="fa fa-search"></i></span><span class="popup-btn-close"><i class="fa fa-times-circle"></i></span><div class="local-search-input-wrapper"> <input autocomplete="off" placeholder="搜索..." spellcheck="false" type="text" id="local-search-input"></div></div><div id="local-search-result"></div></div></div></nav></div></header><main id="main" class="main"><div class="main-inner"><div class="content-wrap"><div id="content" class="content"><div id="posts" class="posts-expand"><article class="post post-type-normal" itemscope itemtype="http://schema.org/Article"><link itemprop="mainEntityOfPage" href="http://blog.aezo.cn/2020/10/09/web/js-tools/"><span hidden itemprop="author" itemscope itemtype="http://schema.org/Person"><meta itemprop="name" content="smalle"><meta itemprop="description" content=""><meta itemprop="image" content="https://avatars0.githubusercontent.com/u/15698218?v=3&u=ce740bf0b67ff0d74990ba6fc644d6e92f572dcb&s=400"></span><span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization"><meta itemprop="name" content="Smalle's Blog | AEZOCN"></span><header class="post-header"><h2 class="post-title" itemprop="name headline">JS Tools</h2><div class="post-meta"><span class="post-time"><span class="post-meta-item-icon"><i class="fa fa-calendar-o"></i></span> <span class="post-meta-item-text">发表于</span> <time title="创建于" itemprop="dateCreated datePublished" datetime="2020-10-09T15:18:00+08:00">2020-10-09</time></span> <span class="post-category"><span class="post-meta-divider">|</span><span class="post-meta-item-icon"><i class="fa fa-folder-o"></i></span> <span class="post-meta-item-text">分类于</span> <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/web/" itemprop="url" rel="index"><span itemprop="name">web</span></a></span></span></div></header><div class="post-body" itemprop="articleBody"><div></div><h2 id="开发库"><a href="#开发库" class="headerlink" title="开发库"></a>开发库</h2><h3 id="babel"><a href="#babel" class="headerlink" title="babel"></a>babel</h3><ul><li><a href="https://www.babeljs.cn" target="_blank" rel="noopener">babeljs中文网</a></li><li><code>babel</code>(@babel/core) 是一个转码器，可以将es6，es7转为es5代码<ul><li>Babel默认只转换新的JavaScript句法（syntax），而不转换新的API，比如Iterator、Generator、Set、Maps、Proxy、Reflect、Symbol、Promise等全局对象，以及一些定义在全局对象上的方法（比如Object.assign）都不会转码</li><li>所以为了使用完整的 ES6 的API，我们需要另外安装：babel-polyfill 或者 babel-runtime <a href="https://www.dazhuanlan.com/2019/12/31/5e0b08829f823/" target="_blank" rel="noopener">^1</a><ul><li><code>@babel/polyfill</code> 会把全局对象统统覆盖一遍，不管你是否用得到。缺点：包会比较大100k左右。如果是移动端应用，要衡量一下。一般保存在dependencies中</li><li><code>babel-runtime</code> 可以按照需求引入。缺点：覆盖不全。一般在写库的时候使用。建议不要直接使用babel-runtime，因为transform-runtime依赖babel-runtime，大部分情况下都可以用<code>transform-runtime</code>预设来达成目的</li></ul></li></ul></li><li><a href="https://github.com/zloirock/core-js" target="_blank" rel="noopener">core-js</a> 是 babel-polyfill、babel-runtime 的核心包，他们都只是对 core-js 和 regenerator 进行的封装。core-js 通过各种奇技淫巧，用 ES3 实现了大部分的 ES2017 原生标准库，同时还要严格遵循规范。支持IE6+<ul><li>core-js 组织结构非常清晰，高度的模块化。比如 <code>core-js/es6</code> 里包含了 es6 里所有的特性。而如果只想实现 promise 可以单独引入 <code>core-js/features/promise</code></li></ul></li><li><p>babel配置文件可为 <code>.babelrc</code> 或 <code>babel.config.js</code>(v7.8.0)。已<code>babel.config.js</code>为例</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">module</span>.exports = &#123;</span><br><span class="line">    presets: [<span class="string">'@vue/cli-plugin-babel/preset'</span>],</span><br><span class="line">    plugins: [</span><br><span class="line">        <span class="comment">// 一般在写库的时候使用，包含了 babel-runtime</span></span><br><span class="line">        <span class="comment">// 配置了 transform-runtime 插件，就不用再手动单独引入某个 `core-js/*` 特性，如 core-js/features/promise，因为转换时会自动加上而且是根据需要只抽离代码里需要的部分</span></span><br><span class="line">        <span class="string">"transform-runtime"</span>,</span><br><span class="line">        </span><br><span class="line">        <span class="comment">// 基于vue的预设</span></span><br><span class="line">        <span class="comment">// "@vue/app",</span></span><br><span class="line">    ]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li><li><p><code>@babel/cli</code> 在命令行中使用babel命令对js文件进行转换。如<code>babel entry.js --out-file out.js</code>进行语法转换</p></li><li>插件和预设（Presets）<ul><li>基于Babel的插件参考：<a href="https://www.babeljs.cn/docs/plugins" target="_blank" rel="noopener">https://www.babeljs.cn/docs/plugins</a></li><li>需要基于某个环境进行开发，如typescript，则需手动安装一堆 Babel 插件，此时可以使用 Presets(包含了一批插件的组合)</li><li>官方 Preset 已经针对常用环境编写了一些 preset。其他社区定义的预设可在<a href="https://www.npmjs.com/search?q=babel-preset" target="_blank" rel="noopener">npm</a>上获取<ul><li><code>@babel/preset-env</code> 对浏览器环境的通用支持</li><li><code>@babel/preset-react</code> 对 React 的支持</li><li><code>@babel/preset-typescript</code> 对 Typescript 支持，参考<a href="/_posts/web/typescript.md#Webpack转译Typescript现有方案">typescript.md#Webpack转译Typescript现有方案</a></li><li><code>@babel/preset-flow</code> 如果使用了 <a href="https://flow.org/en/" target="_blank" rel="noopener">Flow</a>，则建议您使用此预设（preset），Flow 是一个针对 JavaScript 代码的静态类型检查器</li></ul></li></ul></li><li>常见安装</li></ul><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 语法转换</span></span><br><span class="line">npm install --save-dev @babel/core @babel/cli @babel/preset-env</span><br><span class="line"><span class="comment"># 通过 Polyfill 方式在目标环境中添加缺失的特性</span></span><br><span class="line">npm install --save @babel/polyfill</span><br></pre></td></tr></table></figure><h3 id="npm-run-all"><a href="#npm-run-all" class="headerlink" title="npm-run-all"></a>npm-run-all</h3><ul><li><code>npm install npm-run-all --save-dev</code> 安装</li><li><code>npm-run-all</code> 提供了多种运行多个命令的方式，常用的有以下几个<ul><li><code>--serial</code>: 多个命令按排列顺序执行，例如：<code>npm-run-all --serial clean build:**</code> 先执行当前package.json中 npm run clean 命令, 再执行当前package.json中所有的<code>build:</code>开头的scripts</li><li><code>--parallel</code>: 并行运行多个命令，例如：npm-run-all –parallel lint build</li><li><code>--continue-on-error</code>: 是否忽略错误，添加此参数 npm-run-all 会自动退出出错的命令，继续运行正常的</li><li><code>--race</code>: 添加此参数之后，只要有一个命令运行出错，那么 npm-run-all 就会结束掉全部的命令</li></ul></li></ul><h3 id="rollup-js"><a href="#rollup-js" class="headerlink" title="rollup.js"></a>rollup.js</h3><ul><li>Rollup 是一个 JavaScript 模块打包器，可以将小块代码编译成大块复杂的代码，例如 library 或应用程序</li></ul><h2 id="基础库"><a href="#基础库" class="headerlink" title="基础库"></a>基础库</h2><h3 id="lodash工具类"><a href="#lodash工具类" class="headerlink" title="lodash工具类"></a>lodash工具类</h3><ul><li><a href="https://lodash.com/" target="_blank" rel="noopener">lodash</a></li></ul><h3 id="cross-env启动时增加环境变量"><a href="#cross-env启动时增加环境变量" class="headerlink" title="cross-env启动时增加环境变量"></a>cross-env启动时增加环境变量</h3><h3 id="dayjs时间操作"><a href="#dayjs时间操作" class="headerlink" title="dayjs时间操作"></a>dayjs时间操作</h3><ul><li><a href="https://github.com/iamkun/dayjs" target="_blank" rel="noopener">dayjs</a>，相对 moment 体积更小、<a href="https://dayjs.gitee.io/docs/zh-CN/installation/installation" target="_blank" rel="noopener">官方文档</a></li><li>安装<code>npm i dayjs -S</code></li><li>举例</li></ul><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> dayjs <span class="keyword">from</span> <span class="string">'dayjs'</span></span><br><span class="line"></span><br><span class="line">dayjs(<span class="string">'2020-01-01'</span>).add(<span class="number">1</span>, <span class="string">'day'</span>).format(<span class="string">'YYYY-MM-DD'</span>); <span class="comment">// 2020-01-02</span></span><br></pre></td></tr></table></figure><h3 id="mathjs数学计算"><a href="#mathjs数学计算" class="headerlink" title="mathjs数学计算"></a>mathjs数学计算</h3><ul><li>mathjs</li></ul><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">npm install mathjs -S</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> * <span class="keyword">as</span> math <span class="keyword">from</span> <span class="string">'mathjs'</span></span><br><span class="line"></span><br><span class="line">math.add(<span class="number">0.1</span>, <span class="number">0.2</span>)     <span class="comment">//  0.30000000000000004</span></span><br><span class="line">math.number(math.add(math.bignumber(<span class="number">0.1</span>), math.bignumber(<span class="number">0.2</span>))) <span class="comment">// 0.3 math.number转换BigNumber类型为number类型</span></span><br><span class="line">math.number(math.chain(math.bignumber(<span class="number">0.1</span>)).add(math.bignumber(<span class="number">0.2</span>)).add(math.bignumber(<span class="number">0.3</span>)).done()) <span class="comment">// 0.6</span></span><br></pre></td></tr></table></figure><h3 id="省市区级联"><a href="#省市区级联" class="headerlink" title="省市区级联"></a>省市区级联</h3><ul><li><a href="https://github.com/dwqs/vue-area-linkage" target="_blank" rel="noopener">vue-area-linkage</a> 省市区选择器(需结合省市区数据)</li><li><a href="https://github.com/dwqs/area-puppeteer" target="_blank" rel="noopener">area-puppeteer</a> 省市区数据</li></ul><h2 id="AJAX"><a href="#AJAX" class="headerlink" title="AJAX"></a>AJAX</h2><h3 id="axios"><a href="#axios" class="headerlink" title="axios"></a>axios</h3><ul><li>参考<a href="/_posts/arch/springboot-vue.md#文件上传案例">springboot-vue.md#文件上传下载案例</a></li><li>axios基本使用</li></ul><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">axios.get(<span class="string">"/hello?id=1"</span>).then(<span class="function"><span class="params">response</span> =&gt;</span> &#123;</span><br><span class="line">    <span class="built_in">console</span>.log(response.data)</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 如果将params换成this.$qs.stringify，后台也无法获取到数据</span></span><br><span class="line">axios.get(<span class="string">"/hello"</span>, &#123;</span><br><span class="line">    params: &#123;</span><br><span class="line">        userId: <span class="number">1</span>,</span><br><span class="line">    &#125;</span><br><span class="line">&#125;).then(<span class="function"><span class="params">response</span> =&gt;</span> &#123;</span><br><span class="line">    <span class="built_in">console</span>.log(response.data)</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure><h4 id="axios参数后端接受不到-2"><a href="#axios参数后端接受不到-2" class="headerlink" title="axios参数后端接受不到 ^2"></a>axios参数后端接受不到 <a href="https://segmentfault.com/a/1190000013312233" title="springBoot与axios表单提交" target="_blank" rel="noopener">^2</a></h4><ul><li><p>get请求传递数组</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> vm = <span class="keyword">this</span></span><br><span class="line"><span class="keyword">this</span>.$axios.get(<span class="string">"/hello"</span>, &#123;</span><br><span class="line">    params: &#123;</span><br><span class="line">        typeCodes: [<span class="string">"CustomerSource"</span>, <span class="string">"VisitLevelCode"</span>]</span><br><span class="line">    &#125;,</span><br><span class="line">    paramsSerializer: <span class="function"><span class="keyword">function</span>(<span class="params">params</span>) </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> vm.$qs.stringify(params, &#123;<span class="attr">arrayFormat</span>: <span class="string">'repeat'</span>&#125;) <span class="comment">// 此时this并不是vue对象</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;).then(<span class="function"><span class="params">response</span> =&gt;</span> &#123;</span><br><span class="line">    <span class="built_in">console</span>.log(response.data)</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure></li><li><p>post请求无法接收</p><ul><li>使用<code>qs</code>插件(推荐，会自动设置请求头为<code>application/x-www-form-urlencoded</code>)</li><li><p><code>axios</code>使用<code>x-www-form-urlencoded</code>请求，参数应该写到<code>param</code>中</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">axios(&#123;</span><br><span class="line">    method: <span class="string">'post'</span>, <span class="comment">// 同jquery中的type</span></span><br><span class="line">    headers: &#123;</span><br><span class="line">        <span class="string">'Content-Type'</span>: <span class="string">'application/x-www-form-urlencoded'</span></span><br><span class="line">    &#125;,</span><br><span class="line">    url: <span class="string">'http://localhost:8080/api/login'</span>,</span><br><span class="line">    params: &#123;</span><br><span class="line">        username: <span class="string">'smalle'</span>,</span><br><span class="line">        password: <span class="string">'smalle'</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;).then(<span class="function">(<span class="params">res</span>)=&gt;</span>&#123;</span><br><span class="line">    </span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure><ul><li>axios的params和data两者关系<ul><li>params是添加到url的请求字符串中的，一般用于GET请求</li><li>data是添加到请求体body中的，用于POST请求。Spring中可在通过<code>getUser(@RequestBody User user)</code>获取body中的数据，从request对象中只能以流的形式获取</li><li>如果POST请求参数写在<code>data</code>中，加<code>headers: {&#39;Content-Type&#39;: &#39;application/x-www-form-urlencoded&#39;}</code>也无法直接获取，必须通过@RequestBody)</li></ul></li><li>jquery在执行post请求时，会设置Content-Type为application/x-www-form-urlencoded，且会把data中的数据以url序列化的方式进行传递，所以服务器能够正确解析</li><li>使用原生ajax(axios请求)时，如果不显示的设置Content-Type，那么默认是text/plain，这时服务器就不知道怎么解析数据了，所以才只能通过获取原始数据流的方式来进行解析请求数据</li><li>SpringSecurity登录必须使用POST</li></ul></li></ul></li></ul><h3 id="qs插件使用"><a href="#qs插件使用" class="headerlink" title="qs插件使用"></a>qs插件使用</h3><ul><li>qs插件会自动设置请求头为<code>application/x-www-form-urlencoded</code></li></ul><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 安装：npm install qs -D</span></span><br><span class="line"><span class="keyword">import</span> qs <span class="keyword">from</span> <span class="string">'qs'</span></span><br><span class="line">Vue.prototype.$qs = qs;</span><br><span class="line"></span><br><span class="line"><span class="keyword">this</span>.$axios.post(<span class="keyword">this</span>.$domain + <span class="string">"/base/type_code_list"</span>, <span class="keyword">this</span>.$qs.stringify(&#123;</span><br><span class="line">    name: <span class="string">'smalle'</span></span><br><span class="line">&#125;)).then(<span class="function"><span class="params">response</span> =&gt;</span> &#123;</span><br><span class="line"></span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="comment">// (1) qs格式化日期</span></span><br><span class="line"><span class="comment">// qs格式化时间时，默认格式化成如`1970-01-01T00:00:00.007Z`，可使用serializeDate进行自定义格式化</span></span><br><span class="line"><span class="comment">// 或者后台通过java转换：new SimpleDateFormat("yyyy-MM-dd'T'HH:mm:ss.SSS'Z'").setTimeZone(TimeZone.getTimeZone("UTC"));</span></span><br><span class="line"><span class="keyword">this</span>.$qs.stringify(<span class="keyword">this</span>.formModel, &#123;</span><br><span class="line">    serializeDate: <span class="function"><span class="keyword">function</span>(<span class="params">d</span>) </span>&#123;</span><br><span class="line">        <span class="comment">// 转换成时间戳</span></span><br><span class="line">        <span class="keyword">return</span> d.getTime();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="comment">// (2) qs序列化对象属性</span></span><br><span class="line"><span class="comment">// 下列对象userInfo默认渲染成 `name=smalle&amp;bobby[0][name]=game&amp;hobby[0][level]=1`(未进行url转码)，此时springboot写好对应的POJO是无法进行转换的，报错`is neither an array nor a List nor a Map`</span></span><br><span class="line"><span class="comment">// 可以使用`allowDots`解决，最终返回 `name=smalle&amp;bobby[0].name=game&amp;hobby[0].level=1`</span></span><br><span class="line"><span class="keyword">var</span> userInfo = &#123;</span><br><span class="line">    name: <span class="string">'smalle'</span>,</span><br><span class="line">    hobby: [&#123;</span><br><span class="line">        name: <span class="string">'game'</span>,</span><br><span class="line">        level: <span class="number">1</span></span><br><span class="line">    &#125;]</span><br><span class="line">&#125;;</span><br><span class="line"><span class="built_in">console</span>.log(<span class="keyword">this</span>.$qs.stringify(<span class="keyword">this</span>.mainInfo, &#123;<span class="attr">allowDots</span>: <span class="literal">true</span>&#125;))</span><br></pre></td></tr></table></figure><h2 id="Vue相关UI库"><a href="#Vue相关UI库" class="headerlink" title="Vue相关UI库"></a>Vue相关UI库</h2><h3 id="Element-UI"><a href="#Element-UI" class="headerlink" title="Element-UI"></a>Element-UI</h3><ul><li><p>el-drawer</p></li><li><p>防止整个页面被遮住。modal-append-to-body的使用：遮罩层是否插入至 body 元素上，若为 false，则遮罩层会插入至 Drawer 的父元素上</p></li></ul><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">template</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">el-drawer</span> <span class="attr">title</span>=<span class="string">"我是标题"</span> <span class="attr">:visible</span>=<span class="string">"show"</span> <span class="attr">:modal-append-to-body</span>=<span class="string">"false"</span>&gt;</span></span><br><span class="line">      body</span><br><span class="line">    <span class="tag">&lt;/<span class="name">el-drawer</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">template</span>&gt;</span></span><br></pre></td></tr></table></figure><h3 id="iview"><a href="#iview" class="headerlink" title="iview"></a>iview</h3><ul><li>参考<a href="/_posts/web/iview.md">iview.md</a></li></ul><h3 id="Avue"><a href="#Avue" class="headerlink" title="Avue"></a>Avue</h3><ul><li><a href="https://avuejs.com" target="_blank" rel="noopener">官网</a></li><li><a href="https://avuejs.com/doc/api" target="_blank" rel="noopener">内置函数(全局API，在vue组件中可直接使用this调用)</a><ul><li>validatenull 校验是否为空(<code>null/&#39;&#39;/0/[]/{}</code>)</li><li>findObject 从数组中查找对象，如<code>const parentIdProp = this.findObject(this.formColumn | this.crudOption.column, &#39;parentId&#39;)</code></li><li>vaildData 校验，如<code>this.vaildData(this.permission.party_permission_add, false)</code> 默认根据第一个参数值进行判断，否则取第二个参数为默认值</li><li>$Print</li><li>$Clipboard</li><li>$Log</li><li>$NProgress</li><li>$Screenshot</li><li>deepClone</li><li>dataURLtoFile</li><li>isJson</li><li>setPx</li><li>sortArrys</li><li>findArray</li><li>downFile</li><li>loadScript</li><li>watermark</li><li>asyncValidator</li></ul></li><li>内置指令<ul><li><code>v-dialogdrag</code> 作用于dialog，可进行拖拽</li></ul></li><li>获取ref<ul><li>在crud组件中<code>const avatarRef = this.$refs.crud.getPropRef(&#39;avatar&#39;)</code>可获取到表单的avatar图片上传组件元素ref，从而使用<code>avatarRef.$refs.temp.handleSuccess</code>进行调用(temp是由于中间动态判断了表单元素)</li></ul></li></ul><h4 id="表格组件常用参数-option"><a href="#表格组件常用参数-option" class="headerlink" title="表格组件常用参数(option)"></a>表格组件常用参数(option)</h4><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">    searchShow: <span class="literal">true</span>, <span class="comment">// 是否默认显示查询条件区域，设置为不显示时，也可通过表格工具栏手动点击显示</span></span><br><span class="line">    searchMenuSpan: <span class="number">6</span>, <span class="comment">// 查询列默认占用宽度</span></span><br><span class="line">    searchLabelWidth: <span class="number">115</span>, <span class="comment">// 查询列文字描述宽度</span></span><br><span class="line">    searchIcon: <span class="literal">true</span>, <span class="comment">// 查询条件达到一定个数时，显示更多按钮进行隐藏</span></span><br><span class="line">    searchIndex: <span class="number">3</span>, <span class="comment">// 和searchIcon结合使用，配置显示的个数</span></span><br><span class="line"></span><br><span class="line">    height: <span class="string">'auto'</span>, <span class="comment">// 表格高度自适应，可和calcHeight结合使用. 如果需要高度固定可使用具体数值，如: 270</span></span><br><span class="line">    maxHeight: <span class="string">'270'</span>, <span class="comment">// 表格最大高度，如果不使用calcHeight，则可使用此参数显示滚动条</span></span><br><span class="line">    calcHeight: <span class="number">90</span>, <span class="comment">// 表格自动计算高度，可手动条件以消除滚动条</span></span><br><span class="line">    border: <span class="literal">true</span>, <span class="comment">// 实现边框</span></span><br><span class="line"></span><br><span class="line">    selection: <span class="literal">true</span>, <span class="comment">// 列表可勾选</span></span><br><span class="line">    tip: <span class="literal">false</span>, <span class="comment">// 不显示勾选提示，默认了为true显示</span></span><br><span class="line">    filterBtn: <span class="literal">true</span>, <span class="comment">// 显示工具栏过滤按钮</span></span><br><span class="line">    menu: <span class="literal">true</span>,</span><br><span class="line">    viewBtn: <span class="literal">true</span>, <span class="comment">// 弹框查看当前行数据。如果使用行内编辑，则必须设置成false</span></span><br><span class="line">    addBtn: <span class="literal">true</span>, <span class="comment">// 弹框新增一行数据。如果使用行内编辑，则必须设置成false</span></span><br><span class="line">    cellBtn: <span class="literal">true</span>, <span class="comment">// 开启可编辑表格</span></span><br><span class="line">    addRowBtn: <span class="literal">true</span>, <span class="comment">// 可编辑表格新增一行</span></span><br><span class="line">    cancelBtn: <span class="literal">true</span>, <span class="comment">// 可编辑时，显示取消按钮，默认true</span></span><br><span class="line"></span><br><span class="line">    highlightCurrentRow: <span class="literal">false</span>, <span class="comment">// 高亮当前行</span></span><br><span class="line">   </span><br><span class="line">    dialogDrag: <span class="literal">true</span>, <span class="comment">// 弹框支持拖拽</span></span><br><span class="line">    dialogTop: <span class="string">'2%'</span>, <span class="comment">// 弹框顶部高度</span></span><br><span class="line">    dialogWidth: <span class="string">'85%'</span>, <span class="comment">// 弹框宽度</span></span><br><span class="line"></span><br><span class="line">    tabs: <span class="literal">true</span>, <span class="comment">// 字段分组时，每个组按照TAB横向显示，false则按照折叠菜单上下显示</span></span><br><span class="line">    span: <span class="number">6</span>, <span class="comment">// 表单编辑时，每列占用宽度，默认12</span></span><br><span class="line">    labelWidth: <span class="number">115</span>, <span class="comment">// 表单列文字描述宽度</span></span><br><span class="line">    column: [</span><br><span class="line">        &#123;</span><br><span class="line">            label: <span class="string">'销售订单号'</span>, <span class="comment">// 字段中文名</span></span><br><span class="line">            prop: <span class="string">'saleNo'</span>, <span class="comment">// 字段名</span></span><br><span class="line">            type: <span class="string">'input'</span>, <span class="comment">// 字段类型：影响表单编辑。input/select/radio/tree/...</span></span><br><span class="line">            </span><br><span class="line">            search: <span class="literal">true</span>, <span class="comment">// 会在查询条件中显示</span></span><br><span class="line">            searchslot: <span class="literal">true</span>, <span class="comment">// 开启当前列自定义search，在dom中还需增加`&lt;template slot-scope="&#123;disabled, size&#125;" slot="saleNoSearch"&gt;`(以`xxxSearch`命名)</span></span><br><span class="line">            searchOrder: <span class="number">10</span>, <span class="comment">// 搜索字段排序，越大越靠前</span></span><br><span class="line"></span><br><span class="line">            hide: <span class="literal">true</span>, <span class="comment">// 列表中隐藏</span></span><br><span class="line">            slot: <span class="literal">true</span>, <span class="comment">// 列表显示时自定义列，在dom中还需增加`&lt;template slot="saleNo" slot-scope="scope"&gt;`</span></span><br><span class="line">            align: <span class="string">'left'</span>, <span class="comment">// 列表显示时，文字位置</span></span><br><span class="line">            format: <span class="string">'yyyy-MM-dd HH:mm'</span>, <span class="comment">// 列表显示和表单显示格式化</span></span><br><span class="line">            formatter: <span class="function"><span class="params">()</span> =&gt;</span> &#123;&#125;, <span class="comment">// 格式化函数</span></span><br><span class="line">            </span><br><span class="line">            formslot: <span class="literal">true</span>, <span class="comment">// 表单插槽，需要有`&lt;template slot="saleNoForm" slot-scope="&#123;type,disabled&#125;"&gt;`, type=add/edit</span></span><br><span class="line">            labelslot: <span class="literal">true</span>, <span class="comment">// 需要 slot="saleNoLabel" </span></span><br><span class="line">            errorslot: <span class="literal">true</span>, <span class="comment">// 需要 slot="saleNoError" </span></span><br><span class="line">            multiple: <span class="literal">true</span>, <span class="comment">// 是否可多选</span></span><br><span class="line">            editDisplay: <span class="literal">true</span>, <span class="comment">// 编辑时显示，默认true</span></span><br><span class="line">            span: <span class="number">6</span>, <span class="comment">// 自定义当前列表单编辑时的占用宽度</span></span><br><span class="line">            tip: <span class="string">'表单编辑时，鼠标放到表单元素框上的提示语'</span>,</span><br><span class="line">            rules: [</span><br><span class="line">              &#123;</span><br><span class="line">                required: <span class="literal">true</span>, <span class="comment">// 表单编辑时的校验规则，必填</span></span><br><span class="line">                message: <span class="string">'请输入字典代码'</span>,</span><br><span class="line">                trigger: <span class="string">'blur'</span>,</span><br><span class="line">              &#125;,</span><br><span class="line">            ],</span><br><span class="line">            change: <span class="function">(<span class="params">&#123; value &#125;</span>) =&gt;</span> &#123;&#125;, <span class="comment">// 表单编辑时，值发生变化事件</span></span><br><span class="line">            valueFormat: <span class="string">'yyyy-MM-dd HH:mm:ss'</span>, <span class="comment">// 实际值(提交到后台的值)格式化成字符串，一般用在 type='datetime'</span></span><br><span class="line">            value: <span class="number">1</span>, <span class="comment">// 表单编辑时的默认值</span></span><br><span class="line"></span><br><span class="line">            searchFilterable: <span class="literal">true</span>, <span class="comment">// 表格搜索是否可前台过滤，默认false</span></span><br><span class="line">            filterable: <span class="literal">true</span>, <span class="comment">// 表单是否可前台过滤</span></span><br><span class="line">            remote: <span class="literal">true</span>, <span class="comment">// 开启远程搜索，默认为false，此时dicUrl中&#123;&#123;key&#125;&#125;为用户输入的关键字</span></span><br><span class="line">            <span class="comment">// 有了dictData和dicUrl，则列表显示默认也会自动进行翻译字典值，字典中无则显示实际值</span></span><br><span class="line">            dicData: [&#123;</span><br><span class="line">              name: <span class="string">'自定义字典'</span>,</span><br><span class="line">              code: <span class="number">1</span></span><br><span class="line">            &#125;],</span><br><span class="line">            <span class="comment">// 下拉时(表单编辑和查询条件)，字典资源路径，默认返回数组项为 lable/value 键值对才会自动匹配</span></span><br><span class="line">            <span class="comment">// 修改URL后需要更新字段，this.$refs.[form | crud].updateDic('saleNo')</span></span><br><span class="line">            dicUrl: <span class="string">'/apps/system/dict/findForDict?parentCode=goods_sale_type&amp;name=&#123;&#123;key&#125;&#125;'</span>,</span><br><span class="line">            props: &#123;</span><br><span class="line">              value: <span class="string">'code'</span>, <span class="comment">// 和 dicUrl 结合使用，用来指明后台返回数据结构中实际值的字段名</span></span><br><span class="line">              label: <span class="string">'name'</span>,</span><br><span class="line">            &#125;,</span><br><span class="line">            dicMethod: <span class="string">'post'</span>, <span class="comment">// 默认请求方式为GET，此处设置为POST</span></span><br><span class="line">            dicQuery: &#123;</span><br><span class="line">              a: <span class="number">1</span> <span class="comment">// 获取字典资源时的额外参数</span></span><br><span class="line">            &#125;,</span><br><span class="line">            <span class="comment">// 格式化ajax获取的字段数据，参考 src/core/dic.js#sendDic</span></span><br><span class="line">            dicFormatter(res) &#123;</span><br><span class="line">                <span class="keyword">const</span> list = res.data</span><br><span class="line">                <span class="keyword">return</span> list</span><br><span class="line">            &#125;,</span><br><span class="line"></span><br><span class="line">            <span class="comment">// type=tree时</span></span><br><span class="line">            defaultExpandAll: <span class="literal">false</span>,</span><br><span class="line">            <span class="comment">// 使用dic属性无效</span></span><br><span class="line">            <span class="comment">// 使用 dicUrl 属性，但是每次会进行请求</span></span><br><span class="line">            <span class="comment">// 使用 dicData属性。当直接写成 dicData: this.treeData 无法在弹框中显示树形数据；还需在获取到数据后修改此属性</span></span><br><span class="line">            dicData: <span class="keyword">this</span>.treeData,</span><br><span class="line">            <span class="comment">// 使用 lazy 和 treeLoad，即懒加载，会出现第一次无法选中</span></span><br><span class="line">            <span class="comment">// lazy: true,</span></span><br><span class="line">            <span class="comment">// treeLoad: (node, resolve) =&gt; &#123;</span></span><br><span class="line">            <span class="comment">//   if (node.isLeaf) &#123;</span></span><br><span class="line">            <span class="comment">//     return resolve([])</span></span><br><span class="line">            <span class="comment">//   &#125;</span></span><br><span class="line">            <span class="comment">//   const parentId = (node.level === 0) ? '0' : node.data.id;</span></span><br><span class="line">            <span class="comment">//   findDeptLazyTree(&#123; parentId &#125;).then(res =&gt; &#123;</span></span><br><span class="line">            <span class="comment">//     resolve(res.data.map(item =&gt; &#123;</span></span><br><span class="line">            <span class="comment">//       return &#123;</span></span><br><span class="line">            <span class="comment">//         ...item,</span></span><br><span class="line">            <span class="comment">//         leaf: !item.hasChildren</span></span><br><span class="line">            <span class="comment">//       &#125;</span></span><br><span class="line">            <span class="comment">//     &#125;))</span></span><br><span class="line">            <span class="comment">//   &#125;);</span></span><br><span class="line">            <span class="comment">// &#125;,</span></span><br><span class="line"></span><br><span class="line">            <span class="comment">// type=select时, 配置typeslot卡槽开启即可自定义下拉框的内容</span></span><br><span class="line">            typeslot: <span class="literal">true</span>, <span class="comment">// 需要增加dom `&lt;template slot="saleNoType" slot-scope="&#123;item,value,label&#125;"&gt;`</span></span><br><span class="line">            <span class="comment">// typeformat配置回显的内容，但是你提交的值还是value并不会改变，无需插槽</span></span><br><span class="line">            typeformat(item, label, value) &#123;</span><br><span class="line">                <span class="keyword">return</span> <span class="string">`名:<span class="subst">$&#123;item[label]&#125;</span>-值:<span class="subst">$&#123;item[value]&#125;</span>`</span></span><br><span class="line">            &#125;,</span><br><span class="line">        &#125;,</span><br><span class="line">        &#123;</span><br><span class="line">            labelWidth: <span class="number">0</span>, <span class="comment">// 字段中文名宽度</span></span><br><span class="line">            label: <span class="string">''</span>,</span><br><span class="line">            prop: <span class="string">'saleOrderDetailVo'</span>,</span><br><span class="line">            span: <span class="number">24</span>, <span class="comment">// 占一整行</span></span><br><span class="line">            hide: <span class="literal">true</span>, <span class="comment">// 不显示在列表中</span></span><br><span class="line">            formslot: <span class="literal">true</span>, <span class="comment">// 表单编辑自定义。此时定义slot="saleOrderDetailVoForm"即可自定义此列。可嵌套另外一个crud组件</span></span><br><span class="line">        &#125;</span><br><span class="line">    ],</span><br><span class="line">    <span class="comment">// 字段分组</span></span><br><span class="line">    group: [</span><br><span class="line">    ]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="原理介绍"><a href="#原理介绍" class="headerlink" title="原理介绍"></a>原理介绍</h4><ul><li>目录结构</li></ul><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">packages <span class="comment"># 实际重写组件目录</span></span><br><span class="line">    core</span><br><span class="line">        common/porps.js <span class="comment"># 通用 vue 属性，最终会被mixins</span></span><br><span class="line">        common/event.js <span class="comment"># 通用事件，最终会被mixins</span></span><br><span class="line">        common/locale.js <span class="comment"># 国际化，最终会被mixins</span></span><br><span class="line">        components/form/index.vue <span class="comment"># 表单组件动态判断(临时)，最终会引入avue-form(如：element-ui/form)</span></span><br><span class="line">        components/form/index.vue</span><br><span class="line">    element-ui <span class="comment"># 基于 element-ui 框架重写的组件目录</span></span><br><span class="line">        crud <span class="comment"># avue-crud 组件</span></span><br><span class="line">            column.vue <span class="comment"># 表格列组件：动态组件列 dynamic-column，其他组件列 el-table-column</span></span><br><span class="line">        form <span class="comment"># avue-form 组件</span></span><br><span class="line">        upload <span class="comment"># 文件上传组件</span></span><br><span class="line">    vant <span class="comment"># 基于 vant 框架</span></span><br><span class="line">src</span><br></pre></td></tr></table></figure><ul><li>packages/element-ui/upload/index.vue</li></ul><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">template</span>&gt;</span></span><br><span class="line">  <span class="comment">&lt;!-- bem函数，基于组件名生成组件顶级class --&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">div</span> <span class="attr">:class</span>=<span class="string">"b()"</span></span></span><br><span class="line"><span class="tag">       <span class="attr">v-loading.lock</span>=<span class="string">"loading"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">el-upload</span> <span class="attr">:class</span>=<span class="string">"b(&#123;'list':listType=='picture-img','upload':disabled&#125;)"</span></span></span><br><span class="line"><span class="tag">        <span class="attr">...</span></span></span><br><span class="line">    &lt;/el-upload&gt;</span><br><span class="line">  <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">template</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="undefined"></span></span><br><span class="line"><span class="javascript"><span class="keyword">import</span> create <span class="keyword">from</span> <span class="string">"core/create"</span>; <span class="comment">// 创建组件方法，可基于此方法再次混入功能，也可修改给组件名增加前缀</span></span></span><br><span class="line"><span class="javascript"><span class="keyword">import</span> props <span class="keyword">from</span> <span class="string">"../../core/common/props.js"</span>; <span class="comment">// 混入 vue 通用属性</span></span></span><br><span class="line"><span class="javascript"><span class="keyword">import</span> event <span class="keyword">from</span> <span class="string">"../../core/common/event.js"</span>; <span class="comment">// 混入通用事件</span></span></span><br><span class="line"><span class="javascript"><span class="keyword">import</span> locale <span class="keyword">from</span> <span class="string">"../../core/common/locale"</span>; <span class="comment">// 混入国际化功能</span></span></span><br><span class="line"><span class="javascript"><span class="keyword">import</span> upload <span class="keyword">from</span> <span class="string">'../../core/common/upload'</span> <span class="comment">// 混入上传功能</span></span></span><br><span class="line"><span class="javascript"><span class="keyword">export</span> <span class="keyword">default</span> create(&#123;</span></span><br><span class="line"><span class="javascript">  name: <span class="string">"upload"</span>,</span></span><br><span class="line"><span class="undefined">  mixins: [props(), event(), upload(), locale],</span></span><br><span class="line"><span class="undefined">  data () &#123;</span></span><br><span class="line"><span class="javascript">    <span class="keyword">return</span> &#123;</span></span><br><span class="line"><span class="javascript">      menu: <span class="literal">false</span>,</span></span><br><span class="line"><span class="undefined">    &#125;;</span></span><br><span class="line"><span class="undefined">  &#125;</span></span><br><span class="line"><span class="undefined">&#125;);</span></span><br><span class="line"><span class="undefined"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure><ul><li>混入功能举例说明</li></ul><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// packages/core/common/props.js</span></span><br><span class="line">watch: &#123;</span><br><span class="line">    <span class="comment">// 所有组件都有一个text属性，当text属性变化后调用 handleChange 方法（event.js，见下文），在 handleChange 中最后触发了 input 事件，从而监听到 value 属性变化，调用 initVal 进行实际值处理（如传入参数为逗号分割的字符串，可经过此初始化变成数组）</span></span><br><span class="line">    text: &#123;</span><br><span class="line">        handler (n, o) &#123;</span><br><span class="line">            <span class="keyword">this</span>.handleChange(n)</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;,</span><br><span class="line">    value: &#123;</span><br><span class="line">        handler (n, o) &#123;</span><br><span class="line">            <span class="keyword">this</span>.initVal();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;,</span><br><span class="line"></span><br><span class="line"><span class="comment">// packages/core/common/event.js</span></span><br><span class="line">initVal () &#123;</span><br><span class="line">    <span class="keyword">this</span>.text = initVal(&#123;</span><br><span class="line">        type: <span class="keyword">this</span>.type,</span><br><span class="line">        multiple: <span class="keyword">this</span>.multiple,</span><br><span class="line">        dataType: <span class="keyword">this</span>.dataType,</span><br><span class="line">        value: <span class="keyword">this</span>.value,</span><br><span class="line">        separator: <span class="keyword">this</span>.separator,</span><br><span class="line">        callback: <span class="function">(<span class="params">result</span>) =&gt;</span> &#123;</span><br><span class="line">            <span class="keyword">this</span>.stringMode = result;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;);</span><br><span class="line">&#125;,</span><br><span class="line">handleChange (value) &#123;</span><br><span class="line">    <span class="keyword">let</span> result = value;</span><br><span class="line">    <span class="keyword">if</span> (<span class="keyword">this</span>.isString || <span class="keyword">this</span>.isNumber || <span class="keyword">this</span>.stringMode || <span class="keyword">this</span>.listType === <span class="string">"picture-img"</span>) &#123;</span><br><span class="line">        <span class="keyword">if</span> (<span class="built_in">Array</span>.isArray(value)) result = value.join(<span class="string">','</span>)</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (<span class="keyword">typeof</span> <span class="keyword">this</span>.change === <span class="string">'function'</span> &amp;&amp; <span class="keyword">this</span>.column.cell !== <span class="literal">true</span>) &#123;</span><br><span class="line">        <span class="keyword">this</span>.change(&#123; <span class="attr">value</span>: result, <span class="attr">column</span>: <span class="keyword">this</span>.column &#125;);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">this</span>.$emit(<span class="string">'input'</span>, result);</span><br><span class="line">    <span class="keyword">this</span>.$emit(<span class="string">'change'</span>, result);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="ag-grid超强表格"><a href="#ag-grid超强表格" class="headerlink" title="ag-grid超强表格"></a>ag-grid超强表格</h3><ul><li><a href="https://www.ag-grid.com/example.php" target="_blank" rel="noopener">官网案例</a>、<a href="https://github.com/ag-grid/ag-grid-vue-example" target="_blank" rel="noopener">整合vue案例</a></li></ul><h3 id="vxe-table"><a href="#vxe-table" class="headerlink" title="vxe-table"></a>vxe-table</h3><ul><li>一款基于Vue的表格插件，支持大量数据渲染，编辑表格等功能</li><li><a href="https://github.com/x-extends/vxe-table" target="_blank" rel="noopener">github</a>、<a href="https://xuliangzhan_admin.gitee.io/vxe-table/#/table/start/install" target="_blank" rel="noopener">doc</a></li><li>优点<ul><li>大数据表格</li><li>自带打印功能：区域、分页、模板、样式等打印功能</li></ul></li><li>说明<ul><li>vxe-table 只能用于静态列（vxe-table-column，避免使用 v-for 去动态修改，如果要动态列其使用 v-grid）</li><li>vxe-grid 支持一切动态场景<ul><li>grid 继承 table 100%的功能，vxe-grid 的性能也比 vxe-table 快一倍</li><li>vue 多数情况还是推荐使用语义化标签的形式；而对于动态场景用 grid 就更加灵活，可以实现远程配置化一体化</li></ul></li></ul></li><li><strong>表格显示/隐藏后样式丢失问题，弹框表格列宽问题</strong><ul><li><code>auto-resize</code>或<code>sync-resize</code> 绑定指定的变量来触发重新计算表格。参考：<a href="https://xuliangzhan_admin.gitee.io/vxe-table/#/table/advanced/tabs" target="_blank" rel="noopener">https://xuliangzhan_admin.gitee.io/vxe-table/#/table/advanced/tabs</a></li></ul></li><li>和iview等组件结合使用时，modal等z-index存在冲突(如表格列过长提示)，建议弹框和弹框中涉及z-index的元素使用同一组件，如全部使用vxe-table</li><li>多选 + 修改页面表格数据(仅修改页面数据)。选中事件方法和选中所有事件方法是两个方法</li></ul><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 获取行记录</span></span><br><span class="line"><span class="keyword">let</span> checkboxRow = <span class="keyword">this</span>.tableRef.getCheckboxRecords();</span><br><span class="line"><span class="keyword">const</span> selectRecords = checkboxRow.map(<span class="function">(<span class="params">item</span>) =&gt;</span> item.id); <span class="comment">// 如果返回数据中没有id字段，则在渲染时会自动生成一个row_xxx的唯一id</span></span><br><span class="line"><span class="keyword">if</span> (!selectRecords || selectRecords.length === <span class="number">0</span>) &#123;</span><br><span class="line">    alert(<span class="string">"请先选择记录"</span>);</span><br><span class="line">    <span class="keyword">return</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// 调用修改数据api略...</span></span><br><span class="line"><span class="comment">// 修改页面行记录数据</span></span><br><span class="line">checkboxRow.forEach(<span class="function">(<span class="params">row</span>) =&gt;</span> &#123;</span><br><span class="line">    row.validStatus = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">this</span>.$refs.tableRef.reloadRow(row, <span class="literal">null</span>, <span class="string">'validStatus'</span>); <span class="comment">// 仅修改单个字段</span></span><br><span class="line">    <span class="comment">// this.$refs.tableRef.reloadRow(currentRow, rowNewData, null); // 基于rowNewData修改一整行的数据(如果rowNewData无表格列定义的字段将会置空)</span></span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 从列表中移除数据行</span></span><br><span class="line"><span class="comment">// 1.修改页面显示缓存，this.allData数据并没有删除</span></span><br><span class="line"><span class="keyword">this</span>.$refs.tableRef.remove(row)</span><br><span class="line"><span class="keyword">this</span>.$refs.tableRef.removeCheckboxRow() <span class="comment">// 移除选中行</span></span><br><span class="line"><span class="comment">// 2.修改页面数据，this.allData数据删除了</span></span><br><span class="line"><span class="keyword">this</span>.allData = <span class="keyword">this</span>.allData.filter(<span class="function">(<span class="params">item</span>) =&gt;</span> item.id != row.id)</span><br><span class="line"><span class="keyword">this</span>.$refs.tableRef.loadData(<span class="keyword">this</span>.allData)</span><br><span class="line"></span><br><span class="line"><span class="comment">// 重新加载整个表格数据</span></span><br><span class="line"><span class="keyword">this</span>.$refs.tableRef.loadData(<span class="keyword">this</span>.allData);</span><br></pre></td></tr></table></figure><ul><li>监听行的选中事件</li></ul><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// &lt;vxe-table @checkbox-change="checkboxChange"&gt;</span></span><br><span class="line">checkboxChange(table, event) &#123;</span><br><span class="line">    <span class="comment">// table对应key如下</span></span><br><span class="line">    <span class="comment">// "row"(当前选中或取消选中行), "checked"(操作完当前行后的选中状态), "items"(所有行数据), "data"(所有行数据), "records"(目前选中的所有行数据), "selection"(目前选中的所有行数据)</span></span><br><span class="line">    <span class="comment">// "$table", "$grid", "$event", "reserves", "indeterminates", "$seq", "seq", "rowid", "rowIndex", "$rowIndex", "column", "columnIndex", "$columnIndex", "_columnIndex", "fixed", "type", "isHidden", "level", "visibleData", "cell"</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li><p>表格筛选</p><ul><li><p>通过设置 filters 属性和 filter-method 方法可以开启列筛选功能，通过 filter-multiple=false 设置为单选</p><ul><li><p>filters不支持动态修改筛选配置，可通过setFilter方法</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">this</span>.hobbyOpts = XEUtils.orderBy(XEUtils.uniq(<span class="keyword">this</span>.listData.map(<span class="function"><span class="params">x</span> =&gt;</span> x.hobby))).map(<span class="function"><span class="params">x</span> =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> &#123;<span class="attr">label</span>: x, <span class="attr">value</span>: x&#125;</span><br><span class="line">&#125;)</span><br><span class="line"><span class="keyword">this</span>.$refs.userTable.setFilter(<span class="string">'hobby'</span>, <span class="keyword">this</span>.hobbyOpts)</span><br></pre></td></tr></table></figure></li></ul></li><li><p>如果是服务端筛选，只需加上 filter-config={remote: true} 和 filter-change 事件就可以实现</p><ul><li>本地筛选和服务端筛选不能同时使用，会优先触发filter-change，而不触发filter-method</li></ul></li></ul></li><li>可编辑表格、滚动分页</li></ul><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- </span></span><br><span class="line"><span class="comment">edit-config: </span></span><br><span class="line"><span class="comment">    manual 手动触发+监听cell-dblclick双击事件</span></span><br><span class="line"><span class="comment">    showStatus 展示修改状态，左上角红色小角标</span></span><br><span class="line"><span class="comment">    mode 修改时，默认整行转成可编辑状态</span></span><br><span class="line"><span class="comment">    autoClear 自动保存(关闭修改) =&gt; **input类型的需要配合 immediate: true**</span></span><br><span class="line"><span class="comment"> --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">vxe-table</span></span></span><br><span class="line"><span class="tag">    <span class="attr">ref</span>=<span class="string">"table"</span></span></span><br><span class="line"><span class="tag">    <span class="attr">border</span></span></span><br><span class="line"><span class="tag">    <span class="attr">resizable</span></span></span><br><span class="line"><span class="tag">    <span class="attr">show-overflow</span></span></span><br><span class="line"><span class="tag">    <span class="attr">keep-source</span></span></span><br><span class="line"><span class="tag">    <span class="attr">row-id</span>=<span class="string">"id"</span></span></span><br><span class="line"><span class="tag">    <span class="attr">:loading</span>=<span class="string">"loading"</span></span></span><br><span class="line"><span class="tag">    @<span class="attr">scroll</span>=<span class="string">"scroll"</span></span></span><br><span class="line"><span class="tag">    @<span class="attr">checkbox-change</span>=<span class="string">"checkboxChange"</span></span></span><br><span class="line"><span class="tag">    @<span class="attr">cell-dblclick</span>=<span class="string">"data =&gt; editRow(data.row)"</span></span></span><br><span class="line"><span class="tag">    <span class="attr">:checkbox-config</span>=<span class="string">"&#123; checkMethod: checkMethod &#125;"</span></span></span><br><span class="line"><span class="tag">    <span class="attr">:edit-config</span>=<span class="string">"&#123; trigger: 'manual', mode: 'row', showStatus: true, autoClear: false &#125;"</span></span></span><br><span class="line"><span class="tag">    @<span class="attr">edit-actived</span>=<span class="string">"data =&gt; (data.row.editingMode = true)"</span></span></span><br><span class="line"><span class="tag">    @<span class="attr">edit-closed</span>=<span class="string">"data =&gt; (data.row.editingMode = false)"</span></span></span><br><span class="line"><span class="tag">    @<span class="attr">scroll</span>=<span class="string">"scroll"</span></span></span><br><span class="line"><span class="tag">&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">vxe-table-column</span> <span class="attr">v-if</span>=<span class="string">"feeItemEdit"</span> <span class="attr">title</span>=<span class="string">"操作"</span> <span class="attr">width</span>=<span class="string">"80"</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">template</span> <span class="attr">v-slot</span>=<span class="string">"&#123; row &#125;"</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">div</span> <span class="attr">v-if</span>=<span class="string">"$refs.table.isActiveByRow(row)"</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">Button</span></span></span><br><span class="line"><span class="tag">                    <span class="attr">v-if</span>=<span class="string">"row.editingMode"</span></span></span><br><span class="line"><span class="tag">                    @<span class="attr">click</span>=<span class="string">"saveRow([row])"</span></span></span><br><span class="line"><span class="tag">                    <span class="attr">type</span>=<span class="string">"primary"</span></span></span><br><span class="line"><span class="tag">                    <span class="attr">size</span>=<span class="string">"small"</span></span></span><br><span class="line"><span class="tag">                    <span class="attr">icon</span>=<span class="string">"md-checkmark"</span></span></span><br><span class="line"><span class="tag">                    <span class="attr">shape</span>=<span class="string">"circle"</span></span></span><br><span class="line"><span class="tag">                    <span class="attr">style</span>=<span class="string">"margin-right:5px;"</span></span></span><br><span class="line"><span class="tag">                &gt;</span><span class="tag">&lt;/<span class="name">Button</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">Button</span> @<span class="attr">click</span>=<span class="string">"cancelRow(row)"</span> <span class="attr">type</span>=<span class="string">"warning"</span> <span class="attr">size</span>=<span class="string">"small"</span> <span class="attr">icon</span>=<span class="string">"md-close"</span> <span class="attr">shape</span>=<span class="string">"circle"</span>&gt;</span><span class="tag">&lt;/<span class="name">Button</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">div</span> <span class="attr">v-else</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">Button</span></span></span><br><span class="line"><span class="tag">                    @<span class="attr">click</span>=<span class="string">"editRow(row)"</span></span></span><br><span class="line"><span class="tag">                    <span class="attr">size</span>=<span class="string">"small"</span></span></span><br><span class="line"><span class="tag">                    <span class="attr">icon</span>=<span class="string">"ios-create"</span></span></span><br><span class="line"><span class="tag">                    <span class="attr">shape</span>=<span class="string">"circle"</span></span></span><br><span class="line"><span class="tag">                    <span class="attr">style</span>=<span class="string">"margin-right:5px;"</span></span></span><br><span class="line"><span class="tag">                &gt;</span><span class="tag">&lt;/<span class="name">Button</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">Button</span> @<span class="attr">click</span>=<span class="string">"deleteMulti(row)"</span> <span class="attr">size</span>=<span class="string">"small"</span> <span class="attr">icon</span>=<span class="string">"ios-trash"</span> <span class="attr">shape</span>=<span class="string">"circle"</span>&gt;</span><span class="tag">&lt;/<span class="name">Button</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">template</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">vxe-table-column</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">vxe-table-column</span> <span class="attr">description</span>=<span class="string">"结算客户"</span> <span class="attr">field</span>=<span class="string">"bizClearingCustomerId"</span> <span class="attr">:title</span>=<span class="string">"$t('customer_name1')"</span> <span class="attr">width</span>=<span class="string">"300"</span> <span class="attr">:edit-render</span>=<span class="string">"&#123;&#125;"</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">template</span> <span class="attr">v-slot:edit</span>=<span class="string">"scope"</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">Select</span></span></span><br><span class="line"><span class="tag">                <span class="attr">:ref</span>=<span class="string">"'bccn' + scope.row.id"</span></span></span><br><span class="line"><span class="tag">                <span class="attr">v-model</span>=<span class="string">"scope.row.bizClearingCustomerId"</span></span></span><br><span class="line"><span class="tag">                @<span class="attr">on-change</span>=<span class="string">"</span></span></span><br><span class="line"><span class="tag"><span class="string">                    () =&gt; &#123;</span></span></span><br><span class="line"><span class="tag"><span class="string">                        scope.row.bizClearingCustomerName = getSelectFilterableLabel(scope.row.bizClearingCustomerId, dictMap.customerList)</span></span></span><br><span class="line"><span class="tag"><span class="string">                        $refs.table.updateStatus(scope)</span></span></span><br><span class="line"><span class="tag"><span class="string">                    &#125;</span></span></span><br><span class="line"><span class="tag"><span class="string">                "</span></span></span><br><span class="line"><span class="tag">                <span class="attr">transfer</span></span></span><br><span class="line"><span class="tag">                <span class="attr">filterable</span></span></span><br><span class="line"><span class="tag">                <span class="attr">:remote-method</span>=<span class="string">"clearingCustomerRemote"</span></span></span><br><span class="line"><span class="tag">                &gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">Option</span> <span class="attr">v-for</span>=<span class="string">"item in dictMap.customerList"</span> <span class="attr">:value</span>=<span class="string">"item.value"</span> <span class="attr">:label</span>=<span class="string">"item.label"</span> <span class="attr">:key</span>=<span class="string">"item.value"</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">span</span> <span class="attr">v-if</span>=<span class="string">"item.customerNo"</span>&gt;</span>&#123;&#123; item.customerNo &#125;&#125;：<span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line">                    &#123;&#123; item.label &#125;&#125;</span><br><span class="line">                <span class="tag">&lt;/<span class="name">Option</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">Select</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">template</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">template</span> <span class="attr">v-slot</span>=<span class="string">"&#123; row &#125;"</span>&gt;</span>&#123;&#123; row.bizClearingCustomerName &#125;&#125;<span class="tag">&lt;/<span class="name">template</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">vxe-table-column</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">vxe-table-column</span> <span class="attr">field</span>=<span class="string">"feeCurrentRate"</span> <span class="attr">title</span>=<span class="string">"汇率"</span> <span class="attr">width</span>=<span class="string">"90"</span> <span class="attr">:edit-render</span>=<span class="string">"&#123; name: 'input', immediate: true &#125;"</span>&gt;</span><span class="tag">&lt;/<span class="name">vxe-table-column</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!-- 自定义筛选 --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">vxe-table-column</span> <span class="attr">field</span>=<span class="string">"orderType"</span> <span class="attr">title</span>=<span class="string">"订单类型"</span> <span class="attr">sortable</span> <span class="attr">:filters</span>=<span class="string">"orderTypeList"</span>&gt;</span><span class="tag">&lt;/<span class="name">vxe-table-column</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">vxe-table-column</span> <span class="attr">field</span>=<span class="string">"orderNo"</span> <span class="attr">title</span>=<span class="string">"订单号"</span> <span class="attr">sortable</span></span></span><br><span class="line"><span class="tag">        <span class="attr">:filters</span>=<span class="string">"[&#123;data: ''&#125;]"</span> <span class="attr">:filter-method</span>=<span class="string">"(&#123; option, row &#125;) =&gt; row.orderNo === option.data"</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">template</span> #<span class="attr">filter</span>=<span class="string">"&#123; $panel, column &#125;"</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">AutoComplete</span></span></span><br><span class="line"><span class="tag">                <span class="attr">v-for</span>=<span class="string">"(option, index) in column.filters"</span> <span class="attr">:key</span>=<span class="string">"index"</span></span></span><br><span class="line"><span class="tag">                <span class="attr">type</span>=<span class="string">"type"</span></span></span><br><span class="line"><span class="tag">                <span class="attr">v-model</span>=<span class="string">"option.data"</span></span></span><br><span class="line"><span class="tag">                <span class="attr">:data</span>=<span class="string">"row._orderNoFilterList"</span></span></span><br><span class="line"><span class="tag">                @<span class="attr">on-search</span>=<span class="string">"(v) =&gt; &#123;</span></span></span><br><span class="line"><span class="tag"><span class="string">                    row._orderNoFilterList = allData.filter(x =&gt; x.orderNo &amp;&amp; x.orderNo.indexOf(v) &gt;= 0).map(x =&gt; x.orderNo)</span></span></span><br><span class="line"><span class="tag"><span class="string">                &#125;"</span></span></span><br><span class="line"><span class="tag">                @<span class="attr">on-change</span>=<span class="string">"(value, $event) =&gt; $panel.changeOption($event, !!option.data, option)"</span></span></span><br><span class="line"><span class="tag">                @<span class="attr">keyup.enter.native</span>=<span class="string">"$panel.confirmFilter()"</span></span></span><br><span class="line"><span class="tag">            &gt;</span><span class="tag">&lt;/<span class="name">AutoComplete</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">template</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">vxe-table-column</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">vxe-table</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="undefined"></span></span><br><span class="line"><span class="undefined">fetchData() &#123;</span></span><br><span class="line"><span class="javascript">    <span class="keyword">this</span>.$ajax(&#123;&#125;).then(<span class="function">(<span class="params">&#123; data &#125;</span>) =&gt;</span> &#123;</span></span><br><span class="line"><span class="javascript">        <span class="keyword">this</span>.dataList = data.list</span></span><br><span class="line"><span class="javascript">        <span class="comment">// 从结果集中提取筛选下拉，并设置到对应表格中</span></span></span><br><span class="line"><span class="javascript">        <span class="keyword">this</span>.orderTypeList = XEUtils.orderBy(XEUtils.uniq(<span class="keyword">this</span>.dataList.map(<span class="function"><span class="params">x</span> =&gt;</span> x.orderType))).map(<span class="function"><span class="params">y</span> =&gt;</span> &#123;</span></span><br><span class="line"><span class="javascript">            <span class="keyword">return</span> &#123;<span class="attr">label</span>: y, <span class="attr">value</span>: y&#125;</span></span><br><span class="line"><span class="undefined">        &#125;)</span></span><br><span class="line"><span class="javascript">        <span class="keyword">this</span>.$refs.table.setFilter(<span class="string">'orderType'</span>, <span class="keyword">this</span>.orderTypeList)</span></span><br><span class="line"><span class="undefined">    &#125;)</span></span><br><span class="line"><span class="undefined">&#125;,</span></span><br><span class="line"><span class="undefined">editRow(row) &#123;</span></span><br><span class="line"><span class="javascript">    <span class="keyword">if</span> (!<span class="keyword">this</span>.checkRow()) <span class="keyword">return</span> <span class="literal">false</span></span></span><br><span class="line"><span class="javascript">    <span class="keyword">this</span>.$refs.table.setActiveRow(row).then(<span class="function"><span class="params">()</span> =&gt;</span> &#123;</span></span><br><span class="line"><span class="javascript">        <span class="comment">// 远程搜索解决方案</span></span></span><br><span class="line"><span class="javascript">        <span class="keyword">this</span>.$refs[<span class="string">'bccn'</span> + row.id].setQuery(row.bizClearingCustomerName)</span></span><br><span class="line"><span class="undefined">    &#125;)</span></span><br><span class="line"><span class="undefined">&#125;,</span></span><br><span class="line"><span class="undefined">cancelRow() &#123;</span></span><br><span class="line"><span class="javascript">    <span class="keyword">const</span> table = <span class="keyword">this</span>.$refs.table</span></span><br><span class="line"><span class="javascript">    table.clearActived().then(<span class="function"><span class="params">()</span> =&gt;</span> &#123;</span></span><br><span class="line"><span class="undefined">        table.revertData()</span></span><br><span class="line"><span class="undefined">    &#125;)</span></span><br><span class="line"><span class="undefined">&#125;,</span></span><br><span class="line"><span class="undefined">checkRow() &#123;</span></span><br><span class="line"><span class="javascript">    <span class="keyword">const</span> &#123; insertRecords, updateRecords &#125; = <span class="keyword">this</span>.$refs.table.getRecordset()</span></span><br><span class="line"><span class="javascript">    <span class="keyword">if</span> (insertRecords.length &gt; <span class="number">0</span> || updateRecords.length &gt; <span class="number">0</span>) &#123;</span></span><br><span class="line"><span class="javascript">        <span class="keyword">this</span>.$Message.warning(<span class="string">'您有待保存数据，请先保存'</span>)</span></span><br><span class="line"><span class="javascript">        <span class="keyword">return</span> <span class="literal">false</span></span></span><br><span class="line"><span class="undefined">    &#125;</span></span><br><span class="line"><span class="javascript">    <span class="keyword">return</span> <span class="literal">true</span></span></span><br><span class="line"><span class="undefined">&#125;,</span></span><br><span class="line"><span class="javascript">getSelectFilterableLabel(value, list, valueProp = <span class="string">'value'</span>, labelField = <span class="string">'label'</span>) &#123;</span></span><br><span class="line"><span class="javascript">    <span class="keyword">const</span> item = XEUtils.find(list, item =&gt; item[valueProp] == value)</span></span><br><span class="line"><span class="javascript">    <span class="keyword">return</span> item ? item[labelField] : <span class="literal">null</span></span></span><br><span class="line"><span class="undefined">&#125;,</span></span><br><span class="line"><span class="javascript"><span class="comment">// 滚动分页</span></span></span><br><span class="line"><span class="undefined">scroll (table, $event) &#123;</span></span><br><span class="line"><span class="javascript">    <span class="keyword">this</span>.vexScrollPage(</span></span><br><span class="line"><span class="undefined">        table,</span></span><br><span class="line"><span class="javascript">        <span class="keyword">this</span>.tableRef[<span class="string">'$el'</span>],</span></span><br><span class="line"><span class="javascript">        <span class="keyword">this</span>.allData,</span></span><br><span class="line"><span class="javascript">        <span class="keyword">this</span>.searchForm,</span></span><br><span class="line"><span class="javascript">        <span class="keyword">this</span>.fetchData</span></span><br><span class="line"><span class="undefined">    )</span></span><br><span class="line"><span class="undefined">&#125;,</span></span><br><span class="line"><span class="undefined">vexScrollPage(table, el, allData, searchForm, fetchData) &#123;</span></span><br><span class="line"><span class="javascript">  <span class="keyword">if</span> (allData.length &gt;= searchForm.pageTotal) &#123;</span></span><br><span class="line"><span class="javascript">    <span class="keyword">return</span></span></span><br><span class="line"><span class="undefined">  &#125;</span></span><br><span class="line"><span class="javascript">  <span class="keyword">let</span> scrollHeight = el.getElementsByClassName(<span class="string">'body--wrapper'</span>)[<span class="number">1</span>].scrollHeight</span></span><br><span class="line"><span class="javascript">  <span class="keyword">const</span> scrollHeight2 = el.getElementsByClassName(<span class="string">'vxe-body--y-space'</span>)[<span class="number">0</span>].style.height.replace(<span class="string">'px'</span>, <span class="string">''</span>)</span></span><br><span class="line"><span class="javascript">  <span class="keyword">if</span> (scrollHeight2) &#123;</span></span><br><span class="line"><span class="javascript">    <span class="comment">// 矫正，有时候scrollHeight会多出一个48px值导致无法获取下一页</span></span></span><br><span class="line"><span class="javascript">    scrollHeight = <span class="built_in">Number</span>(scrollHeight2)</span></span><br><span class="line"><span class="undefined">  &#125;</span></span><br><span class="line"><span class="javascript">  <span class="keyword">const</span> clientHeight = el.getElementsByClassName(<span class="string">'body--wrapper'</span>)[<span class="number">1</span>].clientHeight</span></span><br><span class="line"><span class="javascript">  <span class="keyword">const</span> scrollTop = el.getElementsByClassName(<span class="string">'body--wrapper'</span>)[<span class="number">1</span>].scrollTop</span></span><br><span class="line"><span class="javascript">  <span class="keyword">if</span> (scrollHeight === clientHeight + scrollTop) &#123;</span></span><br><span class="line"><span class="undefined">    searchForm.pageCurrent = searchForm.pageCurrent + 1</span></span><br><span class="line"><span class="undefined">    fetchData()</span></span><br><span class="line"><span class="undefined">  &#125;</span></span><br><span class="line"><span class="undefined">&#125;</span></span><br><span class="line"><span class="undefined"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure><ul><li>vxe-grid</li></ul><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- toolbar-config: 工具栏，开启字段自定义、打印、导出；custom-config：字段自定义配置，此时将自定义字段保存到localStorage，否则每次刷新会重置（需要定义全局唯一ID，整个项目全部保存在名为VXE_TABLE_CUSTOM_COLUMN_VISIBLE的localStorage中） --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">vxe-grid</span> <span class="attr">size</span>=<span class="string">"mini"</span> <span class="attr">ref</span>=<span class="string">"notShipTable"</span> <span class="attr">id</span>=<span class="string">"TransferManageNotShipTable"</span></span></span><br><span class="line"><span class="tag">    <span class="attr">border</span> <span class="attr">resizable</span> <span class="attr">show-overflow</span> <span class="attr">keep-source</span></span></span><br><span class="line"><span class="tag">    <span class="attr">class</span>=<span class="string">"sq-vxe__toolmin sq-vxe__modal"</span></span></span><br><span class="line"><span class="tag">    <span class="attr">:loading</span>=<span class="string">"notShipLoading"</span></span></span><br><span class="line"><span class="tag">    <span class="attr">:height</span>=<span class="string">"scrollerHeight"</span></span></span><br><span class="line"><span class="tag">    <span class="attr">:columns</span>=<span class="string">"notShipCols"</span></span></span><br><span class="line"><span class="tag">    <span class="attr">:toolbar-config</span>=<span class="string">"&#123;custom: true, export: true, print: true&#125;"</span></span></span><br><span class="line"><span class="tag">    <span class="attr">:custom-config</span>=<span class="string">"&#123;storage: &#123;visible: true&#125;&#125;"</span> <span class="attr">:exportConfig</span>=<span class="string">"&#123;&#125;"</span> <span class="attr">:printConfig</span>=<span class="string">"&#123;&#125;"</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">vxe-grid</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="undefined"></span></span><br><span class="line"><span class="undefined">create() &#123;</span></span><br><span class="line"><span class="javascript">    <span class="comment">// 不要直接在DOM中调用 getColumns, 否则编辑点击新增/编辑等按钮是，此方法会重复调用从而导致排序丢失</span></span></span><br><span class="line"><span class="javascript">    <span class="keyword">this</span>.notShipCols = <span class="keyword">this</span>.getColumns(<span class="string">'notShip'</span>)</span></span><br><span class="line"><span class="undefined">&#125;</span></span><br><span class="line"><span class="undefined"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">&lt;!-- 解决和iview Tabs结合使用问题：modal不跟随当前Tab展示 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">style</span> <span class="attr">lang</span>=<span class="string">"less"</span>&gt;</span><span class="undefined"></span></span><br><span class="line"><span class="css"><span class="selector-class">.sq-vxe__toolmin</span> &#123;</span></span><br><span class="line"><span class="css">  <span class="selector-class">.vxe-grid--toolbar-wrapper</span> &#123;</span></span><br><span class="line"><span class="undefined">    display: inline-block;</span></span><br><span class="line"><span class="undefined">    position: absolute;</span></span><br><span class="line"><span class="undefined">    right: 0;</span></span><br><span class="line"><span class="undefined">    top: -50px;</span></span><br><span class="line"><span class="css">    <span class="selector-class">.vxe-toolbar</span> &#123;</span></span><br><span class="line"><span class="undefined">      height: auto;</span></span><br><span class="line"><span class="undefined">    &#125;</span></span><br><span class="line"><span class="undefined">  &#125;</span></span><br><span class="line"><span class="undefined">&#125;</span></span><br><span class="line"><span class="css"><span class="selector-class">.ivu-tabs-tabpane</span> &#123;</span></span><br><span class="line"><span class="undefined">  position: relative;</span></span><br><span class="line"><span class="css">  <span class="selector-class">.vxe-table</span> &#123;</span></span><br><span class="line"><span class="css">    <span class="selector-class">.vxe-modal--wrapper</span>,<span class="selector-class">.vxe-modal--box</span> &#123;</span></span><br><span class="line"><span class="undefined">      position: absolute;</span></span><br><span class="line"><span class="undefined">    &#125;</span></span><br><span class="line"><span class="undefined">  &#125;</span></span><br><span class="line"><span class="undefined">&#125;</span></span><br><span class="line"><span class="css"><span class="selector-class">.sq-vxe__modal</span> &#123;</span></span><br><span class="line"><span class="css">  <span class="selector-class">.vxe-modal--box</span> &#123;</span></span><br><span class="line"><span class="undefined">    top: 70px !important;</span></span><br><span class="line"><span class="undefined">    left: 500px !important;</span></span><br><span class="line"><span class="undefined">  &#125;</span></span><br><span class="line"><span class="undefined">&#125;</span></span><br><span class="line"><span class="css">@<span class="keyword">media</span> screen and (max-width: <span class="number">1400px</span>)&#123;</span></span><br><span class="line"><span class="css">  <span class="selector-class">.sq-vxe__modal</span> &#123;</span></span><br><span class="line"><span class="css">    <span class="selector-class">.vxe-modal--box</span> &#123;</span></span><br><span class="line"><span class="undefined">      top: 0px !important;</span></span><br><span class="line"><span class="undefined">      left: 150px !important;</span></span><br><span class="line"><span class="undefined">    &#125;</span></span><br><span class="line"><span class="undefined">  &#125;</span></span><br><span class="line"><span class="undefined">&#125;</span></span><br><span class="line"><span class="undefined"></span><span class="tag">&lt;/<span class="name">style</span>&gt;</span></span><br></pre></td></tr></table></figure><ul><li>打印，<a href="https://xuliangzhan_admin.gitee.io/vxe-table/#/table/module/print" target="_blank" rel="noopener">参考</a></li></ul><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> VXETable <span class="keyword">from</span> <span class="string">'vxe-table'</span></span><br><span class="line">VXETable.print(&#123;</span><br><span class="line">    sheetName: <span class="string">'打印自定义模板'</span>,</span><br><span class="line">    style: printStyle, <span class="comment">// 自定义样式（传入content的html中只能写行内样式，块样式需从此处传入）</span></span><br><span class="line">    <span class="comment">// 区域打印，可自己写组件，而不是通过字符串拼接。但是有个问题，如果使用了vxe-table等插件渲染html元素，则样式会丢失，可自己写简单的html标签和样式解决</span></span><br><span class="line">    content: nodeToString(<span class="keyword">this</span>.$refs.printDivId.$el)</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line">nodeToString ( node ) &#123;</span><br><span class="line">    <span class="keyword">let</span> tmpNode = <span class="built_in">document</span>.createElement(<span class="string">"div"</span>);</span><br><span class="line">    tmpNode.appendChild(node.cloneNode(<span class="literal">true</span>));</span><br><span class="line">    <span class="keyword">let</span> str = tmpNode.innerHTML;</span><br><span class="line">    tmpNode = node = <span class="literal">null</span>;</span><br><span class="line">    <span class="keyword">return</span> str;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="MyUI"><a href="#MyUI" class="headerlink" title="MyUI"></a>MyUI</h3><ul><li><a href="http://newgateway.gitee.io/my/" target="_blank" rel="noopener">MyUI</a></li><li>包含基础组件、<strong>图表</strong>、<strong>地图</strong>、关系图、<strong>大屏</strong>等功能<ul><li>内置了百度、高德</li><li>支持与ECharts结合实现散点、飞行迁徙等基于地理位置的图表</li></ul></li></ul><h3 id="Quasar"><a href="#Quasar" class="headerlink" title="Quasar"></a>Quasar</h3><ul><li><code>Quasar</code>：基于Vue的UI框架，可以整合<code>Cordova</code>开发移动App，也可以整合<code>Electron</code>开发桌面程序</li><li>常用习惯<ul><li><code>Ripple</code> 可以使按钮展示出波纹，不使用此波纹则需要去掉<code>quasar.conf.js</code> - <code>directives</code> 中的 <code>Ripple</code> 项</li></ul></li></ul><h2 id="底层硬件库"><a href="#底层硬件库" class="headerlink" title="底层硬件库"></a>底层硬件库</h2><h3 id="Clipboard-复制内容到剪贴板"><a href="#Clipboard-复制内容到剪贴板" class="headerlink" title="Clipboard 复制内容到剪贴板"></a>Clipboard 复制内容到剪贴板</h3><ul><li>必须要绑定Dom</li><li>必须要触发点击事件（触发其他Dom的点击事件，然后js触发目的dom的点击事件也可）</li></ul><h3 id="扫码-条码生成"><a href="#扫码-条码生成" class="headerlink" title="扫码/条码生成"></a>扫码/条码生成</h3><h4 id="H5页面扫码"><a href="#H5页面扫码" class="headerlink" title="H5页面扫码"></a>H5页面扫码</h4><ul><li>在微信浏览器打开H5页面，可引入微信的js SDK解决（需域名和微信公众号绑定）</li><li>在系统浏览器打开H5页面<ul><li>基于<a href="https://github.com/cozmo/jsQR" target="_blank" rel="noopener">jsQR</a>、<a href="https://github.com/gruhn/vue-qrcode-reader" target="_blank" rel="noopener">vue-qrcode-reader(本质基于jsQR)</a><ul><li>调取摄像头(进行录像)识别二维码，每个页面需要同意调用摄像头(网页可设置永久同意)</li><li>优点是无需拍照确认识别(会自动识别，出错率低)，<strong>但是必须要https才行</strong></li></ul></li><li>基于<a href="https://github.com/LazarSoft/jsqrcode" target="_blank" rel="noopener">jsqrcode</a>库，可进行二维码/条形码解析，可生成条形码<ul><li>参考：<a href="https://www.cnblogs.com/yisuowushinian/p/5145262.html，此方案在前端" target="_blank" rel="noopener">https://www.cnblogs.com/yisuowushinian/p/5145262.html，此方案在前端</a> js 解析二维码，依赖<code>jsqrcode</code></li><li>这个库已经支持在浏览器端呼起摄像头的操作了，但是依赖一个叫<code>getUserMedia</code>的属性，该属性移动端的浏览器支持的都不是很好，低版本只能间接的上传图片的方式解析二维码</li><li>此插件需要配合 zepto.js 或者 jQuery.js 使用(主要用来拍照的，如果使用uni-app则不需要此依赖，可使用uni.chooseImage拍照)；webpack打包需要canvas<ul><li>安装 <code>cnpm install jsqrcode -S</code>、<code>cnpm install canvas -S</code></li></ul></li><li>扫码时无扫码框，需要点击拍照 - 确定识别（iphone7扫二维码成功，条形码不成功）</li><li>缺点需要确认拍照进行识别，拍照需要清晰，出错率高</li></ul></li><li>基于<code>quagga.js</code>库，可进行条形码解析<ul><li>如uni-app插件：<a href="https://ext.dcloud.net.cn/plugin?id=1619" target="_blank" rel="noopener">https://ext.dcloud.net.cn/plugin?id=1619</a></li></ul></li></ul></li></ul><h4 id="H5页面扫码案例（基于uni-app）"><a href="#H5页面扫码案例（基于uni-app）" class="headerlink" title="H5页面扫码案例（基于uni-app）"></a>H5页面扫码案例（基于uni-app）</h4><ul><li>扫码流程<ul><li>通过微信浏览器访问的，默认调用微信扫码。需要引入<code>weixin-js-sdk</code></li><li>通过手机普通浏览器访问的，如果是https模式访问，则调用摄像头录像扫码，需引入<code>vue-qrcode-reader</code></li><li>如果是普通浏览器访问，且以http默认访问，则调用拍照扫码，需引入<code>jsqrcode</code>和<code>canvas</code></li></ul></li><li>scan.vue</li></ul><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br></pre></td><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">  &lt;div&gt;</span><br><span class="line">	&lt;text class=&quot;lg cuIcon-scan margin-right&quot; @click=&quot;handleScan&quot; style=&quot;font-size: 40upx;&quot;&gt;&lt;/text&gt;</span><br><span class="line">	</span><br><span class="line">    &lt;span v-if=&quot;showQrcode&quot;&gt;</span><br><span class="line">		&lt;view class=&quot;cu-modal show&quot; v-show=&quot;showQrcodeDialog&quot;&gt;</span><br><span class="line">			&lt;view class=&quot;cu-dialog&quot;&gt;</span><br><span class="line">				&lt;view class=&quot;cu-bar bg-white justify-end scan-close&quot;&gt;</span><br><span class="line">					&lt;view class=&quot;action&quot; @tap=&quot;closeDialog&quot;&gt;</span><br><span class="line">						&lt;text class=&quot;cuIcon-close text-red&quot;&gt;&lt;/text&gt;</span><br><span class="line">					&lt;/view&gt;</span><br><span class="line">				&lt;/view&gt;</span><br><span class="line">				&lt;view class=&quot;bg-white&quot;&gt;</span><br><span class="line">					&lt;qrcode-stream @decode=&quot;onDecode&quot; @init=&quot;onInit&quot; /&gt;</span><br><span class="line">				&lt;/view&gt;</span><br><span class="line">			&lt;/view&gt;</span><br><span class="line">		&lt;/view&gt;</span><br><span class="line">	&lt;/span&gt;</span><br><span class="line">  &lt;/div&gt;</span><br><span class="line">&lt;/template&gt;</span><br><span class="line"></span><br><span class="line">&lt;script&gt;</span><br><span class="line">import wechat from &apos;@/utils/wechat.js&apos; </span><br><span class="line">import &#123; QrcodeStream &#125; from &apos;vue-qrcode-reader&apos; // &quot;vue-qrcode-reader&quot;: &quot;^2.3.9&quot;</span><br><span class="line">let Canvas = require(&apos;canvas&apos;) // &quot;canvas&quot;: &quot;^2.6.1&quot;</span><br><span class="line">let jsqrcode = require(&apos;jsqrcode&apos;)(Canvas) // &quot;jsqrcode&quot;: &quot;^0.0.7&quot;</span><br><span class="line"></span><br><span class="line">export default &#123;</span><br><span class="line">  components: &#123; QrcodeStream &#125;,</span><br><span class="line">  props: &#123;</span><br><span class="line">	  callback: &#123;</span><br><span class="line">		  type: Function,</span><br><span class="line">		  default: () =&gt; &#123;&#125;</span><br><span class="line">	  &#125;</span><br><span class="line">  &#125;,</span><br><span class="line">  data () &#123;</span><br><span class="line">    return &#123;</span><br><span class="line">	  showQrcode: false,</span><br><span class="line">	  showQrcodeDialog: false</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;,</span><br><span class="line">  methods: &#123;</span><br><span class="line">    onInit(promise) &#123;</span><br><span class="line">      promise.then(() =&gt; &#123;</span><br><span class="line">		this.showQrcodeDialog = true</span><br><span class="line">      &#125;).catch(error =&gt; &#123;</span><br><span class="line">		console.log(error);</span><br><span class="line">		this.showQrcode = false</span><br><span class="line">		</span><br><span class="line">		let errorMessage = &quot;&quot;</span><br><span class="line">		if (error.name === &apos;NotAllowedError&apos;) &#123;</span><br><span class="line">		  errorMessage = &apos;请允许访问摄像头&apos;</span><br><span class="line">		&#125; else if (error.name === &apos;NotFoundError&apos;) &#123;</span><br><span class="line">		  errorMessage = &apos;此设备无摄像头&apos;</span><br><span class="line">		&#125; else if (error.name === &apos;NotSupportedError&apos;) &#123;</span><br><span class="line">		  errorMessage = &apos;Seems like this page is served in non-secure context (HTTPS, localhost or file://)&apos;</span><br><span class="line">		&#125; else if (error.name === &apos;NotReadableError&apos;) &#123;</span><br><span class="line">		  errorMessage = &apos;无法访问摄像头，请确认摄像头是否正常工作&apos;</span><br><span class="line">		&#125; else if (error.name === &apos;OverconstrainedError&apos;) &#123;</span><br><span class="line">		  errorMessage = &apos;摄像头不兼容&apos;</span><br><span class="line">		&#125; else &#123;</span><br><span class="line">		  errorMessage = &apos;UNKNOWN ERROR: &apos; + error.message</span><br><span class="line">		&#125;</span><br><span class="line">		</span><br><span class="line">		// 尝试使用jsqrcode</span><br><span class="line">		uni.chooseImage(&#123;</span><br><span class="line">			sourceType: [&apos;camera&apos;],</span><br><span class="line">			sizeType: &apos;original&apos;,</span><br><span class="line">			count: 1,</span><br><span class="line">			success: (res) =&gt; &#123;</span><br><span class="line">				let image = new Image()</span><br><span class="line">				let that = this</span><br><span class="line">				image.onload = function() &#123;</span><br><span class="line">				  let result</span><br><span class="line">				  try &#123;</span><br><span class="line">				    result = jsqrcode.decode(image)</span><br><span class="line">				    that.callback(result)</span><br><span class="line">				  &#125; catch(e) &#123;</span><br><span class="line">					console.error(e);</span><br><span class="line">					</span><br><span class="line">					errorMessage += &apos;；请确认是否为有效二维码或机器不兼容&apos;</span><br><span class="line">					uni.showToast(&#123;</span><br><span class="line">						title: errorMessage,</span><br><span class="line">						icon: &apos;none&apos;,</span><br><span class="line">						duration: 4000</span><br><span class="line">					&#125;)</span><br><span class="line">				  &#125;</span><br><span class="line">				&#125;</span><br><span class="line">				image.src = res.tempFilePaths</span><br><span class="line">			&#125;,</span><br><span class="line">			fail: (err) =&gt; &#123;</span><br><span class="line">				console.log(err);</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;)</span><br><span class="line">      &#125;)</span><br><span class="line">    &#125;,</span><br><span class="line">	onDecode (result) &#123;</span><br><span class="line">		this.closeDialog()</span><br><span class="line">		this.callback(result)</span><br><span class="line">	&#125;,</span><br><span class="line">	handleScan () &#123;</span><br><span class="line">		if(uni.getStorageSync(&quot;apsm-h5-wx&quot;)) &#123;</span><br><span class="line">			wechat.scan((res) =&gt; &#123;</span><br><span class="line">				this.callback(res)</span><br><span class="line">			&#125;)</span><br><span class="line">		&#125; else &#123;</span><br><span class="line">			this.showQrcode = true</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;,</span><br><span class="line">	closeDialog() &#123;</span><br><span class="line">		this.showQrcodeDialog = false</span><br><span class="line">		this.showQrcode = false</span><br><span class="line">	&#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line">&lt;/script&gt;</span><br><span class="line">&lt;style&gt;</span><br><span class="line">.scan-close &#123;</span><br><span class="line">	position: absolute;</span><br><span class="line">	top: 0;</span><br><span class="line">	right: 0;</span><br><span class="line">	z-index: 1;</span><br><span class="line">	background: transparent;</span><br><span class="line">&#125;</span><br><span class="line">&lt;/style&gt;</span><br></pre></td></tr></table></figure><ul><li>wechat.js</li></ul><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// #ifdef H5</span></span><br><span class="line"><span class="keyword">import</span> wx <span class="keyword">from</span> <span class="string">'weixin-js-sdk'</span>;</span><br><span class="line"><span class="comment">// #endif</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> wechat = &#123;</span><br><span class="line">    scan(callback) &#123;</span><br><span class="line">        <span class="keyword">if</span>(uni.getStorageSync(<span class="string">"apsm-h5-wx"</span>)) &#123;</span><br><span class="line">            wx.scanQRCode(&#123;</span><br><span class="line">                needResult: <span class="number">1</span>, <span class="comment">// 默认为0，扫描结果由微信处理，1则直接返回扫描结果</span></span><br><span class="line">                scanType: [<span class="string">"qrCode"</span>,<span class="string">"barCode"</span>], <span class="comment">// 可以指定扫二维码还是一维码，默认二者都有</span></span><br><span class="line">                success: <span class="function"><span class="keyword">function</span> (<span class="params">res</span>) </span>&#123;</span><br><span class="line">                    callback(res.resultStr)</span><br><span class="line">                &#125;,</span><br><span class="line">                error: <span class="function"><span class="keyword">function</span>(<span class="params">res</span>) </span>&#123;</span><br><span class="line">                    uni.showToast(&#123;</span><br><span class="line">                        title: res,</span><br><span class="line">                        icon: <span class="string">'none'</span></span><br><span class="line">                    &#125;);</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;);</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            uni.showToast(&#123;</span><br><span class="line">                title: <span class="string">'仅支持在微信中进行扫码'</span>,</span><br><span class="line">                icon: <span class="string">'none'</span></span><br><span class="line">            &#125;);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> wechat</span><br></pre></td></tr></table></figure><ul><li>调用</li></ul><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">    &lt;div&gt;</span><br><span class="line">        &lt;Scan :callback=&quot;handleScan&quot;&gt;&lt;/Scan&gt;</span><br><span class="line">    &lt;/div&gt;</span><br><span class="line">&lt;/template&gt;</span><br><span class="line"></span><br><span class="line">&lt;script&gt;</span><br><span class="line">export default &#123;</span><br><span class="line">    methods: &#123;</span><br><span class="line">        handleScan (res) &#123;</span><br><span class="line">            if(res) &#123;</span><br><span class="line">                uni.navigateTo(&#123;</span><br><span class="line">                    url: &apos;./person?id=&apos; + res</span><br><span class="line">                &#125;);</span><br><span class="line">            &#125; else &#123;</span><br><span class="line">                uni.showToast(&#123;</span><br><span class="line">                    title: &quot;未知二维码&quot;,</span><br><span class="line">                    icon: &apos;none&apos;</span><br><span class="line">                &#125;);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">&lt;/script&gt;</span><br></pre></td></tr></table></figure><h4 id="条码生成"><a href="#条码生成" class="headerlink" title="条码生成"></a>条码生成</h4><ul><li>相关插件<ul><li><code>jsqrcode</code> 可生成二维码</li><li><code>jsbarcode</code> 可生成条形码</li><li>对应的vue插件<ul><li><a href="https://github.com/lindell/vue-barcode" target="_blank" rel="noopener">vue-barcode</a></li><li><a href="https://github.com/Binaryify/vue-qr" target="_blank" rel="noopener">vue-qr</a></li><li>使用相对简单，参考：<a href="https://blog.csdn.net/qq_44833743/article/details/108773476" target="_blank" rel="noopener">https://blog.csdn.net/qq_44833743/article/details/108773476</a></li></ul></li></ul></li></ul><h3 id="打印"><a href="#打印" class="headerlink" title="打印"></a>打印</h3><ul><li><p>常见打印纸大小(宽mm*高mm，可在wps中查看)：A1 = {841,594}, A2 = {420,594}, A3 = {420,297}, <strong>A4 = {210,297}</strong>, A5 = {210,148}, A6 = {105,148}, A7 = {105,74}, A8 = {52,74}, B1 = {1e3,707}, B2 = {500,707}, B3 = {500,353}, B4 = {250,353}, B5 = {250,176}, B6 = {125,176}, B7 = {125,88}, B8 = {62,88} <a href="http://www.a4size.net/" target="_blank" rel="noopener">^3</a></p><p> <img src="/data/images/web/a4-size.png" alt="a4-size.png"></p></li><li>web打印问题(分页问题等)<ul><li>可使用 <strong><code>page-break-after</code></strong> 等css参数解决，如<code>&lt;div style=&quot;page-break-after: auto | always&quot;&gt;&lt;/div&gt;</code>。参考：<a href="https://www.w3school.com.cn/cssref/index.asp#print" target="_blank" rel="noopener">https://www.w3school.com.cn/cssref/index.asp#print</a></li><li>修改默认打印边距 <strong><code>@page {margin: 24px 18px 0 18px;}</code></strong>，或者再chrome打印预览时通过自带界面修改</li><li>修改纸张方向 <strong><code>@page {size: portrait | landscape;}</code></strong>，其中portrait纵向、landscape横向，设置后则无法在预览页面修改。谷歌支持，火狐85.0还不支持</li><li>至于mm和px换算<ul><li>公制长度单位与屏幕分辨率进行换算时，必须用到一个DPI(Dot Per Inch, 像素/英寸)指标。网页打印中，默认采用的是96dpi(像素/英寸)，而非72dpi</li><li><strong>A4为 210mm*297mm，而1英寸=25.41mm，浏览器默认为96dpi(像素/英寸)，因此对应像素为 794px*1123px</strong><ul><li>此处A4，打印页边距设定为 0mm 时，网页内最大元素的分辨率794×1123</li><li>可设置div高度为297mm，然后通过js获取div.clientHeight得出像素高度</li></ul></li><li>通过高度计算时，一般结合div的clientHeight进行计算，还需考虑页面边距。<strong>通过 1123px 等像素和手动计算高度分页，总是存在误差，效果不好</strong></li></ul></li><li>如果元素未<code>display: none;</code> 则不会显示在打印界面</li><li>table打印问题(参考下文案例)<ul><li>table包含thead、tfoot(写在tbody上面)、tbody</li><li>如果一个表格太长，会自动分页，则thead和tfoot会在每一页出现(有说需额外设置<code>display: table-header-group</code>，实测无需)</li><li>如果不希望thead重复出现，可将表头行写到tbody中</li><li>当table分页后，没一页会自动出现一个分页横线，暂未找到简单方法去掉。可通过增加<code>&lt;tfoot&gt;&lt;/tfoot&gt;</code>(里面不要有数据，否则可能会出现tfoot边框无法去掉，有时候也不管用)，来占位，并设置小page边距</li><li>当有多个小table时，需要自动判断一页显示的table个数。如vue，先渲染出页面，再计算每个table的高度，当超过一定高度，则增加一个<code>&lt;div style=&quot;page-break-after: always&quot;&gt;&lt;/div&gt;</code>使其自动分页</li></ul></li></ul></li><li>基于<a href="http://www.lodop.net/index.html" target="_blank" rel="noopener">lodop</a>打印控件</li><li>基于<a href="http://hiprint.io/" target="_blank" rel="noopener">hiprint</a>插件<ul><li>特点：基于Jquery；可视化配置模板，自动分页打印；可免费使用</li><li>缺点：源代码没开源，没有抽离 npm 包</li><li>基于vue使用参考：<a href="https://blog.csdn.net/byc233518/article/details/107705278" target="_blank" rel="noopener">https://blog.csdn.net/byc233518/article/details/107705278</a></li></ul></li><li>基于<a href="https://printjs.crabbly.com/" target="_blank" rel="noopener">print-js</a></li><li>使用<a href="#vxe-table">vxe-table</a>等插件自带打印功能</li><li>vue和electron打印问题</li></ul><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 方案一(原生API，不推荐)：VUE和electron中均可正常局部打印，只不过打印完主界面会刷新。且使用&lt;div style="page-break-after:always"&gt;&lt;/div&gt;强制分页也存在问题</span></span><br><span class="line"><span class="keyword">let</span> doc = <span class="built_in">document</span></span><br><span class="line"><span class="keyword">let</span> oldHtml = doc.body.innerHTML;<span class="comment">//将body内容先行存储</span></span><br><span class="line"><span class="keyword">let</span> printbox = doc.getElementById(<span class="string">"printPageId"</span>).innerHTML;<span class="comment">//再将所要打印区域内容赋值给body</span></span><br><span class="line">doc.body.innerHTML = printbox;<span class="comment">//再将所要打印区域内容赋值给body</span></span><br><span class="line"><span class="built_in">window</span>.print();<span class="comment">//调用全部打印事件</span></span><br><span class="line">doc.body.innerHTML = oldHtml;<span class="comment">//将body内容再返回原页面。必须，否则页面空白</span></span><br><span class="line"><span class="built_in">window</span>.location.reload();<span class="comment">//打印取消后刷新页面防止按钮不能点击。必须</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 方案二(基于jquery)：未测试</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">toPrint</span>(<span class="params">obj</span>) </span>&#123;</span><br><span class="line">	<span class="keyword">var</span> newWindow=<span class="built_in">window</span>.open(<span class="string">"打印窗口"</span>,<span class="string">"_blank"</span>);</span><br><span class="line">	<span class="keyword">var</span> docStr = obj.innerHTML; <span class="comment">// 可使用分页css</span></span><br><span class="line">	<span class="keyword">var</span> str = <span class="string">'&lt;!DOCTYPE html&gt;'</span>  </span><br><span class="line">	    str +=<span class="string">'&lt;html&gt;'</span>  </span><br><span class="line">	    str +=<span class="string">'&lt;head&gt;'</span>  </span><br><span class="line">	    str +=<span class="string">'&lt;meta charset="utf-8"&gt;'</span>  </span><br><span class="line">	    str +=<span class="string">'&lt;meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1"&gt;'</span></span><br><span class="line">	    str +=<span class="string">'&lt;/head&gt;'</span>  </span><br><span class="line">	    str +=<span class="string">'&lt;body style="-webkit-font-smoothing: antialiased;-moz-osx-font-smoothing: grayscale;"&gt;'</span>  </span><br><span class="line">	    str +=<span class="string">'&lt;div style="width:250px;height:300px;"&gt;'</span></span><br><span class="line">	    str += docStr</span><br><span class="line">	    str += <span class="string">'&lt;/div&gt;'</span></span><br><span class="line">	    str +=<span class="string">'&lt;/body&gt;'</span>  </span><br><span class="line">	    str +=<span class="string">'&lt;/html&gt;'</span>  </span><br><span class="line">	  newWindow.document.write(str);</span><br><span class="line">	  newWindow.document.close();</span><br><span class="line">	  newWindow.print();</span><br><span class="line">	  newWindow.close();  </span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 方案三(不推荐)：VUE中可正常新开标签，打印后关闭；但是electron中无法弹出打印界面</span></span><br><span class="line"><span class="keyword">this</span>.webviewHref = <span class="keyword">this</span>.$router.resolve(&#123;</span><br><span class="line">    path: <span class="string">"/myPrint?orderId=1"</span></span><br><span class="line">&#125;).href</span><br><span class="line"><span class="keyword">let</span> newWindow = <span class="built_in">window</span>.open(<span class="keyword">this</span>.webviewHref, <span class="string">"_blank"</span>); <span class="comment">// 打开新页面，相当于局部打印</span></span><br><span class="line"><span class="keyword">let</span> oldMatched = <span class="literal">false</span></span><br><span class="line"><span class="keyword">let</span> matched = <span class="literal">false</span></span><br><span class="line">newWindow.onload = <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    newWindow.matchMedia(<span class="string">'print'</span>).addListener(<span class="function"><span class="keyword">function</span>(<span class="params">e</span>) </span>&#123;</span><br><span class="line">        oldMatched = matched</span><br><span class="line">        matched = e.matches</span><br><span class="line">        <span class="keyword">if</span> (oldMatched &amp;&amp; !matched) &#123;</span><br><span class="line">            <span class="comment">// 点击打印或取消</span></span><br><span class="line">            newWindow.close();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;)</span><br><span class="line">&#125;</span><br><span class="line">newWindow.print();</span><br><span class="line"></span><br><span class="line"><span class="comment">// 方案四(基于print-js, `npm i print-js`): 可局部打印正常分页，VUE可正常打印；electron不会跳预览页面，但是可打印；可使用&lt;div style="page-break-after:always"&gt;&lt;/div&gt;强制分页</span></span><br><span class="line"><span class="comment">// 将要打印的数据放在主页面进行隐藏</span></span><br><span class="line">&lt;div style=<span class="string">"width:0; height:0; overflow: hidden"</span>&gt;</span><br><span class="line">    &lt;Print id=<span class="string">"printPageId"</span> :rows=<span class="string">"checkboxRecords"</span> @on-change=<span class="string">"onPrint"</span>/&gt;</span><br><span class="line">&lt;<span class="regexp">/div&gt;</span></span><br><span class="line"><span class="regexp"></span></span><br><span class="line"><span class="regexp">import printJS from 'print-js'</span></span><br><span class="line"><span class="regexp">onPrint() &#123;</span></span><br><span class="line"><span class="regexp">    this.$nextTick(() =&gt; &#123;</span></span><br><span class="line"><span class="regexp">        printJS(&#123;</span></span><br><span class="line"><span class="regexp">            printable: 'printPageId',</span></span><br><span class="line"><span class="regexp">            type: 'html',</span></span><br><span class="line"><span class="regexp">            /</span><span class="regexp">/ 防止Print组件中的样式不起作用</span></span><br><span class="line"><span class="regexp">            targetStyles: ['*'],</span></span><br><span class="line"><span class="regexp">            font: '',</span></span><br><span class="line"><span class="regexp">            font_size: ''</span></span><br><span class="line"><span class="regexp">        &#125;)</span></span><br><span class="line"><span class="regexp">    &#125;)</span></span><br><span class="line"><span class="regexp">&#125;</span></span><br><span class="line"><span class="regexp">/</span><span class="regexp">/ 基于electron的打印，可成功获取打印机，webview未测试成功。参考：https:/</span><span class="regexp">/zhuanlan.zhihu.com/</span>p/<span class="number">63019335</span></span><br></pre></td></tr></table></figure><ul><li>table打印案例</li></ul><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"sq-print"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"header"</span> <span class="attr">style</span>=<span class="string">"padding-bottom: 6px;"</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"main-title"</span>&gt;</span>打印报表标题<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"sub-title"</span>&gt;</span>Print Demo<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">div</span>&gt;</span>&#123;&#123; dayjs().format('YYYY年MM月DD日') &#125;&#125;<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"content"</span> <span class="attr">style</span>=<span class="string">"font-size: 12px;"</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">div</span> <span class="attr">v-for</span>=<span class="string">"(group, index) in groupList"</span> <span class="attr">:key</span>=<span class="string">"index"</span> <span class="attr">style</span>=<span class="string">"padding-bottom: 25px;"</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">table</span> <span class="attr">:ref</span>=<span class="string">"`table$&#123;index&#125;`"</span>&gt;</span></span><br><span class="line">                <span class="comment">&lt;!-- 部分时候表格分页直接到页底边了 --&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">tfoot</span>&gt;</span><span class="tag">&lt;/<span class="name">tfoot</span>&gt;</span></span><br><span class="line">                <span class="comment">&lt;!-- 只有增加了tr&gt;td才会在底部留一点空白，但是存在另外一个问题：td会有一条横线无法去除 --&gt;</span></span><br><span class="line">                <span class="comment">&lt;!-- &lt;tfoot style="border: none;background-color: #fff;color: #fff;"&gt;</span></span><br><span class="line"><span class="comment">                    &lt;tr style="border: none;background-color: #fff;color: #fff;"&gt;</span></span><br><span class="line"><span class="comment">                        &lt;td style="border: none;background-color: #fff;color: #fff;"&gt;&lt;/td&gt;</span></span><br><span class="line"><span class="comment">                    &lt;/tr&gt;</span></span><br><span class="line"><span class="comment">                &lt;/tfoot&gt; --&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">tbody</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">tr</span> <span class="attr">style</span>=<span class="string">"text-align:center;"</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">td</span> <span class="attr">style</span>=<span class="string">"width: 22%;"</span>&gt;</span>标题1<span class="tag">&lt;<span class="name">br</span>/&gt;</span>A<span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">td</span> <span class="attr">style</span>=<span class="string">"width: 14%;"</span> <span class="attr">colspan</span>=<span class="string">"2"</span>&gt;</span>标题2<span class="tag">&lt;<span class="name">br</span>/&gt;</span>B<span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">td</span> <span class="attr">style</span>=<span class="string">"width: 10%;"</span>&gt;</span>标题3<span class="tag">&lt;<span class="name">br</span>/&gt;</span>C<span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">td</span> <span class="attr">style</span>=<span class="string">"width: 5%;"</span>&gt;</span>标题4<span class="tag">&lt;<span class="name">br</span>/&gt;</span>D<span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">td</span> <span class="attr">style</span>=<span class="string">"width: 5%;"</span>&gt;</span>标题5<span class="tag">&lt;<span class="name">br</span>/&gt;</span>E<span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">td</span> <span class="attr">style</span>=<span class="string">"width: 10%;"</span>&gt;</span>标题6<span class="tag">&lt;<span class="name">br</span>/&gt;</span>F<span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">td</span> <span class="attr">style</span>=<span class="string">"width: 6%;"</span>&gt;</span>标题7<span class="tag">&lt;<span class="name">br</span>/&gt;</span>G<span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">td</span> <span class="attr">style</span>=<span class="string">"width: 6%;"</span>&gt;</span>标题8<span class="tag">&lt;<span class="name">br</span>/&gt;</span>&amp;nbsp;<span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">td</span> <span class="attr">style</span>=<span class="string">"width: 6%;"</span>&gt;</span>标题9<span class="tag">&lt;<span class="name">br</span>/&gt;</span>&amp;nbsp;<span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">td</span> <span class="attr">style</span>=<span class="string">"width: 16%;text-align:left;"</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">span</span>&gt;</span>标题10<span class="tag">&lt;/<span class="name">span</span>&gt;</span><span class="tag">&lt;<span class="name">br</span>/&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">span</span> <span class="attr">style</span>=<span class="string">"border-top: 1px solid #000;width:100%;display:inline-block;"</span>&gt;</span>J<span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;/<span class="name">tr</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">tr</span> <span class="attr">v-for</span>=<span class="string">"(row, rindex) in group.list"</span> <span class="attr">:key</span>=<span class="string">"rindex"</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">td</span> <span class="attr">v-for</span>=<span class="string">"(column, cindex) in groupField"</span> <span class="attr">:key</span>=<span class="string">"cindex"</span> <span class="attr">:style</span>=<span class="string">"&#123;width: column.indexOf('B') &gt; 0 ? '7%' : ''&#125;"</span>&gt;</span></span><br><span class="line">                        <span class="comment">&lt;!-- 前后增加空格 --&gt;</span></span><br><span class="line">                        &#123;&#123; '&amp;nbsp;' + row[column] + '&amp;nbsp;'&#125;&#125;</span><br><span class="line">                    <span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">td</span>&gt;</span><span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">td</span>&gt;</span><span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">td</span>&gt;</span><span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">td</span>&gt;</span>XXX<span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;/<span class="name">tr</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;/<span class="name">tbody</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">table</span>&gt;</span></span><br><span class="line">            <span class="comment">&lt;!-- 判断是否需要分页，只有二次渲染才可（第一次需要渲染出表格，并基于表格计算高度，从而进行第二次渲染） --&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">div</span> <span class="attr">v-if</span>=<span class="string">"group.pageBreak"</span> <span class="attr">style</span>=<span class="string">"page-break-after: always"</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="undefined"></span></span><br><span class="line"><span class="javascript"><span class="keyword">import</span> <span class="string">'./print.less'</span></span></span><br><span class="line"><span class="undefined"></span></span><br><span class="line"><span class="javascript"><span class="keyword">export</span> <span class="keyword">default</span> &#123;</span></span><br><span class="line"><span class="javascript">  name: <span class="string">'ReportPrint'</span>,</span></span><br><span class="line"><span class="undefined">  data () &#123;</span></span><br><span class="line"><span class="javascript">    <span class="keyword">return</span> &#123;</span></span><br><span class="line"><span class="undefined">      dataList: [],</span></span><br><span class="line"><span class="undefined">      groupList: [],</span></span><br><span class="line"><span class="javascript">      groupField: [<span class="string">'A'</span>, <span class="string">'B'</span>, <span class="string">'C'</span>, <span class="string">'D'</span>, <span class="string">'E'</span>, <span class="string">'F'</span>, <span class="string">'G'</span>],</span></span><br><span class="line"><span class="undefined">      heightSum: 100,</span></span><br><span class="line"><span class="javascript">      checkedHeight: <span class="literal">false</span></span></span><br><span class="line"><span class="undefined">    &#125;</span></span><br><span class="line"><span class="undefined">  &#125;,</span></span><br><span class="line"><span class="undefined">  watch: &#123;</span></span><br><span class="line"><span class="undefined">    dataList (n) &#123;</span></span><br><span class="line"><span class="javascript">      <span class="keyword">this</span>.initGroup(n)</span></span><br><span class="line"><span class="undefined">    &#125;,</span></span><br><span class="line"><span class="undefined">    groupList (n) &#123;</span></span><br><span class="line"><span class="javascript">      <span class="keyword">this</span>.checkBreak()</span></span><br><span class="line"><span class="undefined">    &#125;</span></span><br><span class="line"><span class="undefined">  &#125;,</span></span><br><span class="line"><span class="undefined">  created () &#123;</span></span><br><span class="line"><span class="javascript">    <span class="keyword">this</span>.initGroup(<span class="keyword">this</span>.dataList)</span></span><br><span class="line"><span class="javascript">    <span class="keyword">this</span>.checkBreak()</span></span><br><span class="line"><span class="undefined">  &#125;,</span></span><br><span class="line"><span class="undefined">  methods: &#123;</span></span><br><span class="line"><span class="undefined">    initGroup (data) &#123;</span></span><br><span class="line"><span class="javascript">      <span class="comment">// ... 大致结构</span></span></span><br><span class="line"><span class="javascript">      <span class="keyword">this</span>.groupList = [&#123;</span></span><br><span class="line"><span class="javascript">        pageBreak: <span class="literal">false</span>,</span></span><br><span class="line"><span class="undefined">        list: []</span></span><br><span class="line"><span class="undefined">      &#125;, ...]</span></span><br><span class="line"><span class="undefined">    &#125;,</span></span><br><span class="line"><span class="undefined">    checkBreak () &#123;</span></span><br><span class="line"><span class="javascript">      <span class="comment">// 每一页可以打印 760px * 1075px</span></span></span><br><span class="line"><span class="javascript">      <span class="keyword">this</span>.$nextTick(<span class="function"><span class="params">()</span> =&gt;</span> &#123;</span></span><br><span class="line"><span class="javascript">        <span class="keyword">if</span> (<span class="keyword">this</span>.checkedHeight || <span class="keyword">this</span>.groupList.length === <span class="number">0</span>) &#123;</span></span><br><span class="line"><span class="javascript">          <span class="keyword">return</span></span></span><br><span class="line"><span class="undefined">        &#125;</span></span><br><span class="line"><span class="javascript">        <span class="keyword">let</span> pre = <span class="literal">null</span> <span class="comment">// 循环的上一个table</span></span></span><br><span class="line"><span class="javascript">        <span class="keyword">for</span> (<span class="keyword">let</span> index = <span class="number">0</span>; index &lt; <span class="keyword">this</span>.groupList.length; index++) &#123;</span></span><br><span class="line"><span class="javascript">          <span class="keyword">const</span> table = <span class="keyword">this</span>.$refs[<span class="string">`table<span class="subst">$&#123;index&#125;</span>`</span>]</span></span><br><span class="line"><span class="javascript">          <span class="keyword">const</span> curHeight = table[<span class="number">0</span>].clientHeight + <span class="number">25</span> <span class="comment">// 25为padding</span></span></span><br><span class="line"><span class="javascript">          <span class="keyword">this</span>.heightSum += curHeight</span></span><br><span class="line"><span class="javascript">          <span class="keyword">if</span> (<span class="keyword">this</span>.heightSum &gt; <span class="number">1075</span>) &#123;</span></span><br><span class="line"><span class="javascript">            <span class="comment">// 加上次table则会超出长度，从而设置上一个table需要分页，并设置下一次循环高度为当前table高度</span></span></span><br><span class="line"><span class="javascript">            pre.pageBreak = <span class="literal">true</span></span></span><br><span class="line"><span class="javascript">            <span class="keyword">this</span>.heightSum = curHeight</span></span><br><span class="line"><span class="undefined">          &#125;</span></span><br><span class="line"><span class="javascript">          pre = <span class="keyword">this</span>.groupList[index]</span></span><br><span class="line"><span class="undefined">        &#125;</span></span><br><span class="line"><span class="javascript">        <span class="comment">// 重新渲染出分页div</span></span></span><br><span class="line"><span class="javascript">        <span class="keyword">this</span>.groupList = <span class="built_in">JSON</span>.parse(<span class="built_in">JSON</span>.stringify(<span class="keyword">this</span>.groupList))</span></span><br><span class="line"><span class="javascript">        <span class="keyword">this</span>.checkedHeight = <span class="literal">true</span></span></span><br><span class="line"><span class="undefined">      &#125;)</span></span><br><span class="line"><span class="undefined">    &#125;</span></span><br><span class="line"><span class="undefined">  &#125;</span></span><br><span class="line"><span class="undefined">&#125;</span></span><br><span class="line"><span class="undefined"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">style</span>&gt;</span><span class="undefined"></span></span><br><span class="line"><span class="css"><span class="comment">/* print.less */</span></span></span><br><span class="line"><span class="css"><span class="selector-class">.sq-print</span> &#123;</span></span><br><span class="line"><span class="css">  @<span class="keyword">page</span> &#123; <span class="attribute">margin</span>: <span class="number">20pt</span> <span class="number">16pt</span> <span class="number">0</span> <span class="number">16pt</span>; &#125;</span></span><br><span class="line"><span class="css">  <span class="selector-tag">color</span>: <span class="selector-id">#000</span>;</span></span><br><span class="line"><span class="css">  <span class="selector-tag">table</span> &#123; <span class="attribute">width</span>: <span class="number">100%</span>; <span class="attribute">min-height</span>: <span class="number">24px</span>; <span class="attribute">line-height</span>: <span class="number">24px</span>; <span class="attribute">text-align</span>: left; <span class="attribute">border-collapse</span>: collapse; <span class="attribute">margin</span>: <span class="number">0</span> auto; &#125;</span></span><br><span class="line"><span class="css">  <span class="selector-tag">table</span> <span class="selector-tag">thead</span> <span class="selector-tag">tr</span> <span class="selector-tag">th</span>, <span class="selector-tag">table</span> <span class="selector-tag">tbody</span> <span class="selector-tag">tr</span> <span class="selector-tag">td</span> &#123; <span class="attribute">border</span>: <span class="number">1px</span> solid <span class="number">#000</span>; &#125;</span></span><br><span class="line"><span class="css">  <span class="selector-class">.header</span> &#123; <span class="attribute">margin-bottom</span>: <span class="number">5px</span>; <span class="attribute">text-align</span>: center; <span class="attribute">font-size</span>: <span class="number">16px</span>; &#125;</span></span><br><span class="line"><span class="css">  <span class="selector-class">.header</span> <span class="selector-class">.main-title</span> &#123; <span class="attribute">font-weight</span>: <span class="number">700</span>; <span class="attribute">font-size</span>: <span class="number">24px</span>; &#125;</span></span><br><span class="line"><span class="css">  <span class="selector-class">.header</span> <span class="selector-class">.sub-title</span> &#123; <span class="attribute">margin</span>: <span class="number">5px</span> <span class="number">0</span>; &#125;</span></span><br><span class="line"><span class="undefined">&#125;</span></span><br><span class="line"><span class="undefined"></span><span class="tag">&lt;/<span class="name">style</span>&gt;</span></span><br></pre></td></tr></table></figure><h3 id="生成PDF"><a href="#生成PDF" class="headerlink" title="生成PDF"></a>生成PDF</h3><ul><li><a href="https://github.com/MrRio/jsPDF" target="_blank" rel="noopener">jsPDF插件</a>、<a href="https://rawgit.com/MrRio/jsPDF/master/docs/index.html" target="_blank" rel="noopener">doc</a></li><li>jsPDF使用</li></ul><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 建议局部导入，此处仅做参考</span></span><br><span class="line"><span class="keyword">import</span> jspdf <span class="keyword">from</span> <span class="string">'@/libs/jspdf.js'</span></span><br><span class="line">Vue.use(jspdf)</span><br><span class="line"></span><br><span class="line"><span class="keyword">this</span>.toPDF(<span class="string">'domId'</span>, <span class="string">'pdf文件名'</span>)</span><br><span class="line"><span class="keyword">this</span>.toPDFZip(<span class="keyword">this</span>, <span class="string">'domId'</span>, <span class="string">'pdf文件名'</span>)</span><br></pre></td></tr></table></figure><ul><li>自定义<code>jspdf.js</code></li></ul><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 导出页面为PDF格式</span></span><br><span class="line"><span class="keyword">import</span> html2Canvas <span class="keyword">from</span> <span class="string">'html2canvas'</span></span><br><span class="line"><span class="keyword">import</span> jsPDF <span class="keyword">from</span> <span class="string">'jspdf'</span></span><br><span class="line"><span class="keyword">import</span> JSZip <span class="keyword">from</span> <span class="string">'jszip'</span> <span class="comment">// 导出pdf并压缩</span></span><br><span class="line"><span class="keyword">import</span> &#123; saveAs &#125; <span class="keyword">from</span> <span class="string">'file-saver'</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> &#123;</span><br><span class="line">  install (Vue, options) &#123;</span><br><span class="line">    Vue.prototype.getPDF = <span class="function"><span class="keyword">function</span> (<span class="params">doc</span>) </span>&#123;</span><br><span class="line">      <span class="keyword">return</span> <span class="keyword">new</span> <span class="built_in">Promise</span>(<span class="function">(<span class="params">resolve, reject</span>) =&gt;</span> &#123;</span><br><span class="line">        html2Canvas(doc, &#123;</span><br><span class="line">          allowTaint: <span class="literal">true</span></span><br><span class="line">        &#125;).then(<span class="function"><span class="keyword">function</span> (<span class="params">canvas</span>) </span>&#123;</span><br><span class="line">          <span class="keyword">let</span> contentWidth = canvas.width</span><br><span class="line">          <span class="keyword">let</span> contentHeight = canvas.height</span><br><span class="line">          <span class="keyword">let</span> pageHeight = contentWidth / <span class="number">592.28</span> * <span class="number">841.89</span></span><br><span class="line">          <span class="keyword">let</span> leftHeight = contentHeight</span><br><span class="line">          <span class="keyword">let</span> position = <span class="number">0</span></span><br><span class="line">          <span class="keyword">let</span> imgWidth = <span class="number">595.28</span></span><br><span class="line">          <span class="keyword">let</span> imgHeight = <span class="number">592.28</span> / contentWidth * contentHeight</span><br><span class="line">          <span class="keyword">let</span> pageData = canvas.toDataURL(<span class="string">'image/jpeg'</span>, <span class="number">1.0</span>)</span><br><span class="line">          <span class="keyword">let</span> PDF = <span class="keyword">new</span> jsPDF(<span class="string">''</span>, <span class="string">'pt'</span>, <span class="string">'a4'</span>)</span><br><span class="line">          <span class="keyword">if</span> (leftHeight &lt; pageHeight) &#123;</span><br><span class="line">            PDF.addImage(pageData, <span class="string">'JPEG'</span>, <span class="number">0</span>, <span class="number">0</span>, imgWidth, imgHeight)</span><br><span class="line">          &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="keyword">while</span> (leftHeight &gt; <span class="number">0</span>) &#123;</span><br><span class="line">              PDF.addImage(pageData, <span class="string">'JPEG'</span>, <span class="number">0</span>, position, imgWidth, imgHeight)</span><br><span class="line">              leftHeight -= pageHeight</span><br><span class="line">              position -= <span class="number">841.89</span></span><br><span class="line">              <span class="keyword">if</span> (leftHeight &gt; <span class="number">0</span>) &#123;</span><br><span class="line">                PDF.addPage()</span><br><span class="line">              &#125;</span><br><span class="line">            &#125;</span><br><span class="line">          &#125;</span><br><span class="line">          resolve(&#123;<span class="attr">pdf</span>: PDF&#125;)</span><br><span class="line">        &#125;)</span><br><span class="line">      &#125;)</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    Vue.prototype.toPDF = <span class="function"><span class="keyword">function</span> (<span class="params">elementId, pdfTitle</span>) </span>&#123;</span><br><span class="line">      <span class="keyword">var</span> title = pdfTitle</span><br><span class="line">      <span class="keyword">this</span>.getPDF(<span class="built_in">document</span>.querySelector(<span class="string">'#'</span> + elementId)).then(<span class="function"><span class="params">data</span> =&gt;</span> &#123;</span><br><span class="line">        data.pdf.save(title + <span class="string">'.pdf'</span>)</span><br><span class="line">      &#125;)</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    Vue.prototype.toPDFZip = <span class="keyword">async</span> (that, elementId, title) =&gt; &#123;</span><br><span class="line">      <span class="keyword">var</span> zip = <span class="keyword">new</span> JSZip();</span><br><span class="line">      <span class="keyword">const</span> box = <span class="built_in">document</span>.querySelector(<span class="string">'#'</span> + elementId)</span><br><span class="line">      <span class="keyword">const</span> items = box.querySelectorAll(<span class="string">".item-box"</span>)</span><br><span class="line">      <span class="keyword">const</span> func = <span class="function">(<span class="params">that, item, index</span>) =&gt;</span> <span class="keyword">new</span> <span class="built_in">Promise</span>(<span class="function">(<span class="params">resolve, reject</span>) =&gt;</span> &#123;</span><br><span class="line">        that.getPDF(item).then(<span class="function"><span class="params">data</span> =&gt;</span> &#123;</span><br><span class="line">          <span class="keyword">const</span> dataId = item.attributes[<span class="string">"data-id"</span>].nodeValue || index;</span><br><span class="line">          <span class="keyword">try</span> &#123;</span><br><span class="line">            zip.file(dataId + <span class="string">'.pdf'</span>, data.pdf.output(<span class="string">'blob'</span>));</span><br><span class="line">            resolve()</span><br><span class="line">          &#125; <span class="keyword">catch</span> &#123;</span><br><span class="line">            reject(<span class="string">'Something went wrong!'</span>)</span><br><span class="line">          &#125;</span><br><span class="line">        &#125;)</span><br><span class="line">      &#125;)</span><br><span class="line"></span><br><span class="line">      <span class="keyword">let</span> arr = []</span><br><span class="line">      items.forEach(<span class="function">(<span class="params">item, index</span>) =&gt;</span> &#123;</span><br><span class="line">        arr.push(func(that, item, index))</span><br><span class="line">      &#125;)</span><br><span class="line">      <span class="keyword">await</span> <span class="built_in">Promise</span>.all(arr);</span><br><span class="line"></span><br><span class="line">      zip.generateAsync(&#123;<span class="attr">type</span>:<span class="string">'blob'</span>&#125;).then(<span class="function"><span class="keyword">function</span>(<span class="params">content</span>) </span>&#123;</span><br><span class="line">        saveAs(content, title + <span class="string">'.zip'</span>);</span><br><span class="line">      &#125;);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="生成ZIP文件"><a href="#生成ZIP文件" class="headerlink" title="生成ZIP文件"></a>生成ZIP文件</h3><ul><li>安装</li></ul><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">npm install jszip -S</span><br><span class="line">npm install file-saver -S</span><br></pre></td></tr></table></figure><ul><li>使用参考<a href="#生成PDF">生成PDF</a></li></ul><h3 id="网页保存为图片"><a href="#网页保存为图片" class="headerlink" title="网页保存为图片"></a>网页保存为图片</h3><ul><li><a href="https://github.com/niklasvh/html2canvas" target="_blank" rel="noopener">html2canvas</a>、使用参考：<a href="https://segmentfault.com/a/1190000011478657" target="_blank" rel="noopener">https://segmentfault.com/a/1190000011478657</a></li><li>html2canvas操作隐藏元素<ul><li><code>&lt;div style=&quot;position: absolute; opacity: 0.0;&quot;&gt;</code></li><li>Failed to execute ‘createPattern’ on ‘CanvasRenderingContext2D’: The image argument is a canvas element with a width or height of 0.</li><li>参考 <a href="https://stackoverflow.com/questions/20605269/screenshot-of-hidden-div-using-html2canvas" target="_blank" rel="noopener">https://stackoverflow.com/questions/20605269/screenshot-of-hidden-div-using-html2canvas</a></li></ul></li></ul><h2 id="格式规范化"><a href="#格式规范化" class="headerlink" title="格式规范化"></a>格式规范化</h2><h3 id="eslint格式化"><a href="#eslint格式化" class="headerlink" title="eslint格式化"></a>eslint格式化</h3><ul><li>vscode等编辑安装eslint插件，相关配置参考<a href="/_posts/extend/vscode.md#插件推荐">vscode.md#插件推荐</a></li><li>直接安装</li><li><p>基于vue-cli安装，参考：<a href="https://eslint.vuejs.org/" target="_blank" rel="noopener">https://eslint.vuejs.org/</a></p><ul><li><code>vue add eslint</code> 基于vue安装插件，选择Standard、Lint on save</li><li>安装完成默认会自动执行<code>vue-cli-service lint</code>，即对所有文件进行格式修复(只会修复部分，剩下的仍然需要人工修复)</li><li><p>安装后会在package.json中增加如下配置，安装对应的包到项目目录，并增加文件<code>.eslintrc.js</code>和<code>.editorconfig</code></p><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">"scripts": &#123;                                            </span><br><span class="line">    "lint": "vue-cli-service lint",</span><br><span class="line">&#125;,</span><br><span class="line">"devDependencies": &#123;</span><br><span class="line">    "@vue/cli-plugin-eslint": "~4.5.0",</span><br><span class="line">    "@vue/eslint-config-standard": "^5.1.2",</span><br><span class="line">    "eslint": "^6.7.2",</span><br><span class="line">    "eslint-plugin-import": "^2.20.2",</span><br><span class="line">    "eslint-plugin-node": "^11.1.0",</span><br><span class="line">    "eslint-plugin-promise": "^4.2.1",</span><br><span class="line">    "eslint-plugin-standard": "^4.0.0",</span><br><span class="line">    "eslint-plugin-vue": "^6.2.2"</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li></ul></li><li><p>支持多种配置文件格式：.eslintrc.js、.eslintrc.yaml、.eslintrc.json、.eslintrc(弃用)、在package.json增加eslintConfig属性。且采用就近原则</p></li><li><code>.eslintrc.js</code> 放在vue项目根目录，详细参考：<a href="https://cn.eslint.org/" target="_blank" rel="noopener">https://cn.eslint.org/</a> [^10]</li></ul><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">module</span>.exports = &#123;</span><br><span class="line">  root: <span class="literal">true</span>,</span><br><span class="line">  <span class="string">'extends'</span>: [</span><br><span class="line">    <span class="string">'plugin:vue/essential'</span>,</span><br><span class="line">    <span class="string">'@vue/standard'</span></span><br><span class="line">  ],</span><br><span class="line">  rules: &#123;</span><br><span class="line">    <span class="comment">// allow async-await</span></span><br><span class="line">    <span class="string">'generator-star-spacing'</span>: <span class="string">'off'</span>,</span><br><span class="line">    <span class="comment">// allow debugger during development</span></span><br><span class="line">    <span class="string">'no-debugger'</span>: process.env.NODE_ENV === <span class="string">'production'</span> ? <span class="string">'error'</span> : <span class="string">'off'</span>,</span><br><span class="line">    <span class="string">'vue/no-parsing-error'</span>: [<span class="number">2</span>, &#123;</span><br><span class="line">      <span class="string">'x-invalid-end-tag'</span>: <span class="literal">false</span></span><br><span class="line">    &#125;],</span><br><span class="line">    <span class="string">'no-undef'</span>: <span class="string">'off'</span>,</span><br><span class="line">    <span class="string">'camelcase'</span>: <span class="string">'off'</span>,</span><br><span class="line">    <span class="comment">// function函数名和()见增加空格</span></span><br><span class="line">    <span class="string">"space-before-function-paren"</span>: [<span class="string">"error"</span>, &#123;</span><br><span class="line">        <span class="string">"anonymous"</span>: <span class="string">"always"</span>,</span><br><span class="line">        <span class="string">"named"</span>: <span class="string">"always"</span>,</span><br><span class="line">        <span class="string">"asyncArrow"</span>: <span class="string">"always"</span></span><br><span class="line">    &#125;],</span><br><span class="line">    <span class="comment">// 不强制使用 ===</span></span><br><span class="line">    <span class="string">"eqeqeq"</span>: [<span class="string">"error"</span>, <span class="string">"smart"</span>],</span><br><span class="line">    <span class="comment">// A &amp;&amp; B换行时，符号在行头。https://eslint.org/docs/rules/operator-linebreak</span></span><br><span class="line">    <span class="string">"operator-linebreak"</span>: [<span class="string">"error"</span>, <span class="string">"before"</span>],</span><br><span class="line">  &#125;,</span><br><span class="line">  parserOptions: &#123;</span><br><span class="line">    parser: <span class="string">'babel-eslint'</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li><code>.eslintignore</code> 放在vue项目根目录</li></ul><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 不进行校验的的文件或文件夹</span></span><br><span class="line">src/components</span><br></pre></td></tr></table></figure><ul><li>代码中不进行校验</li></ul><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/* eslint-disable */</span></span><br><span class="line"><span class="comment">// ESLint 在校验的时候就会跳过后面的代码</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/* eslint-disable no-new */</span></span><br><span class="line"><span class="comment">// ESLint 在校验的时候就会跳过 no-new 规则校验</span></span><br></pre></td></tr></table></figure><h3 id="editorconfig-prettierrc-jsbeautifyrc格式化"><a href="#editorconfig-prettierrc-jsbeautifyrc格式化" class="headerlink" title=".editorconfig/.prettierrc/.jsbeautifyrc格式化"></a>.editorconfig/.prettierrc/.jsbeautifyrc格式化</h3><ul><li><strong><code>.editorconfig</code>文件需要配合插件使用，如vscode的<code>Editorconfig</code>插件</strong><ul><li>该插件的作用是告诉开发工具自动去读取项目根目录下的 .editorconfig 配置文件，如果没有安装这个插件，光有一个配置文件是无法生效的</li><li><strong>此插件配置的格式优先于vscode配置的，如缩进</strong></li></ul></li><li><code>.prettierrc</code> 文件需要配合插件使用，如vscode的<code>Prettier</code>插件。参考：<a href="https://prettier.io/" target="_blank" rel="noopener">https://prettier.io/</a></li><li><code>.jsbeautifyrc</code> 文件需要配合插件使用，如vscode的<code>Beautify</code>插件</li><li>Eslint、.editorconfig等区别<ul><li>Eslint 更偏向于对语法的提示，如定义了一个变量但是没有使用时应该给予提醒</li><li>.editorconfig 更偏向于简单代码风格，如缩进等<ul><li>.prettierrc 更偏向于代码美化</li></ul></li><li>二者并不冲突，同时配合使用可以使代码风格更加优雅</li></ul></li><li><code>.editorconfig</code> 放在vue项目根目录</li></ul><figure class="highlight ini"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># http://editorconfig.org</span></span><br><span class="line"><span class="attr">root</span> = <span class="literal">true</span></span><br><span class="line"></span><br><span class="line"><span class="section">[*]</span></span><br><span class="line"><span class="comment">#缩进风格：空格</span></span><br><span class="line"><span class="attr">indent_style</span> = space</span><br><span class="line"><span class="comment">#缩进大小2</span></span><br><span class="line"><span class="attr">indent_size</span> = <span class="number">2</span></span><br><span class="line"><span class="comment">#换行符lf</span></span><br><span class="line"><span class="attr">end_of_line</span> = lf</span><br><span class="line"><span class="comment">#字符集utf-8</span></span><br><span class="line"><span class="attr">charset</span> = utf-<span class="number">8</span></span><br><span class="line"><span class="comment">#是否删除行尾的空格</span></span><br><span class="line"><span class="attr">trim_trailing_whitespace</span> = <span class="literal">true</span></span><br><span class="line"><span class="comment">#是否在文件的最后插入一个空行</span></span><br><span class="line"><span class="attr">insert_final_newline</span> = <span class="literal">true</span></span><br><span class="line"></span><br><span class="line"><span class="section">[*.md]</span></span><br><span class="line"><span class="attr">trim_trailing_whitespace</span> = <span class="literal">false</span></span><br><span class="line"></span><br><span class="line"><span class="section">[Makefile]</span></span><br><span class="line"><span class="attr">indent_style</span> = tab</span><br></pre></td></tr></table></figure><ul><li>.prettierrc 常用配置</li></ul><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  <span class="comment">/* 使用单引号包含字符串 */</span></span><br><span class="line">  <span class="string">"singleQuote"</span>: <span class="literal">true</span>,</span><br><span class="line">  <span class="comment">/* 不添加行尾分号 */</span></span><br><span class="line">  <span class="string">"semi"</span>: <span class="literal">false</span>,</span><br><span class="line">  <span class="comment">/* 在对象属性添加空格 */</span></span><br><span class="line">  <span class="string">"bracketSpacing"</span>: <span class="literal">true</span>,</span><br><span class="line">  <span class="comment">/* 优化html闭合标签不换行的问题 */</span></span><br><span class="line">  <span class="string">"htmlWhitespaceSensitivity"</span>: <span class="string">"ignore"</span>,</span><br><span class="line">  <span class="comment">/* 每行最大长度默认80(适配1366屏幕，1920可设置成140) */</span></span><br><span class="line">  <span class="string">"printWidth"</span>: <span class="number">140</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="其他"><a href="#其他" class="headerlink" title="其他"></a>其他</h2><h3 id="mockjs模拟数据"><a href="#mockjs模拟数据" class="headerlink" title="mockjs模拟数据"></a>mockjs模拟数据</h3><ul><li>语法<code>Mock.mock(rurl, rtype, function(options))</code><ul><li>rurl：拦截的请求地址，支持正则。不使用正则是为完全不配，如<code>/user/getMenu</code>无法匹配<code>http://localhost/user/getMenu</code>，也无法匹配参数<code>/user/getMenu?type=0</code></li><li>rtype：请求类型，get/post等</li><li>回调函数，需要返回最终结果(相当于模拟后台请求返回)。options(url: 包括请求传参数、type: GET/POST等、body: body体参数)</li></ul></li><li>示例</li></ul><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> Mock <span class="keyword">from</span> <span class="string">'mockjs'</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 定义模拟数据</span></span><br><span class="line"><span class="keyword">const</span> menu = [</span><br><span class="line">    [&#123;</span><br><span class="line">        label: <span class="string">"首页"</span>,</span><br><span class="line">        path: <span class="string">"/index"</span>,</span><br><span class="line">        icon: <span class="string">'el-icon-document'</span>,</span><br><span class="line">        meta: &#123;</span><br><span class="line">            i18n: <span class="string">'dashboard'</span>,</span><br><span class="line">        &#125;,</span><br><span class="line">        parentId: <span class="number">0</span></span><br><span class="line">    &#125;]</span><br><span class="line">]</span><br><span class="line"></span><br><span class="line"><span class="comment">// 定义模拟拦截</span></span><br><span class="line">Mock.mock(<span class="built_in">RegExp</span>(process.env.VUE_APP_BASE_URL + <span class="string">'/user/getMenu.*'</span>), <span class="string">'get'</span>, (options) =&gt; &#123;</span><br><span class="line">    <span class="keyword">const</span> type = getUrlParam(<span class="string">'type'</span>, options.url)</span><br><span class="line">    <span class="keyword">return</span> &#123;</span><br><span class="line">        data: menu[type] || []</span><br><span class="line">    &#125;</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> getUrlParam = <span class="function">(<span class="params">paramName, params</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">var</span> reg = <span class="keyword">new</span> <span class="built_in">RegExp</span>(<span class="string">'(^|&amp;)'</span> + paramName + <span class="string">'=([^&amp;]*)(&amp;|$)'</span>)</span><br><span class="line">  <span class="keyword">if</span>(!params) &#123;</span><br><span class="line">    params = <span class="built_in">window</span>.location.search.substr(<span class="number">1</span>)</span><br><span class="line">  &#125; <span class="keyword">else</span> <span class="keyword">if</span>(params.indexOf(<span class="string">'http://'</span>) === <span class="number">0</span> || params.indexOf(<span class="string">'https://'</span>) === <span class="number">0</span>) &#123;</span><br><span class="line">    params = params.indexOf(<span class="string">'?'</span>) &lt; <span class="number">0</span> ? <span class="string">''</span> : params.split(<span class="string">'?'</span>)[<span class="number">1</span>]</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">var</span> r = params.match(reg)</span><br><span class="line">  <span class="keyword">if</span> (r != <span class="literal">null</span>) <span class="keyword">return</span> <span class="built_in">unescape</span>(r[<span class="number">2</span>])</span><br><span class="line">  <span class="keyword">return</span> <span class="literal">null</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="docz项目文档生成"><a href="#docz项目文档生成" class="headerlink" title="docz项目文档生成"></a>docz项目文档生成</h3><ul><li><a href="https://github.com/doczjs/docz/" target="_blank" rel="noopener">https://github.com/doczjs/docz/</a></li></ul><h3 id="codemirror代码编辑"><a href="#codemirror代码编辑" class="headerlink" title="codemirror代码编辑"></a>codemirror代码编辑</h3><ul><li><a href="https://codemirror.net/" target="_blank" rel="noopener">codemirror</a></li><li>vue使用，安装<code>npm install vue-codemirror --save</code></li></ul><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">codemirror</span></span></span><br><span class="line"><span class="tag"><span class="attr">ref</span>=<span class="string">"cm"</span></span></span><br><span class="line"><span class="tag"><span class="attr">v-model</span>=<span class="string">"dataForm.code"</span></span></span><br><span class="line"><span class="tag"><span class="attr">:options</span>=<span class="string">"cmOptions"</span></span></span><br><span class="line"><span class="tag">&gt;</span><span class="tag">&lt;/<span class="name">codemirror</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="undefined"></span></span><br><span class="line"><span class="javascript"><span class="comment">// 单组件引用</span></span></span><br><span class="line"><span class="javascript"><span class="keyword">import</span> &#123; codemirror &#125; <span class="keyword">from</span> <span class="string">'vue-codemirror'</span></span></span><br><span class="line"><span class="javascript"><span class="keyword">import</span> <span class="string">'codemirror/lib/codemirror.css'</span></span></span><br><span class="line"><span class="javascript"><span class="comment">// require('codemirror/mode/javascript/javascript') // mode: 'text/javascript'</span></span></span><br><span class="line"><span class="javascript"><span class="comment">// require('codemirror/mode/sql/sql') // mode: 'sql'</span></span></span><br><span class="line"><span class="undefined"></span></span><br><span class="line"><span class="javascript"><span class="keyword">export</span> <span class="keyword">default</span> &#123;</span></span><br><span class="line"><span class="undefined">    data () &#123;</span></span><br><span class="line"><span class="javascript">        <span class="keyword">return</span> &#123;</span></span><br><span class="line"><span class="undefined">            cmOptions: &#123;</span></span><br><span class="line"><span class="javascript">                <span class="comment">// text方式进行代码高亮，如果是其他语言可能需要引入对应的样式</span></span></span><br><span class="line"><span class="javascript">                mode: <span class="string">'text'</span>,</span></span><br><span class="line"><span class="javascript">                <span class="comment">// 显示行号</span></span></span><br><span class="line"><span class="javascript">                lineNumbers: <span class="literal">true</span>,</span></span><br><span class="line"><span class="javascript">                <span class="comment">// 一行超长时自动换行</span></span></span><br><span class="line"><span class="javascript">                lineWrapping: <span class="literal">true</span>,</span></span><br><span class="line"><span class="undefined">                tabSize: 2</span></span><br><span class="line"><span class="undefined">            &#125;</span></span><br><span class="line"><span class="undefined">        &#125;</span></span><br><span class="line"><span class="undefined">    &#125;</span></span><br><span class="line"><span class="undefined">&#125;</span></span><br><span class="line"><span class="undefined"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure><hr><p>参考文章</p></div><div></div><div></div><div><ul class="post-copyright"><li class="post-copyright-author"> <strong>本文作者：</strong> smalle</li><li class="post-copyright-link"> <strong>本文链接：</strong> <a href="http://blog.aezo.cn/2020/10/09/web/js-tools/" title="JS Tools">http://blog.aezo.cn/2020/10/09/web/js-tools/</a></li><li class="post-copyright-license"> <strong>版权声明：</strong> 本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/3.0/" rel="external nofollow" target="_blank">CC BY-NC-SA 3.0</a> 许可协议。转载请注明出处！</li></ul></div><footer class="post-footer"><div class="post-tags"> <a href="/tags/tools/" rel="tag"># tools</a> <a href="/tags/js/" rel="tag"># js</a></div><div class="post-nav"><div class="post-nav-next post-nav-item"><a href="/2020/09/11/web/electron/" rel="next" title="Electron —— 基于前端构建跨平台桌面应用程序"><i class="fa fa-chevron-left"></i> Electron —— 基于前端构建跨平台桌面应用程序</a></div><span class="post-nav-divider"></span><div class="post-nav-prev post-nav-item"> <a href="/2020/10/09/java/java-tools/" rel="prev" title="Java Tools">Java Tools<i class="fa fa-chevron-right"></i></a></div></div></footer></article><div class="post-spread"></div></div></div><div class="comments" id="comments"></div></div><div class="sidebar-toggle"><div class="sidebar-toggle-line-wrap"><span class="sidebar-toggle-line sidebar-toggle-line-first"></span><span class="sidebar-toggle-line sidebar-toggle-line-middle"></span><span class="sidebar-toggle-line sidebar-toggle-line-last"></span></div></div><aside id="sidebar" class="sidebar"><div class="sidebar-inner"><ul class="sidebar-nav motion-element"><li class="sidebar-nav-toc sidebar-nav-active" data-target="post-toc-wrap"> 文章目录</li><li class="sidebar-nav-overview" data-target="site-overview"> 站点概览</li></ul><section class="site-overview sidebar-panel"><div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person"> <img class="site-author-image" itemprop="image" src="https://avatars0.githubusercontent.com/u/15698218?v=3&u=ce740bf0b67ff0d74990ba6fc644d6e92f572dcb&s=400" alt="smalle"><p class="site-author-name" itemprop="name">smalle</p><p class="site-description motion-element" itemprop="description"></p></div><nav class="site-state motion-element"><div class="site-state-item site-state-posts"> <a href="/archives/"><span class="site-state-item-count">155</span> <span class="site-state-item-name">日志</span></a></div><div class="site-state-item site-state-categories"> <a href="/categories/index.html"><span class="site-state-item-count">13</span> <span class="site-state-item-name">分类</span></a></div><div class="site-state-item site-state-tags"> <a href="/tags/index.html"><span class="site-state-item-count">140</span> <span class="site-state-item-name">标签</span></a></div></nav><div class="feed-link motion-element"><a href="/atom.xml" rel="alternate"><i class="fa fa-rss"></i> RSS</a></div><div class="links-of-author motion-element"></div></section><section class="post-toc-wrap motion-element sidebar-panel sidebar-panel-active"><div class="post-toc"><div class="post-toc-content"><ol class="nav"><li class="nav-item nav-level-2"><a class="nav-link" href="#开发库"><span class="nav-number">1.</span> <span class="nav-text">开发库</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#babel"><span class="nav-number">1.1.</span> <span class="nav-text">babel</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#npm-run-all"><span class="nav-number">1.2.</span> <span class="nav-text">npm-run-all</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#rollup-js"><span class="nav-number">1.3.</span> <span class="nav-text">rollup.js</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#基础库"><span class="nav-number">2.</span> <span class="nav-text">基础库</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#lodash工具类"><span class="nav-number">2.1.</span> <span class="nav-text">lodash工具类</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#cross-env启动时增加环境变量"><span class="nav-number">2.2.</span> <span class="nav-text">cross-env启动时增加环境变量</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#dayjs时间操作"><span class="nav-number">2.3.</span> <span class="nav-text">dayjs时间操作</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#mathjs数学计算"><span class="nav-number">2.4.</span> <span class="nav-text">mathjs数学计算</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#省市区级联"><span class="nav-number">2.5.</span> <span class="nav-text">省市区级联</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#AJAX"><span class="nav-number">3.</span> <span class="nav-text">AJAX</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#axios"><span class="nav-number">3.1.</span> <span class="nav-text">axios</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#axios参数后端接受不到-2"><span class="nav-number">3.1.1.</span> <span class="nav-text">axios参数后端接受不到 ^2</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#qs插件使用"><span class="nav-number">3.2.</span> <span class="nav-text">qs插件使用</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Vue相关UI库"><span class="nav-number">4.</span> <span class="nav-text">Vue相关UI库</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#Element-UI"><span class="nav-number">4.1.</span> <span class="nav-text">Element-UI</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#iview"><span class="nav-number">4.2.</span> <span class="nav-text">iview</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Avue"><span class="nav-number">4.3.</span> <span class="nav-text">Avue</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#表格组件常用参数-option"><span class="nav-number">4.3.1.</span> <span class="nav-text">表格组件常用参数(option)</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#原理介绍"><span class="nav-number">4.3.2.</span> <span class="nav-text">原理介绍</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#ag-grid超强表格"><span class="nav-number">4.4.</span> <span class="nav-text">ag-grid超强表格</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#vxe-table"><span class="nav-number">4.5.</span> <span class="nav-text">vxe-table</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#MyUI"><span class="nav-number">4.6.</span> <span class="nav-text">MyUI</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Quasar"><span class="nav-number">4.7.</span> <span class="nav-text">Quasar</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#底层硬件库"><span class="nav-number">5.</span> <span class="nav-text">底层硬件库</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#Clipboard-复制内容到剪贴板"><span class="nav-number">5.1.</span> <span class="nav-text">Clipboard 复制内容到剪贴板</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#扫码-条码生成"><span class="nav-number">5.2.</span> <span class="nav-text">扫码/条码生成</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#H5页面扫码"><span class="nav-number">5.2.1.</span> <span class="nav-text">H5页面扫码</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#H5页面扫码案例（基于uni-app）"><span class="nav-number">5.2.2.</span> <span class="nav-text">H5页面扫码案例（基于uni-app）</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#条码生成"><span class="nav-number">5.2.3.</span> <span class="nav-text">条码生成</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#打印"><span class="nav-number">5.3.</span> <span class="nav-text">打印</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#生成PDF"><span class="nav-number">5.4.</span> <span class="nav-text">生成PDF</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#生成ZIP文件"><span class="nav-number">5.5.</span> <span class="nav-text">生成ZIP文件</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#网页保存为图片"><span class="nav-number">5.6.</span> <span class="nav-text">网页保存为图片</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#格式规范化"><span class="nav-number">6.</span> <span class="nav-text">格式规范化</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#eslint格式化"><span class="nav-number">6.1.</span> <span class="nav-text">eslint格式化</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#editorconfig-prettierrc-jsbeautifyrc格式化"><span class="nav-number">6.2.</span> <span class="nav-text">.editorconfig/.prettierrc/.jsbeautifyrc格式化</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#其他"><span class="nav-number">7.</span> <span class="nav-text">其他</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#mockjs模拟数据"><span class="nav-number">7.1.</span> <span class="nav-text">mockjs模拟数据</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#docz项目文档生成"><span class="nav-number">7.2.</span> <span class="nav-text">docz项目文档生成</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#codemirror代码编辑"><span class="nav-number">7.3.</span> <span class="nav-text">codemirror代码编辑</span></a></li></ol></li></ol></div></div></section></div></aside></div></main><footer id="footer" class="footer"><div class="footer-inner"><div class="copyright"> &copy; 2016 - <span itemprop="copyrightYear">2021</span><span class="with-love"><i class="fa fa-heart"></i></span> <span class="author" itemprop="copyrightHolder">smalle</span>&nbsp;&nbsp;&nbsp;&nbsp;<div class="powered-by"> 由 <a class="theme-link" target="_blank" href="https://hexo.io">Hexo</a> 强力驱动</div><div class="powered-by"> 主题 - <a class="theme-link" target="_blank" href="https://github.com/iissnan/hexo-theme-next">NexT.Mist</a></div><div class="theme-info cnzz" style="margin:0 0 -5px 10px"><script type="text/javascript">var cnzz_protocol="https:"==document.location.protocol?"https://":"http://";document.write(unescape("%3Cspan id='cnzz_stat_icon_1276691827'%3E%3C/span%3E%3Cscript src='"+cnzz_protocol+"s23.cnzz.com/z_stat.php%3Fid%3D1276691827%26show%3Dpic1' type='text/javascript'%3E%3C/script%3E"))</script></div></div><div class="ad"> <span style="font-weight:700">AD&nbsp;&nbsp;&nbsp;&nbsp;</span><div class="theme-info"> <a target="_blank" href="https://promotion.aliyun.com/ntms/yunparter/invite.html?userCode=oby5nolb">阿里云大礼包</a></div></div><div class="aezocn"> <span style="font-weight:700">@AEZO.CN&nbsp;&nbsp;&nbsp;&nbsp;</span><div class="theme-info"> <a target="_blank" href="http://shop.aezo.cn/">杂货铺</a></div></div><script type="text/javascript">var _hmt=_hmt||[];!function(){var e=document.createElement("script");e.src="https://hm.baidu.com/hm.js?d82223039d601f2f819f8fe140a63468";var t=document.getElementsByTagName("script")[0];t.parentNode.insertBefore(e,t)}()</script></div></footer><div class="back-to-top"><i class="fa fa-arrow-up"></i></div></div><script type="text/javascript">"[object Function]"!==Object.prototype.toString.call(window.Promise)&&(window.Promise=null)</script><script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script><script type="text/javascript" src="/lib/fastclick/lib/fastclick.min.js?v=1.0.6"></script><script type="text/javascript" src="/lib/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script><script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script><script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script><script type="text/javascript" src="/lib/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script><script type="text/javascript" src="/js/src/utils.js?v=5.1.1"></script><script type="text/javascript" src="/js/src/motion.js?v=5.1.1"></script><script type="text/javascript" src="/js/src/scrollspy.js?v=5.1.1"></script><script type="text/javascript" src="/js/src/post-details.js?v=5.1.1"></script><script type="text/javascript" src="/js/src/bootstrap.js?v=5.1.1"></script><script type="text/javascript">
    // Popup Window;
    var isfetched = false;
    var isXml = true;
    // Search DB path;
    var search_path = "search.xml";
    if (search_path.length === 0) {
      search_path = "search.xml";
    } else if (/json$/i.test(search_path)) {
      isXml = false;
    }
    var path = "/" + search_path;
    // monitor main search box;

    var onPopupClose = function (e) {
      $('.popup').hide();
      $('#local-search-input').val('');
      $('.search-result-list').remove();
      $('#no-result').remove();
      $(".local-search-pop-overlay").remove();
      $('body').css('overflow', '');
    }

    function proceedsearch() {
      $("body")
        .append('<div class="search-popup-overlay local-search-pop-overlay"></div>')
        .css('overflow', 'hidden');
      $('.search-popup-overlay').click(onPopupClose);
      $('.popup').toggle();
      var $localSearchInput = $('#local-search-input');
      $localSearchInput.attr("autocapitalize", "none");
      $localSearchInput.attr("autocorrect", "off");
      $localSearchInput.focus();
    }

    // search function;
    var searchFunc = function(path, search_id, content_id) {
      'use strict';

      // start loading animation
      $("body")
        .append('<div class="search-popup-overlay local-search-pop-overlay">' +
          '<div id="search-loading-icon">' +
          '<i class="fa fa-spinner fa-pulse fa-5x fa-fw"></i>' +
          '</div>' +
          '</div>')
        .css('overflow', 'hidden');
      $("#search-loading-icon").css('margin', '20% auto 0 auto').css('text-align', 'center');

      $.ajax({
        url: path,
        dataType: isXml ? "xml" : "json",
        async: true,
        success: function(res) {
          // get the contents from search data
          isfetched = true;
          $('.popup').detach().appendTo('.header-inner');
          var datas = isXml ? $("entry", res).map(function() {
            return {
              title: $("title", this).text(),
              content: $("content",this).text(),
              url: $("url" , this).text()
            };
          }).get() : res;
          var input = document.getElementById(search_id);
          var resultContent = document.getElementById(content_id);
          var inputEventFunction = function() {
            var searchText = input.value.trim().toLowerCase();
            var keywords = searchText.split(/[\s\-]+/);
            if (keywords.length > 1) {
              keywords.push(searchText);
            }
            var resultItems = [];
            if (searchText.length > 0) {
              // perform local searching
              datas.forEach(function(data) {
                var isMatch = false;
                var hitCount = 0;
                var searchTextCount = 0;
                var title = data.title.trim();
                var titleInLowerCase = title.toLowerCase();
                var content = data.content.trim().replace(/<[^>]+>/g,"");
                var contentInLowerCase = content.toLowerCase();
                var articleUrl = decodeURIComponent(data.url);
                var indexOfTitle = [];
                var indexOfContent = [];
                // only match articles with not empty titles
                if(title != '') {
                  keywords.forEach(function(keyword) {
                    function getIndexByWord(word, text, caseSensitive) {
                      var wordLen = word.length;
                      if (wordLen === 0) {
                        return [];
                      }
                      var startPosition = 0, position = [], index = [];
                      if (!caseSensitive) {
                        text = text.toLowerCase();
                        word = word.toLowerCase();
                      }
                      while ((position = text.indexOf(word, startPosition)) > -1) {
                        index.push({position: position, word: word});
                        startPosition = position + wordLen;
                      }
                      return index;
                    }

                    indexOfTitle = indexOfTitle.concat(getIndexByWord(keyword, titleInLowerCase, false));
                    indexOfContent = indexOfContent.concat(getIndexByWord(keyword, contentInLowerCase, false));
                  });
                  if (indexOfTitle.length > 0 || indexOfContent.length > 0) {
                    isMatch = true;
                    hitCount = indexOfTitle.length + indexOfContent.length;
                  }
                }

                // show search results

                if (isMatch) {
                  // sort index by position of keyword

                  [indexOfTitle, indexOfContent].forEach(function (index) {
                    index.sort(function (itemLeft, itemRight) {
                      if (itemRight.position !== itemLeft.position) {
                        return itemRight.position - itemLeft.position;
                      } else {
                        return itemLeft.word.length - itemRight.word.length;
                      }
                    });
                  });

                  // merge hits into slices

                  function mergeIntoSlice(text, start, end, index) {
                    var item = index[index.length - 1];
                    var position = item.position;
                    var word = item.word;
                    var hits = [];
                    var searchTextCountInSlice = 0;
                    while (position + word.length <= end && index.length != 0) {
                      if (word === searchText) {
                        searchTextCountInSlice++;
                      }
                      hits.push({position: position, length: word.length});
                      var wordEnd = position + word.length;

                      // move to next position of hit

                      index.pop();
                      while (index.length != 0) {
                        item = index[index.length - 1];
                        position = item.position;
                        word = item.word;
                        if (wordEnd > position) {
                          index.pop();
                        } else {
                          break;
                        }
                      }
                    }
                    searchTextCount += searchTextCountInSlice;
                    return {
                      hits: hits,
                      start: start,
                      end: end,
                      searchTextCount: searchTextCountInSlice
                    };
                  }

                  var slicesOfTitle = [];
                  if (indexOfTitle.length != 0) {
                    slicesOfTitle.push(mergeIntoSlice(title, 0, title.length, indexOfTitle));
                  }

                  var slicesOfContent = [];
                  while (indexOfContent.length != 0) {
                    var item = indexOfContent[indexOfContent.length - 1];
                    var position = item.position;
                    var word = item.word;
                    // cut out 100 characters
                    var start = position - 20;
                    var end = position + 80;
                    if(start < 0){
                      start = 0;
                    }
                    if (end < position + word.length) {
                      end = position + word.length;
                    }
                    if(end > content.length){
                      end = content.length;
                    }
                    slicesOfContent.push(mergeIntoSlice(content, start, end, indexOfContent));
                  }

                  // sort slices in content by search text's count and hits' count

                  slicesOfContent.sort(function (sliceLeft, sliceRight) {
                    if (sliceLeft.searchTextCount !== sliceRight.searchTextCount) {
                      return sliceRight.searchTextCount - sliceLeft.searchTextCount;
                    } else if (sliceLeft.hits.length !== sliceRight.hits.length) {
                      return sliceRight.hits.length - sliceLeft.hits.length;
                    } else {
                      return sliceLeft.start - sliceRight.start;
                    }
                  });

                  // select top N slices in content

                  var upperBound = parseInt('1');
                  if (upperBound >= 0) {
                    slicesOfContent = slicesOfContent.slice(0, upperBound);
                  }

                  // highlight title and content

                  function highlightKeyword(text, slice) {
                    var result = '';
                    var prevEnd = slice.start;
                    slice.hits.forEach(function (hit) {
                      result += text.substring(prevEnd, hit.position);
                      var end = hit.position + hit.length;
                      result += '<b class="search-keyword">' + text.substring(hit.position, end) + '</b>';
                      prevEnd = end;
                    });
                    result += text.substring(prevEnd, slice.end);
                    return result;
                  }

                  var resultItem = '';

                  if (slicesOfTitle.length != 0) {
                    resultItem += "<li><a href='" + articleUrl + "' class='search-result-title'>" + highlightKeyword(title, slicesOfTitle[0]) + "</a>";
                  } else {
                    resultItem += "<li><a href='" + articleUrl + "' class='search-result-title'>" + title + "</a>";
                  }

                  slicesOfContent.forEach(function (slice) {
                    resultItem += "<a href='" + articleUrl + "'>" +
                      "<p class=\"search-result\">" + highlightKeyword(content, slice) +
                      "...</p>" + "</a>";
                  });

                  resultItem += "</li>";
                  resultItems.push({
                    item: resultItem,
                    searchTextCount: searchTextCount,
                    hitCount: hitCount,
                    id: resultItems.length
                  });
                }
              })
            };
            if (keywords.length === 1 && keywords[0] === "") {
              resultContent.innerHTML = '<div id="no-result"><i class="fa fa-search fa-5x" /></div>'
            } else if (resultItems.length === 0) {
              resultContent.innerHTML = '<div id="no-result"><i class="fa fa-frown-o fa-5x" /></div>'
            } else {
              resultItems.sort(function (resultLeft, resultRight) {
                if (resultLeft.searchTextCount !== resultRight.searchTextCount) {
                  return resultRight.searchTextCount - resultLeft.searchTextCount;
                } else if (resultLeft.hitCount !== resultRight.hitCount) {
                  return resultRight.hitCount - resultLeft.hitCount;
                } else {
                  return resultRight.id - resultLeft.id;
                }
              });
              var searchResultList = '<ul class=\"search-result-list\">';
              resultItems.forEach(function (result) {
                searchResultList += result.item;
              })
              searchResultList += "</ul>";
              resultContent.innerHTML = searchResultList;
            }
          }

          if ('auto' === 'auto') {
            input.addEventListener('input', inputEventFunction);
          } else {
            $('.search-icon').click(inputEventFunction);
            input.addEventListener('keypress', function (event) {
              if (event.keyCode === 13) {
                inputEventFunction();
              }
            });
          }

          // remove loading animation
          $(".local-search-pop-overlay").remove();
          $('body').css('overflow', '');

          proceedsearch();
        }
      });
    }

    // handle and trigger popup window;
    $('.popup-trigger').click(function(e) {
      e.stopPropagation();
      if (isfetched === false) {
        searchFunc(path, 'local-search-input', 'local-search-result');
      } else {
        proceedsearch();
      };
    });

    $('.popup-btn-close').click(onPopupClose);
    $('.popup').click(function(e){
      e.stopPropagation();
    });
    $(document).on('keyup', function (event) {
      var shouldDismissSearchPopup = event.which === 27 &&
        $('.search-popup').is(':visible');
      if (shouldDismissSearchPopup) {
        onPopupClose();
      }
    });
  </script><script>!function(){var t=document.createElement("script"),e=window.location.protocol.split(":")[0];t.src="https"===e?"https://zz.bdstatic.com/linksubmit/push.js":"http://push.zhanzhang.baidu.com/push.js";var s=document.getElementsByTagName("script")[0];s.parentNode.insertBefore(t,s)}()</script><script type="text/javascript" src="/js/src/js.cookie.js?v=5.1.1"></script><script type="text/javascript" src="/js/src/scroll-cookie.js?v=5.1.1"></script></body></html>