<!doctype html><html class="theme-next mist use-motion" lang="zh-Hans"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1"><meta http-equiv="Cache-Control" content="no-transform"><meta http-equiv="Cache-Control" content="no-siteapp"><link href="/lib/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css"><link href="//fonts.googleapis.com/css?family=Lato:300,300italic,400,400italic,700,700italic&subset=latin,latin-ext" rel="stylesheet" type="text/css"><link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css"><link href="/css/main.css?v=5.1.1" rel="stylesheet" type="text/css"><meta name="keywords" content="js,"><link rel="alternate" href="/atom.xml" title="Smalle's Blog | AEZOCN" type="application/atom+xml"><link rel="shortcut icon" type="image/x-icon" href="/favicon.ico?v=5.1.1"><meta name="description" content="ES6 (ES2015)Promise/async/await uni-app使用场景参考：uni-app.md#onLaunch等同步写法 Promise基本用法  1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556// =========="><meta name="keywords" content="js"><meta property="og:type" content="article"><meta property="og:title" content="JavaScript知识点"><meta property="og:url" content="http://blog.aezo.cn/2016/06/11/web/js-release/index.html"><meta property="og:site_name" content="Smalle&#39;s Blog | AEZOCN"><meta property="og:description" content="ES6 (ES2015)Promise/async/await uni-app使用场景参考：uni-app.md#onLaunch等同步写法 Promise基本用法  1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556// =========="><meta property="og:locale" content="zh-Hans"><meta property="og:updated_time" content="2021-08-31T06:07:20.368Z"><meta name="twitter:card" content="summary"><meta name="twitter:title" content="JavaScript知识点"><meta name="twitter:description" content="ES6 (ES2015)Promise/async/await uni-app使用场景参考：uni-app.md#onLaunch等同步写法 Promise基本用法  1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556// =========="><script type="text/javascript" id="hexo.configurations">var NexT=window.NexT||{},CONFIG={root:"/",scheme:"Mist",sidebar:{position:"right",display:"post",offset:12,offset_float:0,b2t:!1,scrollpercent:!1},fancybox:!0,motion:!0,duoshuo:{userId:"0",author:"博主"},algolia:{applicationID:"BWD6R9FA4K",apiKey:"3330f3cbaa099dfc30395de5f5b20151",indexName:"blog",hits:{per_page:10},labels:{input_placeholder:"请输入关键字",hits_empty:"我们没有找到任何搜索结果: ${query}",hits_stats:"找到约${hits}条结果（用时${time}ms）"}}}</script><link rel="canonical" href="http://blog.aezo.cn/2016/06/11/web/js-release/"><title>JavaScript知识点 | Smalle's Blog | AEZOCN</title><script type="text/javascript">var _hmt=_hmt||[];!function(){var e=document.createElement("script");e.src="https://hm.baidu.com/hm.js?d82223039d601f2f819f8fe140a63468";var t=document.getElementsByTagName("script")[0];t.parentNode.insertBefore(e,t)}()</script><div style="display:none"><script src="//s95.cnzz.com/z_stat.php?id=cnzz_stat_icon_1276691827&web_id=cnzz_stat_icon_1276691827" language="JavaScript"></script></div></head><body itemscope itemtype="http://schema.org/WebPage" lang="zh-Hans"><div class="container sidebar-position-right page-post-detail"><div class="headband"></div><header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader"><div class="header-inner"><div class="site-brand-wrapper"><div class="site-meta"><div class="custom-logo-site-title"><a href="/" class="brand" rel="start"><span class="logo-line-before"><i></i></span> <span class="site-title">Smalle's Blog | AEZOCN</span><span class="logo-line-after"><i></i></span></a></div><h1 class="site-subtitle" itemprop="description">Better Code, Better Life</h1></div><div class="site-nav-toggle"> <button><span class="btn-bar"></span><span class="btn-bar"></span><span class="btn-bar"></span></button></div></div><nav class="site-nav"><ul id="menu" class="menu"><li class="menu-item menu-item-home"><a href="/" rel="section"><i class="menu-item-icon fa fa-fw fa-home"></i><br> 首页</a></li><li class="menu-item menu-item-categories"><a href="/categories/" rel="section"><i class="menu-item-icon fa fa-fw fa-th"></i><br> 分类</a></li><li class="menu-item menu-item-about"><a href="/about/" rel="section"><i class="menu-item-icon fa fa-fw fa-user"></i><br> 关于</a></li><li class="menu-item menu-item-archives"><a href="/archives/" rel="section"><i class="menu-item-icon fa fa-fw fa-archive"></i><br> 归档</a></li><li class="menu-item menu-item-tags"><a href="/tags/" rel="section"><i class="menu-item-icon fa fa-fw fa-tags"></i><br> 标签</a></li><li class="menu-item menu-item-sitemap"><a href="/sitemap.xml" rel="section"><i class="menu-item-icon fa fa-fw fa-sitemap"></i><br> 站点地图</a></li><li class="menu-item menu-item-search"><a href="javascript:;" class="popup-trigger"><i class="menu-item-icon fa fa-search fa-fw"></i><br> 搜索</a></li></ul><div class="site-search"><div class="popup search-popup local-search-popup"><div class="local-search-header clearfix"><span class="search-icon"><i class="fa fa-search"></i></span><span class="popup-btn-close"><i class="fa fa-times-circle"></i></span><div class="local-search-input-wrapper"> <input autocomplete="off" placeholder="搜索..." spellcheck="false" type="text" id="local-search-input"></div></div><div id="local-search-result"></div></div></div></nav></div></header><main id="main" class="main"><div class="main-inner"><div class="content-wrap"><div id="content" class="content"><div id="posts" class="posts-expand"><article class="post post-type-normal" itemscope itemtype="http://schema.org/Article"><link itemprop="mainEntityOfPage" href="http://blog.aezo.cn/2016/06/11/web/js-release/"><span hidden itemprop="author" itemscope itemtype="http://schema.org/Person"><meta itemprop="name" content="smalle"><meta itemprop="description" content=""><meta itemprop="image" content="https://avatars0.githubusercontent.com/u/15698218?v=3&u=ce740bf0b67ff0d74990ba6fc644d6e92f572dcb&s=400"></span><span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization"><meta itemprop="name" content="Smalle's Blog | AEZOCN"></span><header class="post-header"><h2 class="post-title" itemprop="name headline">JavaScript知识点</h2><div class="post-meta"><span class="post-time"><span class="post-meta-item-icon"><i class="fa fa-calendar-o"></i></span> <span class="post-meta-item-text">发表于</span> <time title="创建于" itemprop="dateCreated datePublished" datetime="2016-06-11T16:51:00+08:00">2016-06-11</time></span> <span class="post-category"><span class="post-meta-divider">|</span><span class="post-meta-item-icon"><i class="fa fa-folder-o"></i></span> <span class="post-meta-item-text">分类于</span> <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/web/" itemprop="url" rel="index"><span itemprop="name">web</span></a></span></span></div></header><div class="post-body" itemprop="articleBody"><div></div><h2 id="ES6-ES2015"><a href="#ES6-ES2015" class="headerlink" title="ES6 (ES2015)"></a>ES6 (ES2015)</h2><h3 id="Promise-async-await"><a href="#Promise-async-await" class="headerlink" title="Promise/async/await"></a>Promise/async/await</h3><ul><li>uni-app使用场景参考：<a href="/_posts/web/mobile/uni-app.md#onLaunch等同步写法">uni-app.md#onLaunch等同步写法</a></li><li>Promise基本用法</li></ul><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// ==============================基本用法1</span></span><br><span class="line"><span class="keyword">new</span> <span class="built_in">Promise</span>(<span class="function"><span class="keyword">function</span> (<span class="params">resolve, reject</span>) </span>&#123;</span><br><span class="line">    log(<span class="string">'start new Promise...'</span>);</span><br><span class="line">    <span class="keyword">var</span> timeOut = <span class="built_in">Math</span>.random() * <span class="number">2</span>;</span><br><span class="line">    log(<span class="string">'set timeout to: '</span> + timeOut + <span class="string">' seconds.'</span>);</span><br><span class="line">    setTimeout(<span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (timeOut &lt; <span class="number">1</span>) &#123;</span><br><span class="line">            log(<span class="string">'call resolve()...'</span>);</span><br><span class="line">            resolve(<span class="string">'200 OK'</span>); <span class="comment">// 相当于调用 then 传入函数</span></span><br><span class="line">            log(<span class="string">'还会继续执行...'</span>)</span><br><span class="line">            <span class="comment">// return resolve('200 OK');</span></span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            log(<span class="string">'call reject()...'</span>);</span><br><span class="line">            reject(<span class="string">'timeout in '</span> + timeOut + <span class="string">' seconds.'</span>); <span class="comment">// 相当于调用catch传入函数</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;, timeOut * <span class="number">1000</span>);</span><br><span class="line">&#125;).then(<span class="function"><span class="keyword">function</span> (<span class="params">r0</span>) </span>&#123;</span><br><span class="line">    <span class="comment">// 此处不返回 Promise, 后面也可继续 then, 只是拿不到数据</span></span><br><span class="line">    <span class="comment">// 如果此处为`return "00";`，则后面再 then(r1 =&gt; console.log(r1)) 打印的为 undefined</span></span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">new</span> <span class="built_in">Promise</span>(<span class="function">(<span class="params">resolve, reject</span>) =&gt;</span> &#123;</span><br><span class="line">        resolve(r0 + <span class="string">"0"</span>, <span class="string">'r2'</span>) <span class="comment">// 假设 r0 为 "0"，则后面 r1 为 "00", r2 为 "r2"</span></span><br><span class="line">    &#125;);</span><br><span class="line">&#125;).then(<span class="function"><span class="keyword">function</span> (<span class="params">r1, r2</span>) </span>&#123;</span><br><span class="line">    log(r1, r2);</span><br><span class="line">&#125;).then(<span class="function"><span class="params">data</span> =&gt;</span> &#123;</span><br><span class="line">    log(data); <span class="comment">// undefined</span></span><br><span class="line">&#125;).catch(<span class="function"><span class="params">reason</span> =&gt;</span> &#123;</span><br><span class="line">    log(<span class="string">'Failed: '</span> + reason);</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="comment">// ==============================基本用法2</span></span><br><span class="line"><span class="built_in">Promise</span>.resolve(<span class="string">'foo'</span>) <span class="comment">// 等价于 new Promise(resolve =&gt; resolve('foo'))</span></span><br><span class="line"><span class="built_in">Promise</span>.resolve() <span class="comment">// 不带参数返回</span></span><br><span class="line"><span class="built_in">Promise</span>.reject(<span class="string">'error'</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">// 如果参数是 Promise 实例，那么Promise.resolve将不做任何修改、原封不动地返回这个实例</span></span><br><span class="line"><span class="comment">// 参数是一个thenable对象()，Promise.resolve方法会将这个对象转为 Promise 对象，然后就立即执行thenable对象的then方法</span></span><br><span class="line"><span class="keyword">let</span> thenable = &#123;</span><br><span class="line">  then: <span class="function"><span class="keyword">function</span>(<span class="params">resolve, reject</span>) </span>&#123;</span><br><span class="line">    resolve(<span class="number">42</span>);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="built_in">Promise</span>.resolve(thenable)</span><br><span class="line"></span><br><span class="line"><span class="comment">// 需要注意的是，立即resolve的 Promise 对象，是在本轮“事件循环”（event loop）的结束时，而不是在下一轮“事件循环”的开始时</span></span><br><span class="line"><span class="comment">// 下面代码中，setTimeout(fn, 0)在下一轮“事件循环”开始时执行，Promise.resolve()在本轮“事件循环”结束时执行，console.log('one')则是立即执行，因此最先输出</span></span><br><span class="line">setTimeout(<span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="built_in">console</span>.log(<span class="string">'three'</span>)</span><br><span class="line">&#125;, <span class="number">0</span>)</span><br><span class="line"><span class="built_in">Promise</span>.resolve().then(<span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="built_in">console</span>.log(<span class="string">'two'</span>)</span><br><span class="line">&#125;)</span><br><span class="line"><span class="built_in">console</span>.log(<span class="string">'one'</span>)</span><br><span class="line"><span class="comment">// one</span></span><br><span class="line"><span class="comment">// two</span></span><br><span class="line"><span class="comment">// three</span></span><br></pre></td></tr></table></figure><ul><li><p><a href="https://developer.mozilla.org/zh-CN/docs/learn/JavaScript/%E5%BC%82%E6%AD%A5/Async_await" target="_blank" rel="noopener">async、await</a></p><ul><li>说明<ul><li><code>async</code>：把它放在函数声明之前，使其成为 async function。<strong>可单独使用，被标识的函数成为异步函数，返回Promise对象</strong></li><li><code>await</code>：只能在异步函数（async修饰）里面才起作用。<strong>必须和async联用</strong></li><li><strong>在forEach/map/reduce等函数中不能直接使用await调用其他函数(for和for…of中可以)，尽管在回调函数的参数上加async也不行</strong>，见下列<ul><li>原理应该是foreach内部封装了while，循环并行执行，而且并行执行数组的所有callback函数，不会等待里面的callback的返回</li></ul></li></ul></li><li><p>async简单使用</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 1.async</span></span><br><span class="line"><span class="keyword">async</span> <span class="function"><span class="keyword">function</span> <span class="title">hello</span>(<span class="params"></span>) </span>&#123; <span class="keyword">return</span> <span class="string">"Hello"</span> &#125;</span><br><span class="line"><span class="comment">// 等同于</span></span><br><span class="line"><span class="comment">// async function hello() &#123; return new Promise((resolve, reject) =&gt; &#123;resolve("Hello")&#125;) &#125;</span></span><br><span class="line">hello() <span class="comment">// 返回一个 Promise</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 2.async</span></span><br><span class="line"><span class="keyword">let</span> hello = <span class="keyword">async</span> () =&gt; &#123; <span class="keyword">return</span> <span class="string">"Hello"</span> &#125;</span><br><span class="line">hello().then(<span class="function">(<span class="params">data</span>) =&gt;</span> <span class="built_in">console</span>.log(data)).catch(<span class="function"><span class="params">err</span> =&gt;</span> <span class="built_in">console</span>.log(err)) <span class="comment">// 或者 hello().then(console.log)</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 必须在forEach回调函数参数处加async才可正常使用，for和for...of中可直接使用await</span></span><br><span class="line"><span class="keyword">async</span> test() &#123;</span><br><span class="line">    arr.forEach(<span class="keyword">async</span> (item, index) =&gt; &#123;</span><br><span class="line">        <span class="keyword">await</span> hello()</span><br><span class="line">    &#125;)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li><li><p>async、await、Promise.all</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">timeoutPromise</span>(<span class="params">interval</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">new</span> <span class="built_in">Promise</span>(<span class="function">(<span class="params">resolve, reject</span>) =&gt;</span> &#123;</span><br><span class="line">        setTimeout(<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">            resolve(<span class="string">"done"</span>);</span><br><span class="line">        &#125;, interval);</span><br><span class="line">    &#125;);</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 方式一：耗时9004。简单async、await，下面3个函数要依次等待执行，但是 timeTest1 仍然是一个异步函数(返回了 Promise 对象)</span></span><br><span class="line"><span class="keyword">async</span> <span class="function"><span class="keyword">function</span> <span class="title">timeTest1</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">await</span> timeoutPromise(<span class="number">3000</span>);</span><br><span class="line">    <span class="keyword">await</span> timeoutPromise(<span class="number">3000</span>);</span><br><span class="line">    <span class="keyword">await</span> timeoutPromise(<span class="number">3000</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 方式二：耗时3002。通过将 Promise 对象存储在变量中来同时开始3个timeoutPromise，然后同步等待结果</span></span><br><span class="line"><span class="keyword">async</span> <span class="function"><span class="keyword">function</span> <span class="title">timeTest2</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">const</span> timeoutPromise1 = timeoutPromise(<span class="number">3000</span>);</span><br><span class="line">    <span class="keyword">const</span> timeoutPromise2 = timeoutPromise(<span class="number">3000</span>);</span><br><span class="line">    <span class="keyword">const</span> timeoutPromise3 = timeoutPromise(<span class="number">3000</span>);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">await</span> timeoutPromise1;</span><br><span class="line">    <span class="keyword">await</span> timeoutPromise2;</span><br><span class="line">    <span class="keyword">await</span> timeoutPromise3;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// **方式三**：耗时3002。Promise.all</span></span><br><span class="line"><span class="keyword">async</span> <span class="function"><span class="keyword">function</span> <span class="title">timeTest3</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">const</span> timeoutPromise1 = timeoutPromise(<span class="number">3000</span>);</span><br><span class="line">    <span class="keyword">const</span> timeoutPromise2 = timeoutPromise(<span class="number">3000</span>);</span><br><span class="line">    <span class="keyword">const</span> timeoutPromise3 = timeoutPromise(<span class="number">3000</span>);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">let</span> values = <span class="keyword">await</span> <span class="built_in">Promise</span>.all([timeoutPromise1, timeoutPromise2, timeoutPromise3]);</span><br><span class="line">    <span class="built_in">console</span>.log(values) <span class="comment">// ["done", "done", "done"]</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> startTime = <span class="built_in">Date</span>.now();</span><br><span class="line">timeTest1().then(<span class="function"><span class="params">()</span> =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">let</span> finishTime = <span class="built_in">Date</span>.now();</span><br><span class="line">    <span class="keyword">let</span> timeTaken = finishTime - startTime;</span><br><span class="line">    alert(<span class="string">"Time taken in milliseconds: "</span> + timeTaken);</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure></li><li><p>async、forEach/map不建议联用</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> test = &#123;</span><br><span class="line">    main: <span class="function"><span class="params">()</span> =&gt;</span> &#123;</span><br><span class="line">        <span class="comment">// 普通for，结果为顺序执行，耗时较长。start-1 -&gt; return-1 -&gt; end-1 -&gt; ... -&gt; over</span></span><br><span class="line">        test.run()</span><br><span class="line">    &#125;,</span><br><span class="line">    main2: <span class="function"><span class="params">()</span> =&gt;</span> &#123;</span><br><span class="line">        <span class="comment">// 存在异步，耗时较短。start-1 -&gt; 顺序 -&gt; start-10 -&gt; return-1 -&gt; end-1 -&gt; 顺序 -&gt; over</span></span><br><span class="line">        test.run2()</span><br><span class="line">    &#125;,</span><br><span class="line">    main3: <span class="function"><span class="params">()</span> =&gt;</span> &#123;</span><br><span class="line">        <span class="comment">// 存在异步，耗时较短。start-1 -&gt; 顺序 -&gt; start-10 -&gt; return-1 -&gt; end-1 -&gt; 顺序 -&gt; over</span></span><br><span class="line">        test.run3()</span><br><span class="line">    &#125;,</span><br><span class="line">    run: <span class="keyword">async</span> () =&gt; &#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">let</span> index = <span class="number">0</span>; index &lt; <span class="number">10</span>; index++) &#123;</span><br><span class="line">            <span class="built_in">console</span>.log(<span class="string">'start-'</span> + index)</span><br><span class="line">            <span class="keyword">await</span> test.timeoutPromise(index * <span class="number">10</span>).then(<span class="function"><span class="params">data</span> =&gt;</span> &#123;</span><br><span class="line">                <span class="built_in">console</span>.log(<span class="string">'return-'</span> + index)</span><br><span class="line">            &#125;)</span><br><span class="line">            <span class="built_in">console</span>.log(<span class="string">'end-'</span> + index)</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="built_in">console</span>.log(<span class="string">'over'</span>)</span><br><span class="line">    &#125;,</span><br><span class="line">    run2: <span class="function"><span class="params">()</span> =&gt;</span> &#123;</span><br><span class="line">        [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>, <span class="number">6</span>, <span class="number">7</span>, <span class="number">8</span>, <span class="number">9</span>, <span class="number">10</span>].forEach(<span class="keyword">async</span> (index) =&gt; &#123;</span><br><span class="line">            <span class="built_in">console</span>.log(<span class="string">'start-'</span> + index)</span><br><span class="line">            <span class="keyword">await</span> test.timeoutPromise(index * <span class="number">10</span>).then(<span class="function"><span class="params">data</span> =&gt;</span> &#123;</span><br><span class="line">                <span class="built_in">console</span>.log(<span class="string">'return-'</span> + index)</span><br><span class="line">            &#125;)</span><br><span class="line">            <span class="built_in">console</span>.log(<span class="string">'end-'</span> + index)</span><br><span class="line">        &#125;)</span><br><span class="line">        <span class="built_in">console</span>.log(<span class="string">'over'</span>)</span><br><span class="line">    &#125;,</span><br><span class="line">    run3: <span class="keyword">async</span> () =&gt; &#123;</span><br><span class="line">        <span class="comment">// 此处去掉 Promise.all 或者换成 map 结果都一样</span></span><br><span class="line">        <span class="keyword">await</span> <span class="built_in">Promise</span>.all([<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>, <span class="number">6</span>, <span class="number">7</span>, <span class="number">8</span>, <span class="number">9</span>, <span class="number">10</span>].forEach(<span class="keyword">async</span> (index) =&gt; &#123;</span><br><span class="line">            <span class="built_in">console</span>.log(<span class="string">'start-'</span> + index)</span><br><span class="line">            <span class="keyword">await</span> test.timeoutPromise(index * <span class="number">10</span>).then(<span class="function"><span class="params">data</span> =&gt;</span> &#123;</span><br><span class="line">                <span class="built_in">console</span>.log(<span class="string">'return-'</span> + index)</span><br><span class="line">            &#125;)</span><br><span class="line">            <span class="built_in">console</span>.log(<span class="string">'end-'</span> + index)	</span><br><span class="line">        &#125;))</span><br><span class="line">        <span class="built_in">console</span>.log(<span class="string">'over'</span>)</span><br><span class="line">    &#125;,</span><br><span class="line">    timeoutPromise: <span class="function">(<span class="params">interval</span>) =&gt;</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> <span class="built_in">Promise</span>(<span class="function">(<span class="params">resolve, reject</span>) =&gt;</span> &#123;</span><br><span class="line">            setTimeout(<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">                resolve(<span class="string">"done"</span>);</span><br><span class="line">            &#125;, interval);</span><br><span class="line">        &#125;);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li></ul></li><li><p>axios返回Promise</p></li></ul><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">res</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="comment">// 返回Promise</span></span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">this</span>.axios.post(<span class="string">"http://localhost/test"</span>, &#123;&#125;)</span><br><span class="line">            .then(<span class="function"><span class="params">response</span> =&gt;</span> &#123;</span><br><span class="line">                <span class="keyword">const</span> res = response.data</span><br><span class="line">                <span class="keyword">const</span> status = res.status</span><br><span class="line"></span><br><span class="line">                <span class="comment">// 返回数据</span></span><br><span class="line">                <span class="keyword">return</span> &#123;status, res&#125;</span><br><span class="line">            &#125;);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">test</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    res().then(<span class="function"><span class="params">data</span> =&gt;</span> &#123;</span><br><span class="line">        <span class="comment">// data为上面返回的数据</span></span><br><span class="line">        <span class="built_in">console</span>.log(data.status)</span><br><span class="line">        <span class="built_in">console</span>.log(data.res)</span><br><span class="line">    &#125;)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="扩展运算符-…"><a href="#扩展运算符-…" class="headerlink" title="扩展运算符(…)"></a>扩展运算符(…)</h3><ul><li>ES7 有一个提案，将 Rest 解构赋值/扩展运算符(…)引入对象。Babel 转码器已经支持这项功能 <a href="https://blog.csdn.net/qq_30100043/article/details/53424750" title="javascript对象的扩展运算符" target="_blank" rel="noopener">^1</a></li><li>Rest 解构赋值<ul><li>解构赋值必须是最后一个参数，否则会报错 (2)</li><li>Rest解构赋值的拷贝是浅拷贝。即如果一个键的值是复合类型的值（数组、对象、函数），那么 Rest 解构赋值拷贝的是这个值的引用，而不是这个值的副本 (3)</li></ul></li></ul><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// (1)</span></span><br><span class="line"><span class="keyword">let</span> &#123; x, y, ...z &#125; = &#123; <span class="attr">x</span>: <span class="number">1</span>, <span class="attr">y</span>: <span class="number">2</span>, <span class="attr">a</span>: <span class="number">3</span>, <span class="attr">b</span>: <span class="number">4</span> &#125;; <span class="comment">// 相当于 x=1; y=2; z=&#123;a: 3, b: 4&#125;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// (2) Rest解构赋值必须是最后一个参数，否则会报错</span></span><br><span class="line"><span class="keyword">let</span> &#123; x, y, ...z &#125; = <span class="literal">null</span>; <span class="comment">//  运行时错误</span></span><br><span class="line"><span class="keyword">let</span> &#123; x, y, ...z &#125; = <span class="literal">undefined</span>; <span class="comment">//  运行时错误  </span></span><br><span class="line"><span class="keyword">let</span> &#123; ...x, y, z &#125; = obj; <span class="comment">//  句法错误</span></span><br><span class="line"><span class="keyword">let</span> &#123; x, ...y, ...z &#125; = obj; <span class="comment">//  句法错误  </span></span><br><span class="line"></span><br><span class="line"><span class="comment">// (3) x是 Rest 解构赋值所在的对象，拷贝了对象obj的a属性。a属性引用了一个对象，修改这个对象的值，会影响到 Rest 解构赋值对它的引用。同理修改 x.a.b 也会影响 obj</span></span><br><span class="line"><span class="keyword">let</span> obj = &#123; <span class="attr">a</span>: &#123; <span class="attr">b</span>: <span class="number">1</span> &#125; &#125;;</span><br><span class="line"><span class="keyword">let</span> &#123; ...x &#125; = obj;  </span><br><span class="line">obj.a.b = <span class="number">2</span>;</span><br><span class="line"><span class="built_in">console</span>.log(x.a.b) <span class="comment">// 2</span></span><br></pre></td></tr></table></figure><ul><li>扩展运算符<ul><li>等同于 Object.assign (2)</li><li>如果用户自定义的属性，放在扩展运算符后面，则扩展运算符内部的同名属性会被覆盖掉 (3)</li><li>Rest 解构赋值不会拷贝继承自原型对象的属性 (4)</li><li>扩展运算符的参数对象之中，如果有取值函数get，这个函数是会执行的 (5)</li></ul></li></ul><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// (1)</span></span><br><span class="line"><span class="keyword">let</span> z = &#123; <span class="attr">a</span>: <span class="number">3</span>, <span class="attr">b</span>: <span class="number">4</span> &#125;;</span><br><span class="line"><span class="keyword">let</span> n = &#123; ...z &#125;;  </span><br><span class="line"><span class="built_in">console</span>.log(n) <span class="comment">// &#123; a: 3, b: 4 &#125;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> emptyObject = &#123; ...null, ...undefined &#125;; <span class="comment">// 不报错</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// (2) 等同于 Object.assign</span></span><br><span class="line"><span class="comment">// 等同于</span></span><br><span class="line"><span class="keyword">let</span> aClone = &#123; ...a &#125;;</span><br><span class="line"><span class="keyword">let</span> aClone = <span class="built_in">Object</span>.assign(&#123;<span class="attr">x</span>: <span class="number">1</span>&#125;, a); <span class="comment">// ****** a中的值会覆盖第一个对象的属性值 *****</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 等同于</span></span><br><span class="line"><span class="keyword">let</span> ab = &#123; ...a, ...b &#125;;</span><br><span class="line"><span class="keyword">let</span> ab = <span class="built_in">Object</span>.assign(&#123;&#125;, a, b);</span><br><span class="line"></span><br><span class="line"><span class="comment">// (3)</span></span><br><span class="line"><span class="comment">// 等同于。a对象的x属性和y属性，拷贝到新对象后会被覆盖掉</span></span><br><span class="line"><span class="keyword">let</span> aWithOverrides = &#123; ...a, <span class="attr">x</span>: <span class="number">1</span>, <span class="attr">y</span>: <span class="number">2</span> &#125;;  </span><br><span class="line"><span class="keyword">let</span> aWithOverrides = &#123; ...a, ...&#123; <span class="attr">x</span>: <span class="number">1</span>, <span class="attr">y</span>: <span class="number">2</span> &#125; &#125;;  </span><br><span class="line"><span class="keyword">let</span> x = <span class="number">1</span>, y = <span class="number">2</span>, aWithOverrides = &#123; ...a, x, y &#125;;  </span><br><span class="line"><span class="keyword">let</span> aWithOverrides = <span class="built_in">Object</span>.assign(&#123;&#125;, a, &#123; <span class="attr">x</span>: <span class="number">1</span>, <span class="attr">y</span>: <span class="number">2</span> &#125;);  </span><br><span class="line"></span><br><span class="line"><span class="comment">// 等同于。如果把自定义属性放在扩展运算符前面，就变成了设置新对象的默认属性值</span></span><br><span class="line"><span class="keyword">let</span> aWithDefaults = &#123; <span class="attr">x</span>: <span class="number">1</span>, <span class="attr">y</span>: <span class="number">2</span>, ...a &#125;;  </span><br><span class="line"><span class="keyword">let</span> aWithDefaults = <span class="built_in">Object</span>.assign(&#123;&#125;, &#123; <span class="attr">x</span>: <span class="number">1</span>, <span class="attr">y</span>: <span class="number">2</span> &#125;, a);</span><br><span class="line"><span class="keyword">let</span> aWithDefaults = <span class="built_in">Object</span>.assign(&#123; <span class="attr">x</span>: <span class="number">1</span>, <span class="attr">y</span>: <span class="number">2</span> &#125;, a);</span><br><span class="line"></span><br><span class="line"><span class="comment">// (4) Rest 解构赋值不会拷贝继承自原型对象的属性</span></span><br><span class="line"><span class="keyword">let</span> o1 = &#123; <span class="attr">a</span>: <span class="number">1</span> &#125;;</span><br><span class="line"><span class="keyword">let</span> o2 = &#123; <span class="attr">b</span>: <span class="number">2</span> &#125;;</span><br><span class="line">o2.__proto__ = o1;</span><br><span class="line"><span class="keyword">let</span> o3 = &#123; ...o2 &#125;;</span><br><span class="line"><span class="built_in">console</span>.log(o3) <span class="comment">// &#123; b: 2 &#125;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// (5) 扩展运算符的参数对象之中，如果有取值函数get，这个函数是会执行的</span></span><br><span class="line"><span class="comment">// 并不会抛出错误，因为 x 属性只是被定义，但没执行。当执行 aWithXGetter.x 时抛出错误</span></span><br><span class="line"><span class="keyword">let</span> aWithXGetter = &#123; </span><br><span class="line">    ...a,  </span><br><span class="line">    get x() &#123;</span><br><span class="line">        <span class="keyword">throw</span> <span class="keyword">new</span> <span class="built_in">Error</span>(<span class="string">'not thrown yet'</span>);  </span><br><span class="line">    &#125;  </span><br><span class="line">&#125;;  </span><br><span class="line"><span class="comment">// 会抛出错误，因为 x 属性被执行了</span></span><br><span class="line"><span class="keyword">let</span> runtimeError = &#123;</span><br><span class="line">    ...a,</span><br><span class="line">    ...&#123;</span><br><span class="line">        get x() &#123;</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> <span class="built_in">Error</span>(<span class="string">'thrown now'</span>);  </span><br><span class="line">        &#125;  </span><br><span class="line">    &#125;  </span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><h2 id="ES5"><a href="#ES5" class="headerlink" title="ES5"></a>ES5</h2><h3 id="介绍"><a href="#介绍" class="headerlink" title="介绍"></a>介绍</h3><ul><li>历史<ul><li>javaScript 前身是 liveScript(Netscape，网景公司), 执行标准 ECMAScript (规定核心语法)</li></ul></li><li>关联<ul><li>前端三大语言：HTML、CSS、JS</li><li>W3C 推出 DOM 标准：专门操作 HTML 元素，CSS样式，事件的统一标准。（规定比较重要）</li><li>BOM标准：专门操作浏览器窗口的工具，无标准，由浏览器厂商自行实现</li><li>最后Netscape倒闭，工程师成立 Mozilla 基金会，最后发布 FireFox（理念是符合标准）</li></ul></li><li><strong>完整的 javaScript 语言由三部分组成</strong><ul><li>核心（<code>ECMAScript</code>）</li><li>文档对象模型（<code>DOM</code>，Document Object Model）</li><li>浏览器对象模型（<code>BOM</code>，Browser Object Model）</li></ul></li><li>javaScript 特点<ul><li>纯文本</li><li>解释执行（读一行执行一行，后面的覆盖前面的）<ul><li>javaScript运行在javascript解释器中，如浏览器中包含的解释器，或node解释器</li><li>浏览器包含排版引擎和解释引擎。根据html标签决定使用什么引擎，<code>&lt;script&gt;</code>则找解释引擎</li></ul></li><li>弱类型</li><li>基于对象</li></ul></li></ul><h3 id="基本知识"><a href="#基本知识" class="headerlink" title="基本知识"></a>基本知识</h3><ul><li>区分大小写</li><li>字符串必须用单双引号包裹，语句有无分号效果一样</li><li><code>//</code>单行注释，<code>/* */</code>多行注释（注释也占网页流量，生产环境最好去掉）</li><li><code>console.log();</code> 可在控制台打印相关信息，对程序无影响（<code>alert();</code>弹框打印）</li><li>利用<code>debugger;</code>调试，或者找到相应的源码再打断点</li><li><code>var input = prompt(&quot;请输入数据&quot;);</code> 用于收集用户输入数据的对话框（类似alert弹框）</li><li><code>&lt;script&gt;</code>脚本中的错误，仅影响当前脚本块中出错位置之后的代码(之前的代码照常执行)；function中的错误，只有调用方法时才触发</li><li>引入js文件时，<code>&lt;script&gt;</code>不支持单标签。必须使用 <code>&lt;script src=&quot;&quot;&gt;&lt;/script&gt;</code></li><li>chrome 的控制台（F12），按 Shift+Enter 可换行</li><li>nodejs 也可直接运行js文件，相当于解释器</li><li>事件：元素根据鼠标或者键盘的不同操作响应不同的交互行为。html的事件属性，如 ：onclick</li><li>网页的显示最好在7秒内，<code>&lt;script&gt;</code>一般放在body最后，为了使DOM先加载完</li><li><code>window</code>对象：是整个网页的全局作用域对象</li></ul><h4 id="变量"><a href="#变量" class="headerlink" title="变量"></a>变量</h4><ul><li><p>使用<code>var</code>声明变量(一般驼峰)，<strong>使用<code>const</code>定义常量</strong> (一般大写)</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> a = &#123;<span class="attr">a</span>: <span class="number">1</span>&#125;</span><br><span class="line"><span class="keyword">const</span> b = a <span class="comment">// 此时指向a的引用，当a被重新赋值时，会拷贝a的数据。类似Copy On Write机制</span></span><br><span class="line">b = &#123;<span class="attr">b</span>: <span class="number">1</span>&#125; <span class="comment">// 报错：Uncaught TypeError: Assignment to constant variable.</span></span><br><span class="line">a.b = <span class="number">2</span></span><br><span class="line"><span class="built_in">console</span>.log(b) <span class="comment">// &#123;a: 1, b: 2&#125;</span></span><br><span class="line">a = &#123;&#125;</span><br><span class="line"><span class="built_in">console</span>.log(b) <span class="comment">// &#123;a: 1, b: 2&#125;</span></span><br></pre></td></tr></table></figure></li><li><p>js中新同名变量的空间会替换旧变量的空间</p></li><li>程序都是在内存中运行的。变量声明-初始化-使用。声明是在内存中开辟一个空间，并起一个名字</li></ul><h4 id="数据类型"><a href="#数据类型" class="headerlink" title="数据类型"></a>数据类型</h4><ul><li><strong><code>js是弱类型</code></strong> ：变量本身没有类型，只有变量中的值才有类型；一个变量可以反复保存不同类型的数据</li><li><strong><code>js数据类型</code></strong> ：包括原始数据类型和引用数据类型<ul><li>原始数据类型(数据保存在变量本地, 栈中)<ul><li>分类：number(数字)、string、boolean、null、undefined(未定义)</li><li>原始类型大小，number：整数4字节，浮点8字节；string：Unicode每个字符占两字节，UTF-8字母数字占1字节，汉字占3字节</li><li>number<ul><li>js中一切数字都用number保存，不分整型和浮点型</li><li>number类型值为不带引号的数字</li><li>使用<code>toFixed(小数位数)</code>四舍五入解决舍入误差</li></ul></li><li>string<ul><li>Unicode是对所有语言文字中的字符编号（计算机只能处理数字，无法处理字符）</li><li><code>字符串.charCodeAt(字符在字符串中的下标)</code>获取该字符的Unicode国际编码</li><li>js不严格区分字符串和字符</li><li>转义字符，如<code>\n</code></li></ul></li><li>undefined<ul><li>标识变量仅声明过，但从未赋值；变量未赋值时，js默认赋值为undefined。undefined类型的值是”undefined”</li></ul></li></ul></li><li>引用数据类型(数据保存在堆中)<ul><li>分类：Object、Function、Number、String、Boolean、Data、Error等</li></ul></li><li>利用 <code>typeof(X)</code> 可打印原始数据类型（返回string/number/boolean/object/function/undefined）</li><li>使用 <code>arr instanceof Array</code> 用于判断一个变量是否为某个对象的实例</li></ul></li><li><strong><code>js数据类型转换</code></strong> : 包括隐式转换(程序自动转换数据类型)和强制转换<ul><li><strong><code>+</code> 号的隐式转换</strong> ：只要有字符串参与，一切类型都变为字符串(true为”true”)；如果没有字符串参与，一切按数字计算(true转成1，false转成0)</li><li><strong><code>-</code> 号的隐式转换</strong>：任意数据类型做减法则先转成数值再运算，如果不能自动转成数字，则返回NaN，如果字符串为空则转成0</li><li><strong>强制转换</strong> ：X.<code>toString()</code>、Number(X)、<code>parseInt(X)</code>、<code>parseFloat(X)</code>、Boolean(X)</li><li>凡是从页面获取的数据都是字符串，必须先转换再计算</li><li><strong>js变量为数值类型且值为0时，转成字符串就会变成<code>&#39;&#39;</code></strong>。因此<code>var i = 0; console.log(i == &#39;&#39;);</code>打印结果为<code>true</code></li></ul></li><li><code>Number(X)</code>、<code>parseInt(X)</code> 和 <code>parseFloat(X)</code>区别<ul><li><code>Number()</code> 是将数据转成数值型，如果被转的对象还有其他字符则转换不了</li><li><code>parseInt()</code> 从X字符串的第一个字符开始读取，如果遇到非数字的字符(包括小数点)则停止读取。如果第一个字符不是数字或为空的则返回<code>NaN</code><ul><li><code>NaN</code> (Not a Number) : 是一个不是数字(内容)的数字(类型)；NaN和数字计算返回的还是NaN</li><li><code>Infinity</code>(无穷大)：也是一个是一个不是数字(内容)的数字(类型)，如 10/0 时</li></ul></li><li><code>parseFloat()</code><ul><li>只识别第一个小数点，如果第一个小数点前无字符，则默认加零</li><li>如果能将数据转成整数则不转成浮点（如parseFloat(2.0)的结果是2）</li></ul></li><li>js字符串转数字与小数点保留：<a href="https://juejin.im/post/5cafdf075188251aee3a6071" target="_blank" rel="noopener">https://juejin.im/post/5cafdf075188251aee3a6071</a></li><li>浮点数运算，参考：<a href="https://blog.csdn.net/u013347241/article/details/79210840" target="_blank" rel="noopener">https://blog.csdn.net/u013347241/article/details/79210840</a><ul><li><code>console.log(0.1+0.2)</code> 返回 0.30000000000000004</li><li>解决：如使用<a href="https://github.com/MikeMcl/bignumber.js" target="_blank" rel="noopener">bignumber</a>等类库</li></ul></li></ul></li></ul><h4 id="运算符"><a href="#运算符" class="headerlink" title="运算符"></a>运算符</h4><ul><li>算术运算符：<code>+ - * / % ++ --</code></li><li>关系运算符：<code>&gt; &lt; == &gt;= &lt;= != ===</code><ul><li><strong>类型自动转换</strong>（关系运算中）：字符串参与的比较则是比较每个字符的Unicode大小；空字符串会转为0；任何类型和数字进行比较都会转为数字再比较；布尔参与的会先变成数字</li><li>严格相等：<code>===</code>（不带类型自动转换的比较，要求类型和值都相等；一般在不知道变量类型且不希望类型转换时使用）</li><li><code>NaN</code> 和任何数字进行比较总返回 false</li><li><code>isNaN(X)</code> 实际上是将X和NaN进行==比较。<strong>isNaN采用的是Number(X)的隐式转换</strong>。如果X是数字则返回false，否则返回true。</li><li>普通数据先转换为相同数据类型再比较；如果结果可能是undefined则用严格比较；如果判读结果是否是数字，则用isNaN判断</li></ul></li><li>逻辑运算：<code>|| &amp;&amp; !</code></li><li>位移：右移<code>&gt;&gt;</code> 左移<code>&lt;&lt;</code> （eg: 64&gt;&gt;3 实际是 64/(2<em>2</em>2)=8; 2&lt;&lt;2 实际是 2<em>(2</em>2)=8）</li><li>赋值运算：<code>= += -+ *= /= %=</code> <strong>不建议使用连等赋值</strong></li><li>三目运算符：<code>? :</code></li><li><a href="https://my.oschina.net/u/3704591/blog/4913157" target="_blank" rel="noopener">ES2020、ES2021新加??/?./,/_ 等运算符</a></li></ul><h4 id="流程语句"><a href="#流程语句" class="headerlink" title="流程语句"></a>流程语句</h4><ul><li><code>if</code>、<code>switch</code>、<code>while</code>、<code>for</code></li><li>增强for循环（拿到的是下标）</li></ul><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> arr = [<span class="string">'a'</span>, <span class="string">'b'</span>, <span class="string">'c'</span>];</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">var</span> i <span class="keyword">in</span> arr) &#123; <span class="comment">// i 是下标</span></span><br><span class="line">    <span class="built_in">console</span>.log(i + <span class="string">"==&gt;"</span> + arr[i]); <span class="comment">// 0==&gt;a ...</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="Object"><a href="#Object" class="headerlink" title="Object"></a>Object</h3><ul><li><a href="https://developer.mozilla.org/zh-CN/docs/Web/JavaScript/Reference/Global_Objects/Object" target="_blank" rel="noopener">https://developer.mozilla.org/zh-CN/docs/Web/JavaScript/Reference/Global_Objects/Object</a></li></ul><h4 id="相关方法"><a href="#相关方法" class="headerlink" title="相关方法"></a>相关方法</h4><ul><li><code>Object.assign(target, ...sources)</code> 将所有属性值从源对象复制到目标对象，并返回目标对象(此时返回值和传入参数target一致，会被改变)<ul><li><code>let c = Object.assign({}, a, b)</code> 将b合并到a，再将a合并到target并返回，且不会改变a和b</li><li><strong>只能进行浅拷贝</strong>。假如源对象的属性值是一个指向对象的引用（源对象和目标对象的该属性指向同一个地址，修改会互相影响），它也只拷贝那个引用值</li><li><strong>深拷贝解决方法</strong><ul><li><code>let obj2 = JSON.parse(JSON.stringify(obj1))</code> <strong>存在如下弊端</strong><ul><li>对象原型会改变，拷贝后原型都会变成Object</li><li>时间类型会变成字符串类型</li><li>如果对象中存在循环引用的情况也无法正确实现深拷贝</li><li>JSON.stringify()只能序列化对象的可枚举的自有属性，如obj中的对象是有构造函数生成的，拷贝后会丢失constructor</li><li>其他参考：<a href="https://blog.csdn.net/u013565133/article/details/102819929" target="_blank" rel="noopener">https://blog.csdn.net/u013565133/article/details/102819929</a></li></ul></li><li>使用一些深拷贝函数</li></ul></li></ul></li><li><code>Object.defineProperty(obj, prop, descriptor)</code> 增加或修改对象属性。vue 2.x基于此特性实现响应式</li><li><code>Object.keys(obj)</code> 返回对象的所有可枚举属性的字符串数组(属性名)<ul><li>返回属性的顺序与手动遍历该对象属性时的一致</li></ul></li><li><code>Object.getOwnPropertyNames(obj)</code> 在给定对象上找到的自身属性对应的字符串数组<ul><li>包括可枚举和不可枚举的所有属性。其中可枚举属性的顺序同Object.keys返回的顺序，不可枚举属性的顺序未定义</li><li>如类数组对象可通过此方法进行遍历</li></ul></li><li><code>Object.create(proto[, propertiesObject])</code> 使用某对象作为原型<strong>proto</strong>来创建新对象<ul><li>proto 新创建对象的原型对象</li></ul></li><li><code>Object.freeze(obj)</code> 冻结对象。不能修改对象属性，但是可重新赋值。vue项目对data属性使用此特性可提示性能</li></ul><h4 id="示例"><a href="#示例" class="headerlink" title="示例"></a>示例</h4><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> arr = [<span class="string">"a"</span>, <span class="string">"b"</span>, <span class="string">"c"</span>];</span><br><span class="line"><span class="built_in">console</span>.log(<span class="built_in">Object</span>.getOwnPropertyNames(arr).sort()); <span class="comment">// ["0", "1", "2", "length"]</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> obj = &#123;</span><br><span class="line">    <span class="number">0</span>: <span class="string">"a"</span>,</span><br><span class="line">    <span class="number">1</span>: <span class="string">"b"</span>,</span><br><span class="line">    <span class="string">"getName"</span>: <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">"smalle"</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br><span class="line">obj.name = <span class="string">'hello'</span></span><br><span class="line"><span class="built_in">console</span>.log(<span class="built_in">Object</span>.getOwnPropertyNames(obj).sort()); <span class="comment">// ["0", "1", "getName", "name"]</span></span><br><span class="line"><span class="built_in">console</span>.log(obj[<span class="string">"1"</span>]); <span class="comment">// b，通过obj.1会报错</span></span><br></pre></td></tr></table></figure><h3 id="Array"><a href="#Array" class="headerlink" title="Array"></a>Array</h3><ul><li><a href="https://developer.mozilla.org/zh-CN/docs/Web/JavaScript/Reference/Global_Objects/Array" target="_blank" rel="noopener">https://developer.mozilla.org/zh-CN/docs/Web/JavaScript/Reference/Global_Objects/Array</a></li><li><a href="http://javascript.ruanyifeng.com/stdlib/array.html" target="_blank" rel="noopener">http://javascript.ruanyifeng.com/stdlib/array.html</a></li></ul><h4 id="基本使用"><a href="#基本使用" class="headerlink" title="基本使用"></a>基本使用</h4><ul><li>案例</li></ul><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> arr = [<span class="number">1</span>, <span class="string">'abc'</span>, <span class="literal">true</span>]; <span class="comment">// 创建了一个数组对象，里面有3个元素</span></span><br><span class="line"><span class="keyword">var</span> str = arr[<span class="number">1</span>]; <span class="comment">// 取数组的值</span></span><br><span class="line">arr.length <span class="comment">// 获取的是数组的大小（元素的个数）</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 数组的其他创建方式（一般不用，因为不能创建只含有一个数值的数组，而 var arr = [3]; 可以）</span></span><br><span class="line"><span class="keyword">var</span> arr1 = <span class="keyword">new</span> <span class="built_in">Array</span>(<span class="number">3</span>); <span class="comment">// 创建一个数组，其中含有3个元素，其值为undefined，打印时是一个空字符</span></span><br><span class="line"><span class="keyword">var</span> arr2 = <span class="keyword">new</span> <span class="built_in">Array</span>(<span class="number">1</span>, <span class="string">'a'</span>, <span class="literal">true</span>); <span class="comment">// 创建3个元素</span></span><br></pre></td></tr></table></figure><ul><li><strong>用<code>[]</code>标识的都是数组</strong></li><li>js中的数组有两个不限制<ul><li>不限制元素个数（可随时增删元素）。js会根据程序需要自动扩容。也可以设置length大小来达到扩容和缩容的效果</li><li>不限制元素数据类型（从数组中取数据时，最好强转后再使用）</li></ul></li><li>数组是引用类型的对象<ul><li>原始数据类型(数据保存在变量本地, 栈中)，引用数据类型(数据保存在堆中，栈中的值(如0x4081)保存这个数据的地址，此地址指向实际数据)</li><li>原始数据类型只能保存一个值，而现实生活中的对象一般都是由多个属性进行描述的（如一个名字不能真正代表某个人，重名的太多，此时需要加上地址等信息来唯一确定某个人），引用数据类型可保存多个值</li><li>凡是存在堆中的都是对象</li></ul></li></ul><h4 id="相关方法-1"><a href="#相关方法-1" class="headerlink" title="相关方法"></a>相关方法</h4><ul><li>修改原数组<ul><li><code>pop</code> 从数组中删除最后一个元素，并返回该元素的值</li><li><code>push</code> 将一个或多个元素添加到数组的末尾，并返回该数组的新长度。animals.push(‘chickens’, ‘cats’, ‘dogs’);</li><li><code>shift</code> 用于把数组的第一个元素从其中删除，并返回第一个元素的值</li><li><code>unshift</code> 将一个或多个元素添加到数组的开头，并返回该数组的新长度(该方法修改原有数组)</li><li><code>splice</code> 基于下标修改某个元素<ul><li><code>array.splice(start[, deleteCount[, item1[, item2[, ...]]]])</code> 通过删除或替换现有元素或者原地添加新的元素来修改数组，并以数组形式返回被修改的内容。此方法会改变原数组</li></ul></li><li><code>sort</code> 排序操作，修改的是原数组(返回值也是原数组)。默认排序顺序是根据字符串Unicode码点</li></ul></li><li>返回新数组<ul><li><code>slice</code> 返回一个新的浅拷贝数组对象。原始数组不会被改变。<code>array.slice([begin[, end]])</code><ul><li>begin：提取起始处的索引（默认从 0 开始）。如果该参数为负数，则表示从原数组中的倒数第几个元素开始提取，slice(-2) 表示提取原数组中的倒数第二个元素到最后一个元素（包含最后一个元素）</li><li>end：默认从0开始，但截取的不包含此索引元素。必须大于start，否则返回[]，省略则表示到数组末尾</li></ul></li><li><code>map</code> 映射操作。对原数组每个元素进行处理，并回传新的数组</li><li><code>filter</code> 过滤操作。筛选符合条件的所有元素，若为true则返回组成新数组</li><li><code>reduce</code> 归并操作。总共两个参数，第一个是参数，可以理解为累加器，遍历数组累加回传的返回值，第二个是初始元素。如果没有提供初始元素，则将使用数组中的第一个元素<ul><li><code>array.reduce(callback(accumulator, currentValue[, index[, array]])[, initialValue])</code>，接受参数如下<ul><li>Accumulator (acc) (累计器)</li><li>Current Value (cur) (当前值)</li><li>Current Index (idx) (当前索引)</li><li>Source Array (src) (源数组)</li></ul></li><li><strong><code>reduce((返回对象, 当前对象) =&gt; { retrun 返回对象 }, 返回对象默认值)</code></strong> 可将<code>List&lt;Map&gt;</code>转<code>Map</code></li></ul></li></ul></li><li>其他方法<ul><li><code>some</code> 测试数组中是否至少有一个元素满足条件(传入的测试函数)</li></ul></li></ul><h4 id="示例-1"><a href="#示例-1" class="headerlink" title="示例"></a>示例</h4><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 发明家：包含名、姓、出生日期以及死亡日期</span></span><br><span class="line"><span class="keyword">const</span> inventors = [</span><br><span class="line">    &#123; <span class="attr">first</span>: <span class="string">'Albert'</span>, <span class="attr">last</span>: <span class="string">'Einstein'</span>, <span class="attr">year</span>: <span class="number">1879</span>, <span class="attr">passed</span>: <span class="number">1955</span> &#125;,</span><br><span class="line">    ......</span><br><span class="line">    &#123; <span class="attr">first</span>: <span class="string">'Hanna'</span>, <span class="attr">last</span>: <span class="string">'Hammarström'</span>, <span class="attr">year</span>: <span class="number">1829</span>, <span class="attr">passed</span>: <span class="number">1909</span> &#125;</span><br><span class="line">];</span><br><span class="line"><span class="keyword">const</span> people = [<span class="string">'Beck, Glenn'</span>, ...... , <span class="string">'Blake, William'</span>];</span><br><span class="line"></span><br><span class="line"><span class="comment">// 以数组形式，列出其名与姓 ['Albert Einstein', 'Hanna Hammarström', ...]；或返回list&lt;map&gt;: arr.map(o =&gt; &#123;return &#123;...&#125;&#125;)</span></span><br><span class="line"><span class="keyword">const</span> fullnames = inventors.map(<span class="function"><span class="params">x</span> =&gt;</span> <span class="string">`<span class="subst">$&#123;x.first&#125;</span> <span class="subst">$&#123;x.last&#125;</span>`</span>)</span><br><span class="line"><span class="comment">// 筛选出生于16世纪的发明家</span></span><br><span class="line"><span class="keyword">const</span> fifteenObj = inventors.filter(<span class="function"><span class="params">x</span> =&gt;</span> (x.year &gt;= <span class="number">1500</span> &amp;&amp; x.year &lt; <span class="number">1600</span>))</span><br><span class="line"><span class="comment">// 计算所有的发明家加起来一共活了几岁。**reduce((返回对象, 当前对象) =&gt; &#123; retrun 返回对象 &#125;, 返回对象默认值)** 可将List&lt;Map&gt;转Map</span></span><br><span class="line"><span class="keyword">const</span> totalyears = inventors.reduce(<span class="function">(<span class="params">total, x</span>) =&gt;</span> &#123; <span class="keyword">return</span> total + (x.passed - x.year) &#125;, <span class="number">0</span>)</span><br><span class="line"><span class="comment">// 根据其出生日期，并从大到小排序</span></span><br><span class="line"><span class="keyword">const</span> birthdate = inventors.sort(<span class="function">(<span class="params">x, y</span>) =&gt;</span> (y.year - x.year))</span><br><span class="line"></span><br><span class="line"><span class="comment">// === 语法</span></span><br><span class="line"><span class="keyword">var</span> newArray = arr.filter(callback(element[, index[, array]])[, thisArg])</span><br><span class="line"><span class="keyword">var</span> new_array = arr.map(<span class="function"><span class="keyword">function</span> <span class="title">callback</span>(<span class="params">currentValue[, index[, array]]</span>) </span>&#123;</span><br><span class="line">    <span class="comment">// Return element for new_array </span></span><br><span class="line">&#125;[, thisArg])</span><br><span class="line"></span><br><span class="line"><span class="comment">// === 其他</span></span><br><span class="line"><span class="built_in">console</span>.log([<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>].some(<span class="function">(<span class="params">element</span>) =&gt;</span> element % <span class="number">2</span> === <span class="number">0</span>)); <span class="comment">// true</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// splice</span></span><br><span class="line"><span class="keyword">let</span> arr = [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>]</span><br><span class="line">arr.splice(<span class="number">1</span>) <span class="comment">// [2, 3], arr=[1]. 从下标为1开始，移除所有元素。并返回删除的元素</span></span><br><span class="line">arr.splice(<span class="number">-1</span>) <span class="comment">// [3], arr=[1, 2]. 从倒数第一位开始，移除所有元素(相当于移除最后一个元素)</span></span><br><span class="line">arr.splice(<span class="number">0</span>, <span class="number">1</span>, <span class="string">'fir'</span>); <span class="comment">// [1], arr=['fir', 2, 3]. 替换第一个元素。并返回移除的元素</span></span><br><span class="line">arr.splice(<span class="number">1</span>, <span class="number">0</span>, <span class="string">'sec'</span>); <span class="comment">// [], arr=[1, 'sec', 2, 3]. 在数组的第二个元素位置插入元素'sec'(原来的第二个元素还在)</span></span><br></pre></td></tr></table></figure><h4 id="伪数组"><a href="#伪数组" class="headerlink" title="伪数组"></a>伪数组</h4><ul><li>特点<ul><li>具有length属性</li><li>按索引方式存储数据</li><li>不具有数组的push()、pop()等方法</li></ul></li><li><p>将伪数组转换成真正的数组</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 此处仅列举两种方法</span></span><br><span class="line">arr = [].slice.call(objs)</span><br><span class="line">arr = <span class="built_in">Array</span>.prototype.slice.call(objs)</span><br></pre></td></tr></table></figure></li><li><p>示例</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 得到一个伪数组，原型为 HTMLCollection</span></span><br><span class="line"><span class="keyword">var</span> tables = <span class="built_in">document</span>.getElementsByTagName(<span class="string">'table'</span>)</span><br><span class="line"><span class="comment">// 将伪数组转换成真正的数组</span></span><br><span class="line"><span class="keyword">var</span> tableArr = <span class="built_in">Array</span>.prototype.slice.call(tables)</span><br><span class="line"></span><br><span class="line"><span class="comment">// 构造一个伪数组</span></span><br><span class="line"><span class="keyword">var</span> obj = &#123;</span><br><span class="line">    <span class="string">"0"</span>: <span class="string">"abc"</span>,</span><br><span class="line">    <span class="string">"1"</span>: <span class="number">123</span>,</span><br><span class="line">    <span class="string">"length"</span>: <span class="number">2</span>,</span><br><span class="line">    <span class="string">"push"</span>: <span class="built_in">Array</span>.prototype.push,</span><br><span class="line">    <span class="string">"splice"</span>: <span class="built_in">Array</span>.prototype.splice</span><br><span class="line">&#125;</span><br><span class="line">obj.push(<span class="string">'hello'</span>) <span class="comment">// 3</span></span><br></pre></td></tr></table></figure></li></ul><h3 id="Function"><a href="#Function" class="headerlink" title="Function"></a>Function</h3><h4 id="基本"><a href="#基本" class="headerlink" title="基本"></a>基本</h4><ul><li>基本语法</li></ul><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> 函数名(<span class="params">参数列表</span>) </span>&#123;</span><br><span class="line">    <span class="comment">// ...</span></span><br><span class="line">    <span class="keyword">return</span> 返回值; <span class="comment">// 函数可以不需要返回值</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li>全局函数：ECMAScript定义了标准，由各浏览器实现的函数<ul><li><code>encodeURIComponent()</code> 对统一资源标识符中的部分单字节再次进行编码（也可对汉字进行编码，建议使用）</li><li><code>decodeURIComponent()</code> 解码<ul><li><code>encodeURI()</code> 对统一资源标识符进行编码，将url中的非法字符转换为单字节字符(编码，utf-8格式)</li><li><code>decodeURI()</code> 将encodeURI转换后的字符串转换为原文(解码)</li><li>如果在URL中再次出现保留字则是非法，如 <code>/ ? $ :</code>等，在传输过程中会出错，使用encodeURI无法进行单字节编码，需要使用encodeURIComponent进行编码</li></ul></li><li><code>eval()</code> 执行纯字符串格式的代码(可以将服务器传回来的数据转成对象)</li></ul></li></ul><h4 id="call-apply-bind"><a href="#call-apply-bind" class="headerlink" title="call/apply/bind"></a>call/apply/bind</h4><ul><li>call、apply、bind 都是为了改变某个函数运行时的上下文(context)而存在的，换句话说，就是为了改变函数体内部 this 的指向 <a href="https://www.cnblogs.com/zt123123/p/8287725.html" target="_blank" rel="noopener">^2</a></li><li>call、apply、bind 参数<ul><li>三者第一个参数都是this要指向的对象，也就是想指定的上下</li><li>三者都可以利用后续参数传参，call从第二个参数开始对应被调用函数参数，apply是通过数组传递被调用函数参数</li></ul></li><li>call、apply、bind 调用方式<ul><li>call、apply 是立即调用；bind 是返回对应函数，便于稍后调用</li></ul></li><li><p>示例</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 1.call、apply、bind 对比</span></span><br><span class="line"><span class="keyword">var</span> obj = &#123;<span class="attr">name</span>: <span class="string">'smalle'</span>&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> foo = &#123;</span><br><span class="line">    get: <span class="function"><span class="keyword">function</span>(<span class="params">count</span>) </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">this</span>.name + <span class="string">'-'</span> + count; </span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="built_in">console</span>.log(foo.get.call(obj, <span class="number">1</span>));      <span class="comment">// smalle-1</span></span><br><span class="line"><span class="built_in">console</span>.log(foo.get.apply(obj, [<span class="number">2</span>]));   <span class="comment">// smalle-2</span></span><br><span class="line"><span class="built_in">console</span>.log(foo.get.bind(obj, <span class="number">3</span>)());    <span class="comment">// smalle-3</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 2.自定义console.log方法</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">log</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="comment">// arguments参数是个伪数组，通过 Array.prototype.slice.call 转化为标准数组(才可以使用unshift等方法)</span></span><br><span class="line">    <span class="keyword">var</span> args = <span class="built_in">Array</span>.prototype.slice.call(<span class="built_in">arguments</span>)</span><br><span class="line">    args.unshift(<span class="string">'[aezo] '</span>)</span><br><span class="line">    </span><br><span class="line">    <span class="built_in">console</span>.log.apply(<span class="built_in">console</span>, args)</span><br><span class="line">&#125;</span><br><span class="line">log(<span class="string">"hello world"</span>) <span class="comment">// [aezo] hello world</span></span><br></pre></td></tr></table></figure></li></ul><h4 id="内置函数"><a href="#内置函数" class="headerlink" title="内置函数"></a>内置函数</h4><ul><li><code>setInterval</code> 周期执行函数，直到 clearInterval 被调用或窗口被关闭</li></ul><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> int = setInterval(<span class="function"><span class="params">()</span> =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">if</span> (<span class="keyword">this</span>.flag) &#123;</span><br><span class="line">        <span class="built_in">console</span>.log(<span class="keyword">this</span>.flag)</span><br><span class="line">        <span class="built_in">window</span>.clearInterval(int)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;, <span class="number">50</span>)</span><br></pre></td></tr></table></figure><h3 id="Proxy"><a href="#Proxy" class="headerlink" title="Proxy"></a>Proxy</h3><ul><li>参考: <a href="https://developer.mozilla.org/zh-CN/docs/Web/JavaScript/Reference/Global_Objects/Proxy" target="_blank" rel="noopener">https://developer.mozilla.org/zh-CN/docs/Web/JavaScript/Reference/Global_Objects/Proxy</a></li></ul><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 语法</span></span><br><span class="line"><span class="keyword">let</span> proxy = <span class="keyword">new</span> <span class="built_in">Proxy</span>(target, handler);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 案例</span></span><br><span class="line"><span class="keyword">let</span> test = &#123;</span><br><span class="line">    name: <span class="string">"smalle"</span></span><br><span class="line">&#125;;</span><br><span class="line">test = <span class="keyword">new</span> <span class="built_in">Proxy</span>(test, &#123;</span><br><span class="line">    <span class="comment">// handler对象还有其他属性如：set、apply、construct(new操作符的捕捉器)等</span></span><br><span class="line">    get(target, key) &#123;</span><br><span class="line">        <span class="built_in">console</span>.log(<span class="string">'获取了getter属性'</span>); <span class="comment">// 获取了getter属性</span></span><br><span class="line">        <span class="keyword">return</span> target[key];</span><br><span class="line">    &#125;</span><br><span class="line">&#125;);</span><br><span class="line"><span class="built_in">console</span>.log(test.name); <span class="comment">// smalle</span></span><br></pre></td></tr></table></figure><h3 id="Storage-Cookies"><a href="#Storage-Cookies" class="headerlink" title="Storage/Cookies"></a>Storage/Cookies</h3><ul><li><code>localStorage</code> 没有时间限制的持久的数据存储，只要你不主动删除可以想存多久存多久。</li><li><code>sessionStorage</code> 针对一个 session 的数据存储，这些数据只有在同一个会话中的页面才能访问，当会话结束后数据也随之销毁（例如你在网页上存储一些数据后关闭网页再重新打开，存储的数据就没有了）</li></ul><h3 id="执行环境与作用域"><a href="#执行环境与作用域" class="headerlink" title="执行环境与作用域"></a>执行环境与作用域</h3><h4 id="执行环境"><a href="#执行环境" class="headerlink" title="执行环境"></a>执行环境</h4><ul><li>执行环境的特点 <a href="https://juejin.cn/post/6844904065776910344" target="_blank" rel="noopener">^5</a><ul><li>同步执行，单线程</li><li>唯一的全局执行环境，局部执行环境个数没有限制</li><li>每个函数调用，包括自身函数的多次调用，js都会创建一个新的局部执行环境</li><li>每个执行环境都有一个与之关联的<code>变量对象</code>，环境中定义的所以有变量和函数都保存在这个对象中</li></ul></li><li>js中有三种执行环境<ul><li>全局执行环境<ul><li>在浏览器中，全局环境就是window对象，所以所有全局属性和函数都是作为window对象的属性和方法创建</li></ul></li><li>函数执行环境</li><li>Eval执行环境，参考<a href="#eval">下文eval</a></li></ul></li></ul><h4 id="作用域"><a href="#作用域" class="headerlink" title="作用域"></a>作用域</h4><ul><li>作用域：是指变量的生命周期（一个变量在哪些范围内保持一定值） <a href="https://juejin.cn/post/6844903584891420679" target="_blank" rel="noopener">^4</a></li><li>作用域相关知识点<ul><li>全局作用域<ul><li>生命周期将存在于整个程序之内，能被程序中任何函数或者方法访问，在 JavaScript 内默认是可以被修改的</li><li>显式声明：带有关键字 <code>var</code> 的声明(基于let、const对比描述，具体见下文)</li><li><strong>隐式声明</strong>：不带有声明关键字的变量，JS 会默认帮你声明一个全局变量</li></ul></li><li>函数作用域<ul><li><strong>立即执行函数</strong>：<code>(function() { //... })()</code> 能够自动执行，且里面包裹的内容，能够很好地消除全局变量的影响</li></ul></li><li>块级作用域<ul><li>任何一对花括号（<code>{}</code>）中的语句集都属于一个块，在这之中定义的所有变量在代码块外都是不可见的，称之为块级作用域</li><li>JS在 ES6 之前，是没有块级作用域的概念的</li><li>ES6 使用 let 和 const 关键字代替 var，从而实现块级作用域。创建块级作用域的条件是必须有一个 <code>{}</code> 包裹</li></ul></li><li>词法作用域<ul><li>当要使用声明的变量时，JS引擎总会从最近的一个域，向外层域查找的方式即为此法作用域</li><li>作用域嵌套：有词法作用域一样的特性，查找变量时，总是寻找最近的作用域（基于作用域链查找）</li><li>作用域链：当代码在一个环境中执行时，会创建<code>变量对象</code>(参考执行环境)的一个作用域链。这个作用域链由执行环境的<code>变量对象</code>组成，从前到后依次为最近到最远作用域，因此最后一个永远是全局作用域</li></ul></li><li><strong>动态作用域</strong><ul><li>动态作用域是基于调用栈的，而不是代码中的作用域嵌套(词法作用域)</li><li>词法作用域是函数的作用域在函数定义的时候决定的，而动态作用域是在函数调用的时候决定的</li><li>JavaScript 除了 this 之外，其他都是根据词法作用域查找</li><li><strong>上下文和作用域</strong><ul><li>每个函数的调用都有与之相关的作用域和上下文。作用域是基于函数，而上下文时基于变量对象</li><li><a href="#call/apply/bind">call/apply/bind</a> 都是为了改变某个函数运行时的上下文(context)而存在的，换句话说，就是为了改变函数体内部 this 的指向</li><li>参考下文案例</li></ul></li></ul></li></ul></li><li>案例</li></ul><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// ============ 全局作用域</span></span><br><span class="line"><span class="comment">// 1.全局变量会挂载到 window 对象上</span></span><br><span class="line"><span class="keyword">var</span> testValue = <span class="number">123</span>;</span><br><span class="line"><span class="keyword">var</span> testFunc = <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123; <span class="built_in">console</span>.log(<span class="string">'just test'</span>) &#125;;</span><br><span class="line"><span class="built_in">console</span>.log(<span class="built_in">window</span>.testFunc) <span class="comment">// ƒ () &#123; console.log('just test') &#125;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 2.隐式声明</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">foo</span>(<span class="params">value</span>) </span>&#123;</span><br><span class="line">    result = value + <span class="number">1</span>; <span class="comment">// 没有用 var 修饰</span></span><br><span class="line">    <span class="keyword">return</span> result;</span><br><span class="line">&#125;;</span><br><span class="line">foo(<span class="number">123</span>);</span><br><span class="line"><span class="built_in">console</span>.log(<span class="built_in">window</span>.result); <span class="comment">// 124</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// ============ 块级作用域</span></span><br><span class="line"><span class="comment">// 1.使用 let 和 const 关键字代替 var，从而实现块级作用域</span></span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">var</span> i = <span class="number">0</span>; i &lt; <span class="number">5</span>; i++) &#123;&#125;</span><br><span class="line"><span class="built_in">console</span>.log(i) <span class="comment">// 5 ==&gt; 说明此时没有块级作用域</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">let</span> i = <span class="number">0</span>; i &lt; <span class="number">5</span>; i++) &#123;&#125;</span><br><span class="line"><span class="built_in">console</span>.log(i) <span class="comment">// 报错：ReferenceError: i is not defined</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 2.**常见考题**</span></span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">var</span> i = <span class="number">0</span>; i &lt; <span class="number">5</span>; i++) &#123;</span><br><span class="line">  setTimeout(<span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(i); <span class="comment">// 5 5 5 5 5 ==&gt; 这里的 i 是在全局作用域里面的，只存在 1 个值，等到回调函数执行时，用词法作用域捕获的 i 就只能是 5</span></span><br><span class="line">  &#125;, <span class="number">200</span>);</span><br><span class="line">&#125;;</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">let</span> i = <span class="number">0</span>; i &lt; <span class="number">5</span>; i++) &#123;</span><br><span class="line">    setTimeout(<span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">      <span class="built_in">console</span>.log(i); <span class="comment">// 0 1 2 3 4 ==&gt; 当然还可以使用函数包括setTimeout实现</span></span><br><span class="line">    &#125;, <span class="number">200</span>);</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">// ============ **上下文和作用域**</span></span><br><span class="line"><span class="comment">// 1.当调用一个函数，通过new操作符创建一个对象的实例，this指向新创建的实例</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">test</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="keyword">this</span>);</span><br><span class="line">&#125;</span><br><span class="line">test(); <span class="comment">// Window &#123;...&#125;</span></span><br><span class="line"><span class="keyword">new</span> test(); <span class="comment">// test &#123;&#125;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 2.作用域和每次函数调用时变量的访问有关系，每次调用都是独立的；上下文总是关键字this的值，是调用当前可执行代码的对象的引用</span></span><br><span class="line"><span class="keyword">var</span> object = &#123;</span><br><span class="line">    test: <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="built_in">console</span>.log(<span class="keyword">this</span> === object);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">object.test(); <span class="comment">// true</span></span><br></pre></td></tr></table></figure><h3 id="零散知识"><a href="#零散知识" class="headerlink" title="零散知识"></a>零散知识</h3><h4 id="import-export"><a href="#import-export" class="headerlink" title="import/export"></a>import/export</h4><ul><li>案例 <a href="https://blog.csdn.net/qq_30100043/article/details/53424750" title="javascript对象的扩展运算符" target="_blank" rel="noopener">^1</a></li></ul><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// myexp.js</span></span><br><span class="line"><span class="comment">// 命名导出</span></span><br><span class="line"><span class="keyword">export</span> &#123; myFunc1, myFunc2 &#125;</span><br><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> foo = <span class="built_in">Math</span>.sqrt(<span class="number">2</span>) <span class="comment">// 导出只能是const对象</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 默认导出，一个文件只能有一个默认导出</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> &#123;&#125;</span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;&#125;</span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="class"><span class="keyword">class</span> </span>&#123;&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> func <span class="keyword">from</span> <span class="string">'myexp.js'</span> <span class="comment">// 或'myexp'，导出默认对象赋值到func</span></span><br><span class="line"><span class="keyword">import</span> myFunc1 <span class="keyword">as</span> func <span class="keyword">from</span> <span class="string">'myexp'</span></span><br><span class="line"><span class="keyword">import</span> &#123; myFunc1, myFunc2 &#125; <span class="keyword">from</span> <span class="string">'myexp'</span></span><br></pre></td></tr></table></figure><ul><li>export命令规定的是对外的接口，必须与模块内部的变量建立一一对应关系</li></ul><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 这两种写法导出的全部是1，1只是一个值，不是接口</span></span><br><span class="line"><span class="keyword">export</span> <span class="number">1</span>;</span><br><span class="line"><span class="keyword">var</span> m = <span class="number">1</span>; <span class="keyword">export</span> m;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 正确的三种写法</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">var</span> m = <span class="number">1</span>;</span><br><span class="line"><span class="keyword">var</span> m = <span class="number">1</span>; <span class="keyword">export</span> &#123;m&#125;;</span><br><span class="line"><span class="keyword">var</span> n = <span class="number">1</span>; <span class="keyword">export</span> &#123;n <span class="keyword">as</span> m&#125;;</span><br></pre></td></tr></table></figure><h4 id="eval和Function"><a href="#eval和Function" class="headerlink" title="eval和Function"></a>eval和Function</h4><ul><li><a href="https://developer.mozilla.org/zh-CN/docs/Web/JavaScript/Reference/Global_Objects/eval" target="_blank" rel="noopener">eval函数</a></li><li><strong>eval函数存在漏洞，已不建议使用，可参考上述连接中的Function代替方案</strong></li><li><strong>作用域</strong><ul><li>直接的调用 eval，作用域为局部作用域中</li><li>间接调用 eval(比如通过引用)，作用域是全局</li><li>严格模式下的eval的变量仅存在于eval内部，不外泄</li></ul></li><li><strong>eval内代码可以读取和使用所在作用域的变量，eval中声明的变量也可以在当前作用域中存在，eval以字符串中最后一个js语句的返回值作为最终返回</strong></li><li>eval和new Function均可使用debugger调试，会进入到一个类似VM1308的代码块中。eslint默认对二者均报错</li><li><p>使用如下</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">// eval 使用</span><br><span class="line">function test() &#123;</span><br><span class="line">    var x = 2, y = 4;</span><br><span class="line">    console.log(eval(&apos;debugger; x + y&apos;)); // 直接调用，使用本地作用域，结果是 6</span><br><span class="line">    </span><br><span class="line">    var geval = eval; // 通过引用间接调用，等价于在全局作用域调用</span><br><span class="line">    console.log(geval(&apos;x + y&apos;)); // 间接调用，使用全局作用域，throws ReferenceError 因为`x`未定义</span><br><span class="line">    console.log(window.eval(&apos;x + y&apos;)) // 间接调用</span><br><span class="line">    (0, eval)(&apos;x + y&apos;); // 另一个间接调用的例子</span><br><span class="line">​&#125;</span><br><span class="line"></span><br><span class="line">// Function使用1</span><br><span class="line">let func = new Function(&apos;a&apos;, &apos;b&apos;, &apos;debugger; return a+b&apos;) // 最后一个为函数体，前面的参数为函数的形参</span><br><span class="line">func(1, 2) // 3</span><br><span class="line">// Function使用2。下面示例打印 4</span><br><span class="line">console.log(</span><br><span class="line">    // &quot;return (function(a)&#123;return a(3)&#125;)&quot; 中的 a 为 Function 第三个括号传递的参数(一个处理函数)</span><br><span class="line">    Function(&apos;&quot;use strict&quot;; return (function(a)&#123;return a(3)&#125;)&apos;)()(</span><br><span class="line">        function(index)&#123; return [1, 2, 3, 4, 5][index % 5] &#125;</span><br><span class="line">    )</span><br><span class="line">);</span><br></pre></td></tr></table></figure></li></ul><h4 id="模板字符串"><a href="#模板字符串" class="headerlink" title="模板字符串"></a>模板字符串</h4><ul><li><a href="https://developer.mozilla.org/zh-CN/docs/Web/JavaScript/Reference/template_strings" target="_blank" rel="noopener">模板字符串</a></li><li>模板字面量，在ES2015(ES6)规范的先前版本中被称为模板字符串。ES6用反引号进行标识</li><li><p>使用</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 使用模板字符串</span></span><br><span class="line"><span class="keyword">var</span> name = <span class="string">'smalle'</span></span><br><span class="line"><span class="built_in">console</span>.log(<span class="string">`hello <span class="subst">$&#123;name&#125;</span>`</span>) <span class="comment">// hello smalle</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> str = <span class="string">`hello<span class="subst">$&#123;obj.name&#125;</span> <span class="subst">$&#123;t()&#125;</span> , <span class="subst">$&#123;<span class="number">7</span> + <span class="number">9</span>&#125;</span> , <span class="subst">$&#123;<span class="string">'ok'</span>&#125;</span>,</span></span><br><span class="line"><span class="string">这是个换行</span></span><br><span class="line"><span class="string">`</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 自定义模板字符串解析方法，解析 &#123;&#123;xxx&#125;&#125; 格式</span></span><br><span class="line"><span class="built_in">String</span>.prototype.render = <span class="function"><span class="keyword">function</span> (<span class="params">context</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">this</span>.replace(<span class="regexp">/\&#123;\&#123;([^&#125;]+)\&#125;\&#125;/g</span>, (match, key) =&gt; (context[key] || match));</span><br><span class="line">&#125;;</span><br><span class="line"><span class="string">"hi, &#123;&#123;name&#125;&#125;, &#123;&#123;&#123;&#123;name&#125;&#125;&#125;&#125;"</span>.render(&#123;<span class="attr">name</span>: <span class="string">'smalle'</span>, <span class="attr">smalle</span>: <span class="string">'test'</span>&#125;) <span class="comment">// hi, smalle, &#123;&#123;&#123;&#123;name&#125;&#125;&#125;&#125;</span></span><br></pre></td></tr></table></figure></li></ul><h3 id="易错点"><a href="#易错点" class="headerlink" title="易错点"></a>易错点</h3><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 1.数据类型</span></span><br><span class="line">[<span class="number">1</span>].indexOf(<span class="number">1</span>) <span class="comment">// 0</span></span><br><span class="line">[<span class="number">1</span>].indexOf(<span class="string">"1"</span>) <span class="comment">// -1</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 2.空值判断</span></span><br><span class="line"><span class="keyword">let</span> flag = <span class="literal">null</span> <span class="comment">// undefined、null、''、0、false 在直接if判断时都认为是false，但是 []、&#123;&#125; 认为是 true</span></span><br><span class="line"><span class="keyword">if</span>(flag) <span class="built_in">console</span>.log(<span class="number">1</span>) <span class="comment">// 无输出</span></span><br><span class="line"><span class="keyword">if</span>(<span class="string">''</span>) <span class="built_in">console</span>.log(<span class="number">1</span>) <span class="comment">// 无输出 (false)</span></span><br><span class="line"><span class="keyword">if</span>(<span class="number">0</span>) <span class="built_in">console</span>.log(<span class="number">1</span>) <span class="comment">// 无输出 (false)</span></span><br><span class="line"><span class="keyword">if</span>(!<span class="number">0</span>) <span class="built_in">console</span>.log(<span class="number">1</span>) <span class="comment">// 1 (true)</span></span><br><span class="line"><span class="keyword">if</span>([]) <span class="built_in">console</span>.log(<span class="number">1</span>) <span class="comment">// 1 (true)</span></span><br><span class="line"><span class="keyword">if</span>(&#123;&#125;) <span class="built_in">console</span>.log(<span class="number">1</span>) <span class="comment">// 1 (true)</span></span><br><span class="line"><span class="keyword">if</span>(<span class="number">0</span> == <span class="literal">null</span>) <span class="built_in">console</span>.log(<span class="number">1</span>) <span class="comment">// 无输出 (false)</span></span><br><span class="line"><span class="keyword">if</span>(<span class="literal">undefined</span> == <span class="literal">null</span>) <span class="built_in">console</span>.log(<span class="number">1</span>) <span class="comment">// 1 (true)</span></span><br><span class="line"><span class="keyword">if</span>(<span class="literal">undefined</span> === <span class="literal">null</span>) <span class="built_in">console</span>.log(<span class="number">1</span>) <span class="comment">// 无输出 (false)</span></span><br></pre></td></tr></table></figure><h2 id="DOM"><a href="#DOM" class="headerlink" title="DOM"></a>DOM</h2><h3 id="动态创建iframe-异步加载，加快主站相应速度"><a href="#动态创建iframe-异步加载，加快主站相应速度" class="headerlink" title="动态创建iframe(异步加载，加快主站相应速度)"></a>动态创建iframe(异步加载，加快主站相应速度)</h3><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">createIframe</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> i = <span class="built_in">document</span>.createElement(<span class="string">"iframe"</span>);</span><br><span class="line">    i.id=<span class="string">"iframe"</span></span><br><span class="line">    i.src = <span class="string">"http://localhost/test"</span>;</span><br><span class="line">    i.frameborder = <span class="string">"0"</span>;</span><br><span class="line">    i.width = <span class="string">"100%"</span>;</span><br><span class="line">    i.height = <span class="string">"100%"</span>;</span><br><span class="line">    i.onload=myOnloadFunc;</span><br><span class="line">    <span class="built_in">document</span>.getElementById(<span class="string">"iframeDiv"</span>).appendChild(i);</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (<span class="built_in">window</span>.addEventListener) <span class="built_in">window</span>.addEventListener(<span class="string">"load"</span>, createIframe, <span class="literal">false</span>);</span><br><span class="line"><span class="keyword">else</span> <span class="keyword">if</span> (<span class="built_in">window</span>.attachEvent) <span class="built_in">window</span>.attachEvent(<span class="string">"onload"</span>, createIframe);</span><br><span class="line"><span class="keyword">else</span> <span class="built_in">window</span>.onload = createIframe;</span><br></pre></td></tr></table></figure><h3 id="onblur与onclick事件冲突-弹框穿透"><a href="#onblur与onclick事件冲突-弹框穿透" class="headerlink" title="onblur与onclick事件冲突(弹框穿透)"></a>onblur与onclick事件冲突(弹框穿透)</h3><ul><li>场景：百度的搜索框，输入检索字后下拉会有对应的列表出来，要求点击搜索框外的区域下拉列表消失，点击下拉列表的某个记录后跳转。实现方式为 input 的onchange+onblur 与列表的onclik 。这样就会存在一个问题，当点击列表时 input 的onblur就先发挥作用，导致列表的onclik无效（js的单线程限制了只允许一个事件触发，onblur的优先性高于onclick） <a href="https://blog.csdn.net/yelangshisan/article/details/78936220" target="_blank" rel="noopener">^3</a></li><li>解决办法：用<code>onMouseDown</code>代替<code>onClick</code>(onmousedown需要根据event区分鼠标左右键点击)</li><li>说明<ul><li>onClick:是鼠标点击弹起后触发的的事件，即一次完整的鼠标点击过程。</li><li>onMouseDown:是指鼠标按下的瞬间触发的。</li><li>onMouseUp：在松开鼠标的时候触发，只要弹起的时候在你所要执行的区域上，就会触发。</li><li>即onClick的作用=onMouseDown（按下触发）+onMouseUp（弹起触发）</li></ul></li></ul><h3 id="clientHeight、offsetHeight、scrollHeight区别"><a href="#clientHeight、offsetHeight、scrollHeight区别" class="headerlink" title="clientHeight、offsetHeight、scrollHeight区别"></a>clientHeight、offsetHeight、scrollHeight区别</h3><ul><li>参考：<a href="https://blog.csdn.net/shibazijiang/article/details/103894498" target="_blank" rel="noopener">https://blog.csdn.net/shibazijiang/article/details/103894498</a><ul><li>scrollHeight 元素内容的高度</li><li>clientHeight 元素像素高度(如div高度，即可视高度)</li><li>scrollTop 元素顶部到内容顶部</li><li>判断滚动条是否见底：scrollHeight === clientHeight + scrollTop</li></ul></li></ul><h3 id="常见问题"><a href="#常见问题" class="headerlink" title="常见问题"></a>常见问题</h3><hr><p>参考文章</p></div><div></div><div></div><div><ul class="post-copyright"><li class="post-copyright-author"> <strong>本文作者：</strong> smalle</li><li class="post-copyright-link"> <strong>本文链接：</strong> <a href="http://blog.aezo.cn/2016/06/11/web/js-release/" title="JavaScript知识点">http://blog.aezo.cn/2016/06/11/web/js-release/</a></li><li class="post-copyright-license"> <strong>版权声明：</strong> 本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/3.0/" rel="external nofollow" target="_blank">CC BY-NC-SA 3.0</a> 许可协议。转载请注明出处！</li></ul></div><footer class="post-footer"><div class="post-tags"> <a href="/tags/js/" rel="tag"># js</a></div><div class="post-nav"><div class="post-nav-next post-nav-item"><a href="/2016/05/22/extend/load-runner/" rel="next" title="LoadRunner自动化测试工具"><i class="fa fa-chevron-left"></i> LoadRunner自动化测试工具</a></div><span class="post-nav-divider"></span><div class="post-nav-prev post-nav-item"> <a href="/2016/06/25/service/lightstreamer/" rel="prev" title="lightstreamer">lightstreamer<i class="fa fa-chevron-right"></i></a></div></div></footer></article><div class="post-spread"></div></div></div><div class="comments" id="comments"></div></div><div class="sidebar-toggle"><div class="sidebar-toggle-line-wrap"><span class="sidebar-toggle-line sidebar-toggle-line-first"></span><span class="sidebar-toggle-line sidebar-toggle-line-middle"></span><span class="sidebar-toggle-line sidebar-toggle-line-last"></span></div></div><aside id="sidebar" class="sidebar"><div class="sidebar-inner"><ul class="sidebar-nav motion-element"><li class="sidebar-nav-toc sidebar-nav-active" data-target="post-toc-wrap"> 文章目录</li><li class="sidebar-nav-overview" data-target="site-overview"> 站点概览</li></ul><section class="site-overview sidebar-panel"><div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person"> <img class="site-author-image" itemprop="image" src="https://avatars0.githubusercontent.com/u/15698218?v=3&u=ce740bf0b67ff0d74990ba6fc644d6e92f572dcb&s=400" alt="smalle"><p class="site-author-name" itemprop="name">smalle</p><p class="site-description motion-element" itemprop="description"></p></div><nav class="site-state motion-element"><div class="site-state-item site-state-posts"> <a href="/archives/"><span class="site-state-item-count">155</span> <span class="site-state-item-name">日志</span></a></div><div class="site-state-item site-state-categories"> <a href="/categories/index.html"><span class="site-state-item-count">13</span> <span class="site-state-item-name">分类</span></a></div><div class="site-state-item site-state-tags"> <a href="/tags/index.html"><span class="site-state-item-count">140</span> <span class="site-state-item-name">标签</span></a></div></nav><div class="feed-link motion-element"><a href="/atom.xml" rel="alternate"><i class="fa fa-rss"></i> RSS</a></div><div class="links-of-author motion-element"></div></section><section class="post-toc-wrap motion-element sidebar-panel sidebar-panel-active"><div class="post-toc"><div class="post-toc-content"><ol class="nav"><li class="nav-item nav-level-2"><a class="nav-link" href="#ES6-ES2015"><span class="nav-number">1.</span> <span class="nav-text">ES6 (ES2015)</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#Promise-async-await"><span class="nav-number">1.1.</span> <span class="nav-text">Promise/async/await</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#扩展运算符-…"><span class="nav-number">1.2.</span> <span class="nav-text">扩展运算符(…)</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#ES5"><span class="nav-number">2.</span> <span class="nav-text">ES5</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#介绍"><span class="nav-number">2.1.</span> <span class="nav-text">介绍</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#基本知识"><span class="nav-number">2.2.</span> <span class="nav-text">基本知识</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#变量"><span class="nav-number">2.2.1.</span> <span class="nav-text">变量</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#数据类型"><span class="nav-number">2.2.2.</span> <span class="nav-text">数据类型</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#运算符"><span class="nav-number">2.2.3.</span> <span class="nav-text">运算符</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#流程语句"><span class="nav-number">2.2.4.</span> <span class="nav-text">流程语句</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Object"><span class="nav-number">2.3.</span> <span class="nav-text">Object</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#相关方法"><span class="nav-number">2.3.1.</span> <span class="nav-text">相关方法</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#示例"><span class="nav-number">2.3.2.</span> <span class="nav-text">示例</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Array"><span class="nav-number">2.4.</span> <span class="nav-text">Array</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#基本使用"><span class="nav-number">2.4.1.</span> <span class="nav-text">基本使用</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#相关方法-1"><span class="nav-number">2.4.2.</span> <span class="nav-text">相关方法</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#示例-1"><span class="nav-number">2.4.3.</span> <span class="nav-text">示例</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#伪数组"><span class="nav-number">2.4.4.</span> <span class="nav-text">伪数组</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Function"><span class="nav-number">2.5.</span> <span class="nav-text">Function</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#基本"><span class="nav-number">2.5.1.</span> <span class="nav-text">基本</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#call-apply-bind"><span class="nav-number">2.5.2.</span> <span class="nav-text">call/apply/bind</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#内置函数"><span class="nav-number">2.5.3.</span> <span class="nav-text">内置函数</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Proxy"><span class="nav-number">2.6.</span> <span class="nav-text">Proxy</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Storage-Cookies"><span class="nav-number">2.7.</span> <span class="nav-text">Storage/Cookies</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#执行环境与作用域"><span class="nav-number">2.8.</span> <span class="nav-text">执行环境与作用域</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#执行环境"><span class="nav-number">2.8.1.</span> <span class="nav-text">执行环境</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#作用域"><span class="nav-number">2.8.2.</span> <span class="nav-text">作用域</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#零散知识"><span class="nav-number">2.9.</span> <span class="nav-text">零散知识</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#import-export"><span class="nav-number">2.9.1.</span> <span class="nav-text">import/export</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#eval和Function"><span class="nav-number">2.9.2.</span> <span class="nav-text">eval和Function</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#模板字符串"><span class="nav-number">2.9.3.</span> <span class="nav-text">模板字符串</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#易错点"><span class="nav-number">2.10.</span> <span class="nav-text">易错点</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#DOM"><span class="nav-number">3.</span> <span class="nav-text">DOM</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#动态创建iframe-异步加载，加快主站相应速度"><span class="nav-number">3.1.</span> <span class="nav-text">动态创建iframe(异步加载，加快主站相应速度)</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#onblur与onclick事件冲突-弹框穿透"><span class="nav-number">3.2.</span> <span class="nav-text">onblur与onclick事件冲突(弹框穿透)</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#clientHeight、offsetHeight、scrollHeight区别"><span class="nav-number">3.3.</span> <span class="nav-text">clientHeight、offsetHeight、scrollHeight区别</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#常见问题"><span class="nav-number">3.4.</span> <span class="nav-text">常见问题</span></a></li></ol></li></ol></div></div></section></div></aside></div></main><footer id="footer" class="footer"><div class="footer-inner"><div class="copyright"> &copy; 2016 - <span itemprop="copyrightYear">2021</span><span class="with-love"><i class="fa fa-heart"></i></span> <span class="author" itemprop="copyrightHolder">smalle</span>&nbsp;&nbsp;&nbsp;&nbsp;<div class="powered-by"> 由 <a class="theme-link" target="_blank" href="https://hexo.io">Hexo</a> 强力驱动</div><div class="powered-by"> 主题 - <a class="theme-link" target="_blank" href="https://github.com/iissnan/hexo-theme-next">NexT.Mist</a></div><div class="theme-info cnzz" style="margin:0 0 -5px 10px"><script type="text/javascript">var cnzz_protocol="https:"==document.location.protocol?"https://":"http://";document.write(unescape("%3Cspan id='cnzz_stat_icon_1276691827'%3E%3C/span%3E%3Cscript src='"+cnzz_protocol+"s23.cnzz.com/z_stat.php%3Fid%3D1276691827%26show%3Dpic1' type='text/javascript'%3E%3C/script%3E"))</script></div></div><div class="ad"> <span style="font-weight:700">AD&nbsp;&nbsp;&nbsp;&nbsp;</span><div class="theme-info"> <a target="_blank" href="https://promotion.aliyun.com/ntms/yunparter/invite.html?userCode=oby5nolb">阿里云大礼包</a></div></div><div class="aezocn"> <span style="font-weight:700">@AEZO.CN&nbsp;&nbsp;&nbsp;&nbsp;</span><div class="theme-info"> <a target="_blank" href="http://shop.aezo.cn/">杂货铺</a></div></div><script type="text/javascript">var _hmt=_hmt||[];!function(){var e=document.createElement("script");e.src="https://hm.baidu.com/hm.js?d82223039d601f2f819f8fe140a63468";var t=document.getElementsByTagName("script")[0];t.parentNode.insertBefore(e,t)}()</script></div></footer><div class="back-to-top"><i class="fa fa-arrow-up"></i></div></div><script type="text/javascript">"[object Function]"!==Object.prototype.toString.call(window.Promise)&&(window.Promise=null)</script><script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script><script type="text/javascript" src="/lib/fastclick/lib/fastclick.min.js?v=1.0.6"></script><script type="text/javascript" src="/lib/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script><script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script><script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script><script type="text/javascript" src="/lib/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script><script type="text/javascript" src="/js/src/utils.js?v=5.1.1"></script><script type="text/javascript" src="/js/src/motion.js?v=5.1.1"></script><script type="text/javascript" src="/js/src/scrollspy.js?v=5.1.1"></script><script type="text/javascript" src="/js/src/post-details.js?v=5.1.1"></script><script type="text/javascript" src="/js/src/bootstrap.js?v=5.1.1"></script><script type="text/javascript">
    // Popup Window;
    var isfetched = false;
    var isXml = true;
    // Search DB path;
    var search_path = "search.xml";
    if (search_path.length === 0) {
      search_path = "search.xml";
    } else if (/json$/i.test(search_path)) {
      isXml = false;
    }
    var path = "/" + search_path;
    // monitor main search box;

    var onPopupClose = function (e) {
      $('.popup').hide();
      $('#local-search-input').val('');
      $('.search-result-list').remove();
      $('#no-result').remove();
      $(".local-search-pop-overlay").remove();
      $('body').css('overflow', '');
    }

    function proceedsearch() {
      $("body")
        .append('<div class="search-popup-overlay local-search-pop-overlay"></div>')
        .css('overflow', 'hidden');
      $('.search-popup-overlay').click(onPopupClose);
      $('.popup').toggle();
      var $localSearchInput = $('#local-search-input');
      $localSearchInput.attr("autocapitalize", "none");
      $localSearchInput.attr("autocorrect", "off");
      $localSearchInput.focus();
    }

    // search function;
    var searchFunc = function(path, search_id, content_id) {
      'use strict';

      // start loading animation
      $("body")
        .append('<div class="search-popup-overlay local-search-pop-overlay">' +
          '<div id="search-loading-icon">' +
          '<i class="fa fa-spinner fa-pulse fa-5x fa-fw"></i>' +
          '</div>' +
          '</div>')
        .css('overflow', 'hidden');
      $("#search-loading-icon").css('margin', '20% auto 0 auto').css('text-align', 'center');

      $.ajax({
        url: path,
        dataType: isXml ? "xml" : "json",
        async: true,
        success: function(res) {
          // get the contents from search data
          isfetched = true;
          $('.popup').detach().appendTo('.header-inner');
          var datas = isXml ? $("entry", res).map(function() {
            return {
              title: $("title", this).text(),
              content: $("content",this).text(),
              url: $("url" , this).text()
            };
          }).get() : res;
          var input = document.getElementById(search_id);
          var resultContent = document.getElementById(content_id);
          var inputEventFunction = function() {
            var searchText = input.value.trim().toLowerCase();
            var keywords = searchText.split(/[\s\-]+/);
            if (keywords.length > 1) {
              keywords.push(searchText);
            }
            var resultItems = [];
            if (searchText.length > 0) {
              // perform local searching
              datas.forEach(function(data) {
                var isMatch = false;
                var hitCount = 0;
                var searchTextCount = 0;
                var title = data.title.trim();
                var titleInLowerCase = title.toLowerCase();
                var content = data.content.trim().replace(/<[^>]+>/g,"");
                var contentInLowerCase = content.toLowerCase();
                var articleUrl = decodeURIComponent(data.url);
                var indexOfTitle = [];
                var indexOfContent = [];
                // only match articles with not empty titles
                if(title != '') {
                  keywords.forEach(function(keyword) {
                    function getIndexByWord(word, text, caseSensitive) {
                      var wordLen = word.length;
                      if (wordLen === 0) {
                        return [];
                      }
                      var startPosition = 0, position = [], index = [];
                      if (!caseSensitive) {
                        text = text.toLowerCase();
                        word = word.toLowerCase();
                      }
                      while ((position = text.indexOf(word, startPosition)) > -1) {
                        index.push({position: position, word: word});
                        startPosition = position + wordLen;
                      }
                      return index;
                    }

                    indexOfTitle = indexOfTitle.concat(getIndexByWord(keyword, titleInLowerCase, false));
                    indexOfContent = indexOfContent.concat(getIndexByWord(keyword, contentInLowerCase, false));
                  });
                  if (indexOfTitle.length > 0 || indexOfContent.length > 0) {
                    isMatch = true;
                    hitCount = indexOfTitle.length + indexOfContent.length;
                  }
                }

                // show search results

                if (isMatch) {
                  // sort index by position of keyword

                  [indexOfTitle, indexOfContent].forEach(function (index) {
                    index.sort(function (itemLeft, itemRight) {
                      if (itemRight.position !== itemLeft.position) {
                        return itemRight.position - itemLeft.position;
                      } else {
                        return itemLeft.word.length - itemRight.word.length;
                      }
                    });
                  });

                  // merge hits into slices

                  function mergeIntoSlice(text, start, end, index) {
                    var item = index[index.length - 1];
                    var position = item.position;
                    var word = item.word;
                    var hits = [];
                    var searchTextCountInSlice = 0;
                    while (position + word.length <= end && index.length != 0) {
                      if (word === searchText) {
                        searchTextCountInSlice++;
                      }
                      hits.push({position: position, length: word.length});
                      var wordEnd = position + word.length;

                      // move to next position of hit

                      index.pop();
                      while (index.length != 0) {
                        item = index[index.length - 1];
                        position = item.position;
                        word = item.word;
                        if (wordEnd > position) {
                          index.pop();
                        } else {
                          break;
                        }
                      }
                    }
                    searchTextCount += searchTextCountInSlice;
                    return {
                      hits: hits,
                      start: start,
                      end: end,
                      searchTextCount: searchTextCountInSlice
                    };
                  }

                  var slicesOfTitle = [];
                  if (indexOfTitle.length != 0) {
                    slicesOfTitle.push(mergeIntoSlice(title, 0, title.length, indexOfTitle));
                  }

                  var slicesOfContent = [];
                  while (indexOfContent.length != 0) {
                    var item = indexOfContent[indexOfContent.length - 1];
                    var position = item.position;
                    var word = item.word;
                    // cut out 100 characters
                    var start = position - 20;
                    var end = position + 80;
                    if(start < 0){
                      start = 0;
                    }
                    if (end < position + word.length) {
                      end = position + word.length;
                    }
                    if(end > content.length){
                      end = content.length;
                    }
                    slicesOfContent.push(mergeIntoSlice(content, start, end, indexOfContent));
                  }

                  // sort slices in content by search text's count and hits' count

                  slicesOfContent.sort(function (sliceLeft, sliceRight) {
                    if (sliceLeft.searchTextCount !== sliceRight.searchTextCount) {
                      return sliceRight.searchTextCount - sliceLeft.searchTextCount;
                    } else if (sliceLeft.hits.length !== sliceRight.hits.length) {
                      return sliceRight.hits.length - sliceLeft.hits.length;
                    } else {
                      return sliceLeft.start - sliceRight.start;
                    }
                  });

                  // select top N slices in content

                  var upperBound = parseInt('1');
                  if (upperBound >= 0) {
                    slicesOfContent = slicesOfContent.slice(0, upperBound);
                  }

                  // highlight title and content

                  function highlightKeyword(text, slice) {
                    var result = '';
                    var prevEnd = slice.start;
                    slice.hits.forEach(function (hit) {
                      result += text.substring(prevEnd, hit.position);
                      var end = hit.position + hit.length;
                      result += '<b class="search-keyword">' + text.substring(hit.position, end) + '</b>';
                      prevEnd = end;
                    });
                    result += text.substring(prevEnd, slice.end);
                    return result;
                  }

                  var resultItem = '';

                  if (slicesOfTitle.length != 0) {
                    resultItem += "<li><a href='" + articleUrl + "' class='search-result-title'>" + highlightKeyword(title, slicesOfTitle[0]) + "</a>";
                  } else {
                    resultItem += "<li><a href='" + articleUrl + "' class='search-result-title'>" + title + "</a>";
                  }

                  slicesOfContent.forEach(function (slice) {
                    resultItem += "<a href='" + articleUrl + "'>" +
                      "<p class=\"search-result\">" + highlightKeyword(content, slice) +
                      "...</p>" + "</a>";
                  });

                  resultItem += "</li>";
                  resultItems.push({
                    item: resultItem,
                    searchTextCount: searchTextCount,
                    hitCount: hitCount,
                    id: resultItems.length
                  });
                }
              })
            };
            if (keywords.length === 1 && keywords[0] === "") {
              resultContent.innerHTML = '<div id="no-result"><i class="fa fa-search fa-5x" /></div>'
            } else if (resultItems.length === 0) {
              resultContent.innerHTML = '<div id="no-result"><i class="fa fa-frown-o fa-5x" /></div>'
            } else {
              resultItems.sort(function (resultLeft, resultRight) {
                if (resultLeft.searchTextCount !== resultRight.searchTextCount) {
                  return resultRight.searchTextCount - resultLeft.searchTextCount;
                } else if (resultLeft.hitCount !== resultRight.hitCount) {
                  return resultRight.hitCount - resultLeft.hitCount;
                } else {
                  return resultRight.id - resultLeft.id;
                }
              });
              var searchResultList = '<ul class=\"search-result-list\">';
              resultItems.forEach(function (result) {
                searchResultList += result.item;
              })
              searchResultList += "</ul>";
              resultContent.innerHTML = searchResultList;
            }
          }

          if ('auto' === 'auto') {
            input.addEventListener('input', inputEventFunction);
          } else {
            $('.search-icon').click(inputEventFunction);
            input.addEventListener('keypress', function (event) {
              if (event.keyCode === 13) {
                inputEventFunction();
              }
            });
          }

          // remove loading animation
          $(".local-search-pop-overlay").remove();
          $('body').css('overflow', '');

          proceedsearch();
        }
      });
    }

    // handle and trigger popup window;
    $('.popup-trigger').click(function(e) {
      e.stopPropagation();
      if (isfetched === false) {
        searchFunc(path, 'local-search-input', 'local-search-result');
      } else {
        proceedsearch();
      };
    });

    $('.popup-btn-close').click(onPopupClose);
    $('.popup').click(function(e){
      e.stopPropagation();
    });
    $(document).on('keyup', function (event) {
      var shouldDismissSearchPopup = event.which === 27 &&
        $('.search-popup').is(':visible');
      if (shouldDismissSearchPopup) {
        onPopupClose();
      }
    });
  </script><script>!function(){var t=document.createElement("script"),e=window.location.protocol.split(":")[0];t.src="https"===e?"https://zz.bdstatic.com/linksubmit/push.js":"http://push.zhanzhang.baidu.com/push.js";var s=document.getElementsByTagName("script")[0];s.parentNode.insertBefore(t,s)}()</script><script type="text/javascript" src="/js/src/js.cookie.js?v=5.1.1"></script><script type="text/javascript" src="/js/src/scroll-cookie.js?v=5.1.1"></script></body></html>