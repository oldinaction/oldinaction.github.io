---
layout: "post"
title: "飞书开放平台"
date: "2025-04-17 21:12"
categories: [service]
tags: [sdk]
---

## 开发者后台配置

### 权限管理

- 权限分用户身份权限和应用身份权限
    - 需要保证对应接口的应用身份权限都开通
- 快速申请接口所需权限
    - 进入API调试台 - 选择对应接口 - 请求头Bearer参数(选择user_access_token则是配置用户身份权限, 选择tenant_access_token则是配置应用身份权限) - 权限配置 - 勾选后批量开通

### 事件与回调

- 设置事件与回调: 如选择"长链接"，并添加需要订阅的事件，修改后需重新发布应用
- 代码参考: https://open.feishu.cn/document/server-side-sdk/java-sdk-guide/handle-events

## 开发网页应用

- 网页扫描登录: 参考[应用登录与用户授权/网页应用登录](https://open.larksuite.com/document/uAjLw4CM/ukTMukTMukTM/reference/authen-v1/login-overview)
    - 应用"安全设置 - 重定向 URL"需要和URL代码中的回调地址(redirect_uri)一致
    - 如果需要获取用户手机号信息还需要开通`contact:user.phone:readonly`的权限；用户手机号信息是企业维护的员工信息，不同于用户个人手机号信息

## 接口说明

### 通讯录

- [获取部门直属用户: /open-apis/contact/v3/users/find_by_department](https://open.feishu.cn/document/server-docs/contact-v3/user/find_by_department)
    - 不包含子部门下用户信息
- [获取单个部门信息: /open-apis/contact/v3/departments/:department_id](https://open.feishu.cn/document/server-docs/contact-v3/department/get)
    - 创建飞书部门时, 可填写一个"部门 ID"(对应department_id. 用于和自有系统映射, 如果不填写则会自动生成一个, 如f4367957af371bb2; 只有创建时可输入, 无法修改); 此外飞书还会自动生成一个飞书系统部门ID(对应open_department_id. 以od-开头, 如: od-b0a6097f8e972d1265b15a659c0c321f, 顶级组织貌似是"0")
	- 此接口的 departmentIdType 值类型(表示路径参数`:department_id`的值含义): department_id 使用自定义部门ID, open_department_id 使用飞书自动生成的部门ID

